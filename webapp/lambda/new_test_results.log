
> financial-dashboard-lambda@1.0.0 test
> jest --coverage --coverageReporters=text --coverageReporters=html --coverageReporters=lcov --testNamePattern=Integration --verbose

🔧 Setting up database tables to match loader structure...
Using database config from environment variables
Database config loaded from environment: localhost:5432/stocks
✅ Database connection pool initialized successfully
✅ Database tables created matching loader structure
🔧 Global test setup complete
  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    💼 Holdings request received for user: dev-user-bypass

      at log (routes/dashboard.js:379:13)

  console.log
    🔍 Executing holdings queries...

      at log (routes/dashboard.js:419:13)

  console.log
    ✅ Holdings queries completed: 0 holdings found

      at log (routes/dashboard.js:425:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/holdings HTTP/1.1" 404 108 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    💼 Holdings request received for user: dev-user-bypass

      at log (routes/dashboard.js:379:13)

  console.log
    🔍 Executing holdings queries...

      at log (routes/dashboard.js:419:13)

  console.log
    ✅ Holdings queries completed: 0 holdings found

      at log (routes/dashboard.js:425:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/holdings HTTP/1.1" 404 108 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/performance HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance request received for user: dev-user-bypass

      at log (routes/dashboard.js:500:13)

  console.log
    🔍 Executing performance queries...

      at log (routes/dashboard.js:532:13)

  console.log
    ✅ Performance queries completed: 0 data points

      at log (routes/dashboard.js:538:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/performance HTTP/1.1" 404 109 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance request received for user: dev-user-bypass

      at log (routes/dashboard.js:500:13)

  console.log
    🔍 Executing performance queries...

      at log (routes/dashboard.js:532:13)

  console.log
    ✅ Performance queries completed: 0 data points

      at log (routes/dashboard.js:538:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/performance HTTP/1.1" 404 109 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance request received for user: dev-user-bypass

      at log (routes/dashboard.js:500:13)

  console.log
    🔍 Executing performance queries...

      at log (routes/dashboard.js:532:13)

  console.log
    ✅ Performance queries completed: 0 data points

      at log (routes/dashboard.js:538:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/performance HTTP/1.1" 404 109 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/alerts HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🚨 Alerts request received for user: dev-user-bypass

      at log (routes/dashboard.js:611:13)

  console.log
    🔍 Executing alerts queries...

      at log (routes/dashboard.js:646:13)

  console.log
    ✅ Alerts queries completed: 0 alerts found

      at log (routes/dashboard.js:652:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/alerts HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🚨 Alerts request received for user: dev-user-bypass

      at log (routes/dashboard.js:611:13)

  console.log
    🔍 Executing alerts queries...

      at log (routes/dashboard.js:646:13)

  console.log
    ✅ Alerts queries completed: 0 alerts found

      at log (routes/dashboard.js:652:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/alerts HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🚨 Alerts request received for user: dev-user-bypass

      at log (routes/dashboard.js:611:13)

  console.log
    🔍 Executing alerts queries...

      at log (routes/dashboard.js:646:13)

  console.log
    ✅ Alerts queries completed: 0 alerts found

      at log (routes/dashboard.js:652:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:15 +0000] "GET /api/dashboard/alerts HTTP/1.1" 200 99 "-" "-"
  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    🔧 Dashboard debug request received

      at log (routes/dashboard.js:1003:13)

  console.log
    🔧 Debug data collected: {
      timestamp: '2025-09-23T13:39:16.889Z',
      database_status: 'connected',
      table_counts: {
        price_daily: '19821',
        earnings_history: '6',
        fear_greed_index: '15',
        portfolio_holdings: '0',
        portfolio_performance: '0',
        trading_alerts: '2',
        economic_data: '5',
        stocks: '71',
        technical_data_daily: '12'
      },
      data_counts: {
        price_count: '19821',
        profile_count: '7',
        symbols_count: '4020',
        stocks_count: '7'
      },
      sample_data: {
        latest_prices: [ [Object], [Object], [Object] ],
        sample_alerts: [ [Object], [Object] ],
        database_connectivity: 'operational'
      }
    }

      at log (routes/dashboard.js:1074:13)

  console.log
    🔧 Debug data validation - table_counts type: object

      at log (routes/dashboard.js:1077:13)

  console.log
    🔧 Debug data validation - data_counts type: object

      at log (routes/dashboard.js:1078:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/debug HTTP/1.1" 200 829 "-" "-"
  console.log
    🔧 Dashboard debug request received

      at log (routes/dashboard.js:1003:13)

  console.log
    🔧 Debug data collected: {
      timestamp: '2025-09-23T13:39:16.902Z',
      database_status: 'connected',
      table_counts: {
        price_daily: '19821',
        earnings_history: '6',
        fear_greed_index: '15',
        portfolio_holdings: '0',
        portfolio_performance: '0',
        trading_alerts: '2',
        economic_data: '5',
        stocks: '71',
        technical_data_daily: '12'
      },
      data_counts: {
        price_count: '19821',
        profile_count: '7',
        symbols_count: '4020',
        stocks_count: '7'
      },
      sample_data: {
        latest_prices: [ [Object], [Object], [Object] ],
        sample_alerts: [ [Object], [Object] ],
        database_connectivity: 'operational'
      }
    }

      at log (routes/dashboard.js:1074:13)

  console.log
    🔧 Debug data validation - table_counts type: object

      at log (routes/dashboard.js:1077:13)

  console.log
    🔧 Debug data validation - data_counts type: object

      at log (routes/dashboard.js:1078:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/debug HTTP/1.1" 200 829 "-" "-"
  console.log
    🔧 Dashboard debug request received

      at log (routes/dashboard.js:1003:13)

  console.log
    🔧 Debug data collected: {
      timestamp: '2025-09-23T13:39:16.913Z',
      database_status: 'connected',
      table_counts: {
        price_daily: '19821',
        earnings_history: '6',
        fear_greed_index: '15',
        portfolio_holdings: '0',
        portfolio_performance: '0',
        trading_alerts: '2',
        economic_data: '5',
        stocks: '71',
        technical_data_daily: '12'
      },
      data_counts: {
        price_count: '19821',
        profile_count: '7',
        symbols_count: '4020',
        stocks_count: '7'
      },
      sample_data: {
        latest_prices: [ [Object], [Object], [Object] ],
        sample_alerts: [ [Object], [Object] ],
        database_connectivity: 'operational'
      }
    }

      at log (routes/dashboard.js:1074:13)

  console.log
    🔧 Debug data validation - table_counts type: object

      at log (routes/dashboard.js:1077:13)

  console.log
    🔧 Debug data validation - data_counts type: object

      at log (routes/dashboard.js:1078:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:16 +0000] "GET /api/dashboard/debug HTTP/1.1" 200 829 "-" "-"
  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    🔧 Dashboard debug request received

      at log (routes/dashboard.js:1003:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    🔧 Debug data collected: {
      timestamp: '2025-09-23T13:39:17.594Z',
      database_status: 'connected',
      table_counts: {
        price_daily: '19821',
        earnings_history: '6',
        fear_greed_index: '15',
        portfolio_holdings: '0',
        portfolio_performance: '0',
        trading_alerts: '2',
        economic_data: '5',
        stocks: '71',
        technical_data_daily: '12'
      },
      data_counts: {
        price_count: '19821',
        profile_count: '7',
        symbols_count: '4020',
        stocks_count: '7'
      },
      sample_data: {
        latest_prices: [ [Object], [Object], [Object] ],
        sample_alerts: [ [Object], [Object] ],
        database_connectivity: 'operational'
      }
    }

      at log (routes/dashboard.js:1074:13)

  console.log
    🔧 Debug data validation - table_counts type: object

      at log (routes/dashboard.js:1077:13)

  console.log
    🔧 Debug data validation - data_counts type: object

      at log (routes/dashboard.js:1078:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/debug HTTP/1.1" 200 829 "-" "-"
  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:17 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 529 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary?filter=%27%3B%20DROP%20TABLE%20market_data%3B%20-- HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary?filter=1%27%20OR%20%271%27%3D%271 HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary?filter=UNION%20SELECT%20*%20FROM%20users HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary?filter=%3Cscript%3Ealert(%27xss%27)%3C%2Fscript%3E HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary?filter=..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard HTTP/1.1" 200 436 "-" "-"
  console.log
    📊 Dashboard summary request received

      at log (routes/dashboard.js:48:13)

  console.log
    🔍 Executing comprehensive dashboard queries with timeout protection...

      at log (routes/dashboard.js:217:13)

  console.log
    ✅ Dashboard queries completed: 5 market, 10 gainers, 10 losers, 0 sectors, 6 earnings, 0 sentiment, 10 volume, 1 breadth

      at log (routes/dashboard.js:280:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:18 +0000] "GET /api/dashboard/summary HTTP/1.1" 200 5900 "-" "-"
  console.log
    📊 Market data request received

      at log (routes/dashboard.js:690:13)

  console.log
    🔍 Executing market data queries...

      at log (routes/dashboard.js:776:13)

  console.log
    ✅ Market data queries completed: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:782:13)

  console.log
    📊 Market data prepared: 0 econ, 0 sectors, 3 internals

      at log (routes/dashboard.js:792:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/market-data HTTP/1.1" 200 321 "-" "-"
  console.log
    📊 Dashboard overview requested

      at log (routes/dashboard.js:839:13)

  console.log
    🔍 Executing overview queries...

      at log (routes/dashboard.js:922:13)

  console.log
    📊 Overview data prepared: 0 key metrics, 6 movers, 0 sectors

      at log (routes/dashboard.js:934:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/overview HTTP/1.1" 200 759 "-" "-"
  console.log
    🔧 Dashboard debug request received

      at log (routes/dashboard.js:1003:13)

  console.log
    🔧 Debug data collected: {
      timestamp: '2025-09-23T13:39:19.318Z',
      database_status: 'connected',
      table_counts: {
        price_daily: '19821',
        earnings_history: '6',
        fear_greed_index: '15',
        portfolio_holdings: '0',
        portfolio_performance: '0',
        trading_alerts: '2',
        economic_data: '5',
        stocks: '71',
        technical_data_daily: '12'
      },
      data_counts: {
        price_count: '19821',
        profile_count: '7',
        symbols_count: '4020',
        stocks_count: '7'
      },
      sample_data: {
        latest_prices: [ [Object], [Object], [Object] ],
        sample_alerts: [ [Object], [Object] ],
        database_connectivity: 'operational'
      }
    }

      at log (routes/dashboard.js:1074:13)

  console.log
    🔧 Debug data validation - table_counts type: object

      at log (routes/dashboard.js:1077:13)

  console.log
    🔧 Debug data validation - data_counts type: object

      at log (routes/dashboard.js:1078:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/debug HTTP/1.1" 200 829 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/holdings HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    💼 Holdings request received for user: dev-user-bypass

      at log (routes/dashboard.js:379:13)

  console.log
    🔍 Executing holdings queries...

      at log (routes/dashboard.js:419:13)

  console.log
    ✅ Holdings queries completed: 0 holdings found

      at log (routes/dashboard.js:425:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/dashboard/holdings HTTP/1.1" 404 108 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/dashboard.integration.test.js
  Dashboard Routes Integration Tests
    GET /api/dashboard (Dashboard Root)
      ✓ should return dashboard endpoints and operational status (13 ms)
      ✓ should handle high-frequency requests without degradation (8 ms)
    GET /api/dashboard/summary (Dashboard Summary)
      ✓ should return comprehensive dashboard summary data (139 ms)
      ✓ should validate market overview data structure (110 ms)
      ✓ should validate sector performance data (124 ms)
      ✓ should handle database connectivity issues gracefully (101 ms)
    GET /api/dashboard/holdings (Portfolio Holdings)
      ✓ should require authentication (3 ms)
      ✕ should return holdings data with valid authentication (10 ms)
      ✓ should validate holdings data structure (11 ms)
      ✓ should handle invalid authentication tokens (20 ms)
    GET /api/dashboard/performance (Portfolio Performance)
      ✓ should require authentication for performance data (2 ms)
      ✕ should return performance data with valid authentication (10 ms)
      ✓ should validate performance metrics structure (8 ms)
      ✓ should validate performance metrics calculations (8 ms)
    GET /api/dashboard/alerts (Trading Alerts)
      ✓ should require authentication for alerts (2 ms)
      ✓ should return alerts data with authentication (9 ms)
      ✓ should validate alert data structure (7 ms)
      ✓ should handle alert summary aggregation (7 ms)
    GET /api/dashboard/market-data (Market Data)
      ✓ should return comprehensive market data (245 ms)
      ✓ should validate economic indicators structure (245 ms)
      ✓ should validate sector rotation data (238 ms)
      ✓ should validate market internals data (243 ms)
    GET /api/dashboard/debug (Debug Endpoint)
      ✓ should return debug information about database connectivity (15 ms)
      ✓ should validate table count information (11 ms)
      ✓ should validate database connection status (10 ms)
    GET /api/dashboard/overview (Market Overview)
      ✓ should return market overview data (169 ms)
      ✓ should validate market status information (163 ms)
      ✓ should validate top movers structure (162 ms)
      ✓ should handle empty market data gracefully (166 ms)
    Performance and Edge Cases
      ✓ should handle concurrent requests to dashboard endpoints (338 ms)
      ✓ should maintain response time consistency (94 ms)
      ✓ should handle malformed authentication headers (7 ms)
      ✓ should handle database connection failures gracefully (103 ms)
      ✓ should validate numeric data integrity (105 ms)
      ✓ should handle SQL injection attempts safely (486 ms)
      ✓ should handle memory pressure with large data requests (97 ms)
      ✓ should validate response content types (515 ms)
      ✕ should handle authentication edge cases (13 ms)

  ● Dashboard Routes Integration Tests › GET /api/dashboard/holdings (Portfolio Holdings) › should return holdings data with valid authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      138 |         .set("Authorization", `Bearer ${authToken}`);
      139 |
    > 140 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      141 |
      142 |       if (response.status === 200) {
      143 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:140:52)

  ● Dashboard Routes Integration Tests › GET /api/dashboard/performance (Portfolio Performance) › should return performance data with valid authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      185 |         .set("Authorization", `Bearer ${authToken}`);
      186 |
    > 187 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      188 |
      189 |       if (response.status === 200) {
      190 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:187:52)

  ● Dashboard Routes Integration Tests › Performance and Edge Cases › should handle authentication edge cases

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      637 |           .get(endpoint)
      638 |           .set("Authorization", `Bearer ${authToken}`);
    > 639 |         expect([200, 401].includes(validTokenResponse.status)).toBe(true);
          |                                                                ^
      640 |       }
      641 |     });
      642 |   });

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:639:64)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.error
    Error: SyntaxError: Unexpected end of JSON input
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"invalid": ',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Expected property name or '}' in JSON at position 1
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{incomplete json',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/backtest/run HTTP/1.1" 400 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/earnings?limit=not-a-number HTTP/1.1" 400 105 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/earnings?days_ahead=invalid HTTP/1.1" 400 114 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/earnings?start_date=not-a-date HTTP/1.1" 400 120 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/backtest/run HTTP/1.1" 400 48 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/analytics HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/alerts/distance/AAPL HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/admin HTTP/1.1" 404 125 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/summary?user_id=999 HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/alerts/active?user_id=999 HTTP/1.1" 200 1508 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/nonexistent HTTP/1.1" 404 121 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/nonexistent-action HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/nonexistent-calendar HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/invalid/endpoint HTTP/1.1" 404 126 "-" "-"
  console.log
    📊 Retrieving backtest results for ID: nonexistent-id

      at log (routes/backtest.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/backtest/results/nonexistent-id HTTP/1.1" 404 162 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/positions/999999 HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/invalid-calendar-type HTTP/1.1" 404 140 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/portfolio/invalid-portfolio-action HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/market/invalid-market-data HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/health HTTP/1.1" 404 116 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "PUT /api/market/overview HTTP/1.1" 404 125 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "DELETE /api/calendar/earnings HTTP/1.1" 404 127 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/health HTTP/1.1" 404 116 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/market/overview HTTP/1.1" 404 125 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/calendar/earnings HTTP/1.1" 404 127 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/positions HTTP/1.1" 404 129 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:19 +0000] "GET /api/calendar/earnings?start_date=2024-12-31&end_date=2024-01-01 HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 230ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 237ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 239ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 256ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 242ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 231ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 226ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 239ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 257ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 251ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 236ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 240ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 232ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 234ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 219ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 217ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 224ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 232ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 223ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 222ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 229ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 219ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 215ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 207ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 214ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 208ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 220ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 212ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 204ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 200ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 220ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 217ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 203ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 271ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 212ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 200ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 202ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 196ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 209ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 200ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 274ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 198ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 191ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 204ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 196ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 188ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 191ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 197ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 187ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 182ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 185ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 203ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 175ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 197ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 190ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 188ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 185ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 183ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 293ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 181ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 179ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 181ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 188ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 175ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 180ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 168ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 180ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 174ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 171ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 167ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 161ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 165ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 176ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 167ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 173ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 166ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 150ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 163ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 157ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 147ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 161ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 157ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 152ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 165ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 149ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 144ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 169ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 144ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 159ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 143ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 159ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 134ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 139ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 155ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 143ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 155ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 136ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 139ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 151ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 148ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/nonexistent HTTP/1.1" 404 121 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
  console.error
    Error: SyntaxError: Unexpected end of JSON input
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"invalid": ',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/portfolio/positions HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/calendar/admin-only HTTP/1.1" 404 129 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/errors/4xx-error-scenarios.integration.test.js
  4xx Client Error Scenarios Integration
    400 Bad Request Scenarios
      ✓ should return 400 for malformed JSON requests (16 ms)
      ✓ should return 400 for invalid parameter types (4 ms)
      ✓ should return 400 for missing required fields (5 ms)
      ✓ should return 400 for invalid field values (3 ms)
    401 Unauthorized Scenarios
      ✓ should return 401 for missing authorization header (3 ms)
      ✓ should return 401 for invalid authorization tokens (9 ms)
      ✓ should return 401 for malformed authorization headers (7 ms)
    403 Forbidden Scenarios
      ✓ should return 403 for insufficient permissions (3 ms)
      ✓ should return 403 for resource access violations (49 ms)
    404 Not Found Scenarios
      ✓ should return 404 for non-existent endpoints (5 ms)
      ✓ should return 404 for non-existent resources (16 ms)
      ✓ should return 404 for valid endpoint with invalid sub-routes (7 ms)
    405 Method Not Allowed Scenarios
      ✓ should return 405 for unsupported HTTP methods (4 ms)
      ✓ should return 405 for POST on GET-only endpoints (4 ms)
    409 Conflict Scenarios
      ✓ should return 409 for resource conflicts (2 ms)
    415 Unsupported Media Type Scenarios
      ✓ should return 415 for unsupported content types (11 ms)
    422 Unprocessable Entity Scenarios
      ✓ should return 422 for semantically invalid data (13 ms)
    429 Rate Limiting Scenarios
      ✓ should handle rate limiting if implemented (448 ms)
    Cross-Route 4xx Error Consistency
      ✓ should maintain consistent 4xx error response format (6 ms)
      ✓ should not expose sensitive information in 4xx errors (3 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    💰 Dividend data requested for AAPL

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/AAPL HTTP/1.1" 200 4461 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for JNJ

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/JNJ HTTP/1.1" 200 4484 "-" "-"
  console.log
    💰 Dividend data requested for KO

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/KO HTTP/1.1" 200 4480 "-" "-"
  console.log
    💰 Dividend data requested for PFE

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/PFE HTTP/1.1" 200 4468 "-" "-"
  console.log
    💰 Dividend data requested for AAPL

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/AAPL HTTP/1.1" 200 4461 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT?timeframe=1Y HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT?timeframe=2Y HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT?timeframe=5Y HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT?timeframe=10Y HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/MSFT?timeframe=max HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividend data requested for TSLA

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/TSLA HTTP/1.1" 200 593 "-" "-"
  console.log
    💰 Dividend data requested for INVALID123

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/INVALID123 HTTP/1.1" 404 132 "-" "-"
  console.log
    💰 Dividend data requested for JNJ

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/JNJ HTTP/1.1" 200 4484 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/calendar HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/calendar?start_date=2025-01-01&end_date=2025-03-31 HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/calendar?min_amount=1.00 HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/calendar?sector=Technology HTTP/1.1" 404 237 "-" "-"
  console.log
    💰 Dividend aristocrats requested - min_years: 25

      at log (routes/dividend.js:109:13)

  console.error
    Database query error: {
      error: 'could not determine data type of parameter $1',
      query: '\n' +
        '      SELECT\n' +
        '        fm.symbol,\n' +
        '        COALESCE(cp.short_name, fm.symbol) as company_name,\n' +
        '       ...',
      params: '4 parameters',
      code: '42P18'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/dividend.js:130:20

  console.error
    Aristocrats error: error: could not determine data type of parameter $1
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/dividend.js:130:20 {
      length: 124,
      severity: 'ERROR',
      code: '42P18',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'postgres.c',
      line: '740',
      routine: 'pg_analyze_and_rewrite_varparams'
    }

      162 |     });
      163 |   } catch (error) {
    > 164 |     console.error("Aristocrats error:", error);
          |             ^
      165 |     res.status(500).json({
      166 |       success: false,
      167 |       error: "Failed to fetch dividend aristocrats",

      at error (routes/dividend.js:164:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/aristocrats HTTP/1.1" 500 161 "-" "-"
  console.log
    💰 Dividend aristocrats requested - min_years: 25

      at log (routes/dividend.js:109:13)

  console.error
    Database query error: {
      error: 'could not determine data type of parameter $1',
      query: '\n' +
        '      SELECT\n' +
        '        fm.symbol,\n' +
        '        COALESCE(cp.short_name, fm.symbol) as company_name,\n' +
        '       ...',
      params: '4 parameters',
      code: '42P18'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/dividend.js:130:20

  console.error
    Aristocrats error: error: could not determine data type of parameter $1
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/dividend.js:130:20 {
      length: 124,
      severity: 'ERROR',
      code: '42P18',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'postgres.c',
      line: '740',
      routine: 'pg_analyze_and_rewrite_varparams'
    }

      162 |     });
      163 |   } catch (error) {
    > 164 |     console.error("Aristocrats error:", error);
          |             ^
      165 |     res.status(500).json({
      166 |       success: false,
      167 |       error: "Failed to fetch dividend aristocrats",

      at error (routes/dividend.js:164:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/aristocrats?min_years=25 HTTP/1.1" 500 161 "-" "-"
  console.log
    💰 Dividend aristocrats requested - min_years: 25

      at log (routes/dividend.js:109:13)

  console.error
    Database query error: {
      error: 'could not determine data type of parameter $1',
      query: '\n' +
        '      SELECT\n' +
        '        fm.symbol,\n' +
        '        COALESCE(cp.short_name, fm.symbol) as company_name,\n' +
        '       ...',
      params: '4 parameters',
      code: '42P18'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/dividend.js:130:20

  console.error
    Aristocrats error: error: could not determine data type of parameter $1
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/dividend.js:130:20 {
      length: 124,
      severity: 'ERROR',
      code: '42P18',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'postgres.c',
      line: '740',
      routine: 'pg_analyze_and_rewrite_varparams'
    }

      162 |     });
      163 |   } catch (error) {
    > 164 |     console.error("Aristocrats error:", error);
          |             ^
      165 |     res.status(500).json({
      166 |       success: false,
      167 |       error: "Failed to fetch dividend aristocrats",

      at error (routes/dividend.js:164:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/aristocrats?min_yield=2.0&max_yield=6.0 HTTP/1.1" 500 161 "-" "-"
  console.log
    💰 Dividend data requested for GROWTH

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:20 +0000] "GET /api/dividend/growth?symbol=AAPL HTTP/1.1" 404 151 "-" "-"
  console.log
    💰 Dividend data requested for GROWTH

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/growth?symbol=MSFT&period=1Y HTTP/1.1" 404 151 "-" "-"
  console.log
    💰 Dividend data requested for GROWTH

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/growth?symbol=JNJ HTTP/1.1" 404 151 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_yield=3.0&max_yield=8.0 HTTP/1.1" 500 279 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?max_payout_ratio=60 HTTP/1.1" 500 279 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_market_cap=1000000000 HTTP/1.1" 500 289 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_yield=2.5&max_payout_ratio=70&min_market_cap=5000000000&sector=Technology HTTP/1.1" 500 297 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?sort=yield&order=desc HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?sort=payout_ratio&order=desc HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?sort=growth_rate&order=desc HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?sort=market_cap&order=desc HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend data requested for FORECAST

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/forecast?symbol=AAPL HTTP/1.1" 404 151 "-" "-"
  console.log
    💰 Dividend data requested for FORECAST

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/forecast?symbol=MSFT&horizon=1Q HTTP/1.1" 404 151 "-" "-"
  console.log
    💰 Dividend data requested for AAPL

      at log (routes/dividend.js:266:13)

  console.log
    💰 Dividend data requested for MSFT

      at log (routes/dividend.js:266:13)

  console.log
    💰 Dividend data requested for JNJ

      at log (routes/dividend.js:266:13)

  console.log
    💰 Dividend data requested for KO

      at log (routes/dividend.js:266:13)

  console.log
    💰 Dividend data requested for PFE

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/AAPL HTTP/1.1" 200 4461 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/KO HTTP/1.1" 200 4480 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/JNJ HTTP/1.1" 200 4484 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/PFE HTTP/1.1" 200 4468 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/MSFT HTTP/1.1" 200 4464 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/calendar?start_date=invalid-date HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/calendar?end_date=2025-13-40 HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/calendar?start_date=2025-12-31&end_date=2025-01-01 HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividend data requested for AAPL

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/AAPL HTTP/1.1" 200 4461 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_yield=invalid HTTP/1.1" 500 283 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?max_payout_ratio=-50 HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_market_cap=abc HTTP/1.1" 500 283 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener?min_yield=10&max_yield=2 HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividends calendar requested - symbol: all, days_ahead: 30

      at log (routes/dividend.js:33:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/calendar HTTP/1.1" 200 10390 "-" "-"
  console.log
    💰 Dividend data requested for BRK.A

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/BRK.A HTTP/1.1" 400 144 "-" "-"
  console.log
    💰 Dividend data requested for AAPL'; DROP TABLE DIVIDENDS; --

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/AAPL%27%3B%20DROP%20TABLE%20dividends%3B%20-- HTTP/1.1" 400 144 "-" "-"
  console.log
    💰 Dividend data requested for AAPL

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/AAPL HTTP/1.1" 200 4461 "-" "-"
  console.log
    💰 Dividend data requested for JNJ

      at log (routes/dividend.js:266:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/JNJ HTTP/1.1" 200 4484 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    💰 Dividend screener requested with filters

      at log (routes/dividend.js:235:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/dividend/screener HTTP/1.1" 500 280 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/dividend.integration.test.js
  Dividend Routes Integration Tests
    GET /api/dividend/:symbol (Stock Dividend Data)
      ✓ should return dividend data for dividend-paying stocks (32 ms)
      ✓ should include dividend yield calculation (4 ms)
      ✓ should handle historical timeframe parameter (20 ms)
      ✕ should handle non-dividend paying stocks (6 ms)
      ✓ should handle invalid stock symbol (5 ms)
      ✓ should validate dividend data structure (4 ms)
    GET /api/dividend/calendar (Dividend Calendar)
      ✕ should return upcoming dividend events (5 ms)
      ✓ should handle date range for dividend calendar (4 ms)
      ✓ should filter by minimum dividend amount (7 ms)
      ✕ should handle sector filter (5 ms)
    GET /api/dividend/aristocrats (Dividend Aristocrats)
      ✕ should return dividend aristocrat stocks (17 ms)
      ✓ should handle minimum years filter (10 ms)
      ✓ should handle yield range filters (10 ms)
    GET /api/dividend/growth (Dividend Growth Analysis)
      ✕ should return dividend growth analysis (9 ms)
      ✕ should handle growth period parameter (4 ms)
      ✓ should include dividend sustainability metrics (4 ms)
    GET /api/dividend/screener (Dividend Stock Screener)
      ✕ should return dividend stock screening results (3 ms)
      ✓ should handle yield range screening (3 ms)
      ✓ should handle payout ratio filter (3 ms)
      ✓ should handle market cap filter (8 ms)
      ✓ should handle multiple filters combined (3 ms)
      ✓ should handle sorting options (11 ms)
    GET /api/dividend/forecast (Dividend Forecasting)
      ✕ should return dividend payment forecasts (4 ms)
      ✕ should handle forecast horizon parameter (4 ms)
    Performance and Edge Cases
      ✓ should handle concurrent dividend data requests (25 ms)
      ✓ should handle invalid date formats (18 ms)
      ✓ should validate dividend amount ranges (6 ms)
      ✓ should handle malformed screening parameters (14 ms)
      ✓ should maintain response time consistency (4 ms)
      ✕ should handle special symbol characters (3 ms)
      ✓ should handle SQL injection attempts (3 ms)
      ✓ should handle database connection failures gracefully (4 ms)
      ✕ should validate yield calculation accuracy (4 ms)
      ✕ should handle stress testing with multiple concurrent requests (24 ms)

  ● Dividend Routes Integration Tests › GET /api/dividend/:symbol (Stock Dividend Data) › should handle non-dividend paying stocks

    expect(received).toEqual(expected) // deep equality

    - Expected  -  1
    + Received  + 11

    - Array []
    + Array [
    +   Object {
    +     "amount": 0,
    +     "currency": "USD",
    +     "dividend_type": "regular",
    +     "ex_date": "2025-10-05T05:00:00.000Z",
    +     "frequency": "None",
    +     "payment_date": "2025-10-20T05:00:00.000Z",
    +     "record_date": "2025-10-07T05:00:00.000Z",
    +   },
    + ]

      92 |
      93 |         if (response.status === 200) {
    > 94 |           expect(response.body.data.dividends).toEqual([]);
         |                                                ^
      95 |           expect(response.body.data.dividend_yield).toBeNull();
      96 |         }
      97 |       }

      at Object.toEqual (tests/integration/routes/dividend.integration.test.js:94:48)

  ● Dividend Routes Integration Tests › GET /api/dividend/calendar (Dividend Calendar) › should return upcoming dividend events

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      129 |         expect(response.body).toHaveProperty("success", true);
      130 |         expect(response.body).toHaveProperty("data");
    > 131 |         expect(Array.isArray(response.body.data)).toBe(true);
          |                                                   ^
      132 |         expect(response.body).toHaveProperty("period");
      133 |
      134 |         if (response.body.data.length > 0) {

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:131:51)

  ● Dividend Routes Integration Tests › GET /api/dividend/calendar (Dividend Calendar) › should handle sector filter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      186 |         );
      187 |
    > 188 |         expect([200, 400, 500, 503].includes(response.status)).toBe(true);
          |                                                                ^
      189 |       }
      190 |     });
      191 |   });

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:188:64)

  ● Dividend Routes Integration Tests › GET /api/dividend/aristocrats (Dividend Aristocrats) › should return dividend aristocrat stocks

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      195 |       const response = await request(app).get("/api/dividend/aristocrats");
      196 |
    > 197 |       expect(response.status).toBe(200);
          |                               ^
      198 |
      199 |       if (response.status === 200) {
      200 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:197:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/growth (Dividend Growth Analysis) › should return dividend growth analysis

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      251 |       );
      252 |
    > 253 |       expect(response.status).toBe(200);
          |                               ^
      254 |
      255 |       if (response.status === 200) {
      256 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:253:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/growth (Dividend Growth Analysis) › should handle growth period parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      277 |         );
      278 |
    > 279 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      280 |       }
      281 |     });
      282 |

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:279:54)

  ● Dividend Routes Integration Tests › GET /api/dividend/screener (Dividend Stock Screener) › should return dividend stock screening results

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      305 |       const response = await request(app).get("/api/dividend/screener");
      306 |
    > 307 |       expect(response.status).toBe(200);
          |                               ^
      308 |
      309 |       if (response.status === 200) {
      310 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:307:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/forecast (Dividend Forecasting) › should return dividend payment forecasts

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      388 |       );
      389 |
    > 390 |       expect(response.status).toBe(200);
          |                               ^
      391 |
      392 |       if (response.status === 200) {
      393 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:390:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/forecast (Dividend Forecasting) › should handle forecast horizon parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      414 |         );
      415 |
    > 416 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      417 |       }
      418 |     });
      419 |   });

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:416:54)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should handle special symbol characters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      495 |         const response = await request(app).get(`/api/dividend/${symbol}`);
      496 |
    > 497 |         expect(response.status).toBe(200);
          |                                 ^
      498 |       }
      499 |     });
      500 |

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:497:33)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should validate yield calculation accuracy

    expect(received).toBeLessThan(expected)

    Expected: < 50
    Received:   95.20000000000002

      527 |         const dividendYield = response.body.data.dividend_yield;
      528 |         expect(dividendYield).toBeGreaterThanOrEqual(0);
    > 529 |         expect(dividendYield).toBeLessThan(50); // Reasonable upper bound for dividend yields
          |                               ^
      530 |         expect(Number.isFinite(dividendYield)).toBe(true);
      531 |       }
      532 |     });

      at Object.toBeLessThan (tests/integration/routes/dividend.integration.test.js:529:31)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should handle stress testing with multiple concurrent requests

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      543 |       responses.forEach((response) => {
      544 |         if (response.status) {
    > 545 |           expect(response.status).toBe(200);
          |                                   ^
      546 |         }
      547 |       });
      548 |     });

      at toBe (tests/integration/routes/dividend.integration.test.js:545:35)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/dividend.integration.test.js:543:17)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading HTTP/1.1" 200 193 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
  console.log
    [TRADING] Debug endpoint called

      at log (routes/trading.js:146:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/debug HTTP/1.1" 200 392 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals HTTP/1.1" 200 47110 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals?limit=50 HTTP/1.1" 200 24296 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: AAPL, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals?symbol=AAPL&limit=25 HTTP/1.1" 200 12382 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: buy, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals?signal_type=buy&limit=25 HTTP/1.1" 200 12574 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals?limit=invalid HTTP/1.1" 400 59 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals?limit=1000 HTTP/1.1" 400 51 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: {},
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:21.689Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 100, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 4 rows out of 4 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/daily HTTP/1.1" 200 1331 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/weekly

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'weekly' },
      query: {},
      path: '/signals/weekly',
      method: 'GET',
      time: '2025-09-23T13:39:21.723Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              NULL as stoplevel,
              false as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_weekly bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 100, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_weekly bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 6 rows out of 6 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/weekly HTTP/1.1" 200 1969 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/monthly

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'monthly' },
      query: {},
      path: '/signals/monthly',
      method: 'GET',
      time: '2025-09-23T13:39:21.754Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              NULL as stoplevel,
              false as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_monthly bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 100, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_monthly bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 6 rows out of 6 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/monthly HTTP/1.1" 200 1929 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/invalid

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'invalid' },
      query: {},
      path: '/signals/invalid',
      method: 'GET',
      time: '2025-09-23T13:39:21.782Z'
    }

      at log (routes/trading.js:448:11)

  console.warn
    [TRADING] Invalid timeframe: invalid

      481 |     const validTimeframes = ["daily", "weekly", "monthly"];
      482 |     if (!validTimeframes.includes(normalizedTimeframe)) {
    > 483 |       console.warn("[TRADING] Invalid timeframe:", timeframe);
          |               ^
      484 |       return res.status(400).json({
      485 |         success: false,
      486 |         error: `Invalid timeframe: ${timeframe}. Must be one of: ${validTimeframes.join(", ")} or their aliases (swing, day, week, month)`,

      at warn (routes/trading.js:483:15)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at param (node_modules/express/lib/router/index.js:365:14)
      at param (node_modules/express/lib/router/index.js:376:14)
      at Function.process_params (node_modules/express/lib/router/index.js:421:3)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at router (node_modules/express/lib/router/index.js:47:12)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at next (middleware/responseFormatter.js:66:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:94:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at jsonParser (node_modules/body-parser/lib/types/json.js:113:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at logger (node_modules/morgan/index.js:144:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at internalNext (node_modules/helmet/index.cjs:537:6)
      at xXssProtectionMiddleware (node_modules/helmet/index.cjs:315:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xPoweredByMiddleware (node_modules/helmet/index.cjs:308:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xPermittedCrossDomainPoliciesMiddleware (node_modules/helmet/index.cjs:301:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xFrameOptionsMiddleware (node_modules/helmet/index.cjs:285:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xDownloadOptionsMiddleware (node_modules/helmet/index.cjs:265:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xDnsPrefetchControlMiddleware (node_modules/helmet/index.cjs:258:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xContentTypeOptionsMiddleware (node_modules/helmet/index.cjs:250:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at strictTransportSecurityMiddleware (node_modules/helmet/index.cjs:243:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at referrerPolicyMiddleware (node_modules/helmet/index.cjs:211:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at originAgentClusterMiddleware (node_modules/helmet/index.cjs:186:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at crossOriginResourcePolicyMiddleware (node_modules/helmet/index.cjs:179:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at crossOriginOpenerPolicyMiddleware (node_modules/helmet/index.cjs:163:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at contentSecurityPolicyMiddleware (node_modules/helmet/index.cjs:128:4)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at helmetMiddleware (node_modules/helmet/index.cjs:539:6)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/invalid HTTP/1.1" 400 137 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?page=1&limit=10

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { page: '1', limit: '10' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:21.794Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 10, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 4 rows out of 4 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/daily?page=1&limit=10 HTTP/1.1" 200 1330 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?latest_only=true&limit=5

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { latest_only: 'true', limit: '5' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:21.818Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            WITH ranked_signals AS (
              SELECT 
                bs.symbol,
                bs.date,
                bs.signal_type as signal,
                bs.price,
                bs.stoplevel as stoplevel,
                bs.inposition as inposition,
                pd.close as current_price,
                cp.short_name as company_name,
                cp.sector as sector,
                NULL as market_cap,
                NULL as trailing_pe,
                pd.dividends as dividend_yield,
                CASE 
                  WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                  THEN ((pd.close - bs.price) / bs.price * 100)
                  WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                  THEN ((bs.price - pd.close) / bs.price * 100)
                  ELSE 0
                END as performance_percent,
                ROW_NUMBER() OVER (PARTITION BY bs.symbol ORDER BY bs.date DESC) as rn
              FROM buy_sell_daily bs
              LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
              LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
              LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
              
            )
            SELECT * FROM ranked_signals 
            WHERE rn = 1
            ORDER BY ranked_signals.date DESC, ranked_signals.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 5, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            WITH ranked_signals AS (
              SELECT bs.symbol,
                ROW_NUMBER() OVER (PARTITION BY bs.symbol ORDER BY bs.date DESC) as rn
              FROM buy_sell_daily bs
              
            )
            SELECT COUNT(*) as total
            FROM ranked_signals 
            WHERE rn = 1
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 2 rows out of 2 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/daily?latest_only=true&limit=5 HTTP/1.1" 200 788 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?symbol=AAPL&signal_type=buy&limit=5

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { symbol: 'AAPL', signal_type: 'buy', limit: '5' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:21.847Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            WHERE bs.symbol = $1 AND bs.signal_type = 'BUY'
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $2 OFFSET $3
           Params: [ 'AAPL', 5, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            WHERE bs.symbol = $1 AND bs.signal_type = 'BUY'
           Params: [ 'AAPL' ]

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 1 rows out of 1 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/signals/daily?symbol=AAPL&signal_type=buy&limit=5 HTTP/1.1" 200 471 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/summary/daily HTTP/1.1" 200 351 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/summary/weekly HTTP/1.1" 200 353 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/summary/invalid HTTP/1.1" 400 45 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/swing-signals HTTP/1.1" 200 1327 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/swing-signals?page=1&limit=10 HTTP/1.1" 200 1327 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/AAPL/technicals HTTP/1.1" 200 340 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/MSFT/technicals?timeframe=weekly HTTP/1.1" 200 342 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/TSLA/technicals?timeframe=monthly HTTP/1.1" 200 342 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/performance HTTP/1.1" 200 89 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/performance?days=60 HTTP/1.1" 200 89 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/performance?days=invalid HTTP/1.1" 200 89 "-" "-"
  console.log
    🔄 Trading positions requested for user: anonymous

      at log (routes/trading.js:1212:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/positions HTTP/1.1" 200 75 "-" "-"
  console.log
    🔄 Trading positions requested for user: anonymous

      at log (routes/trading.js:1212:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/positions?summary=true HTTP/1.1" 200 156 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/orders HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Trading orders requested for user: dev-user-bypass

      at log (routes/trading.js:1346:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/orders HTTP/1.1" 200 464 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Trading orders requested for user: dev-user-bypass

      at log (routes/trading.js:1346:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/orders HTTP/1.1" 200 464 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 10 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 201 617 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, sell 5 TSLA

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 201 615 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, undefined 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 400 134 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 400 91 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, invalid_side 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 400 62 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 0 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 400 134 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 400 65 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, sell 2 NVDA

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "POST /api/trading/orders HTTP/1.1" 201 619 "-" "-"
  console.log
    🎮 Trading simulator requested - Portfolio: $100000, Strategy: momentum, Symbols: SPY,QQQ,AAPL,TSLA,NVDA

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/simulator HTTP/1.1" 200 401 "-" "-"
  console.log
    🎮 Trading simulator requested - Portfolio: $50000, Strategy: mean_reversion, Symbols: AAPL,MSFT,GOOGL

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/simulator?portfolio=50000&strategy=mean_reversion&symbols=AAPL,MSFT,GOOGL HTTP/1.1" 200 394 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/simulator?portfolio=invalid HTTP/1.1" 400 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/simulator?portfolio=-1000 HTTP/1.1" 400 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/simulator?strategy=invalid_strategy HTTP/1.1" 400 103 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/strategies HTTP/1.1" 200 544 "-" "-"
  console.log
    📈 Trading strategies requested - category: momentum, risk: all, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/strategies?category=momentum HTTP/1.1" 200 549 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: low, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/strategies?risk_level=low HTTP/1.1" 200 544 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: true

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:21 +0000] "GET /api/trading/strategies?active_only=true HTTP/1.1" 200 543 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies?limit=3 HTTP/1.1" 200 543 "-" "-"
  console.log
    📈 Trading strategies requested - category: trend_following, risk: medium, active: true

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies?category=trend_following&risk_level=medium&active_only=true&limit=5 HTTP/1.1" 200 557 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: false, backtest: false

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1 HTTP/1.1" 200 2227 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: true, backtest: false

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_signals=true HTTP/1.1" 200 2621 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: false, backtest: true

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_backtest=true HTTP/1.1" 200 2564 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: true, backtest: true

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_signals=true&include_backtest=true HTTP/1.1" 200 2958 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: false, backtest: false

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1 HTTP/1.1" 200 2227 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: true, backtest: false

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_signals=true HTTP/1.1" 200 2621 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: false, backtest: true

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_backtest=true HTTP/1.1" 200 2564 "-" "-"
  console.log
    📊 Strategy details requested - ID: momentum_breakout_v1, signals: true, backtest: true

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/momentum_breakout_v1?include_signals=true&include_backtest=true HTTP/1.1" 200 2958 "-" "-"
  console.log
    📊 Strategy details requested - ID: nonexistent_strategy, signals: false, backtest: false

      at log (routes/trading.js:2018:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies/nonexistent_strategy HTTP/1.1" 200 2227 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?symbol=AAPL&signal_type=buy&page=2&limit=15&latest_only=false

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: {
        symbol: 'AAPL',
        signal_type: 'buy',
        page: '2',
        limit: '15',
        latest_only: 'false'
      },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:22.047Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            WHERE bs.symbol = $1 AND bs.signal_type = 'BUY'
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $2 OFFSET $3
           Params: [ 'AAPL', 15, 15 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            WHERE bs.symbol = $1 AND bs.signal_type = 'BUY'
           Params: [ 'AAPL' ]

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.warn
    [TRADING] No data found for query: {
      timeframe: 'daily',
      params: {
        symbol: 'AAPL',
        signal_type: 'buy',
        page: '2',
        limit: '15',
        latest_only: 'false'
      }
    }

      758 |
      759 |     if (!result || !Array.isArray(result.rows) || result.rows.length === 0) {
    > 760 |       console.warn("[TRADING] No data found for query:", {
          |               ^
      761 |         timeframe: processedTimeframe,
      762 |         params: req.query,
      763 |       });

      at warn (routes/trading.js:760:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals/daily?symbol=AAPL&signal_type=buy&page=2&limit=15&latest_only=false HTTP/1.1" 200 246 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?page=-1&limit=10

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { page: '-1', limit: '10' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:22.065Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 10, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 4 rows out of 4 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals/daily?page=-1&limit=10 HTTP/1.1" 200 1330 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?page=999999

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { page: '999999' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:22.088Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 100, 99999800 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.warn
    [TRADING] No data found for query: { timeframe: 'daily', params: { page: '999999' } }

      758 |
      759 |     if (!result || !Array.isArray(result.rows) || result.rows.length === 0) {
    > 760 |       console.warn("[TRADING] No data found for query:", {
          |               ^
      761 |         timeframe: processedTimeframe,
      762 |         params: req.query,
      763 |       });

      at warn (routes/trading.js:760:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals/daily?page=999999 HTTP/1.1" 200 250 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/performance?days=0 HTTP/1.1" 200 89 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/performance?days=99999 HTTP/1.1" 200 450 "-" "-"
  console.log
    🎮 Trading simulator requested - Portfolio: $1, Strategy: momentum, Symbols: SPY,QQQ,AAPL,TSLA,NVDA

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/simulator?portfolio=1 HTTP/1.1" 200 391 "-" "-"
  console.log
    🎮 Trading simulator requested - Portfolio: $1000000000, Strategy: momentum, Symbols: SPY,QQQ,AAPL,TSLA,NVDA

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/simulator?portfolio=1000000000 HTTP/1.1" 200 409 "-" "-"
  console.log
    🎮 Trading simulator requested - Portfolio: $100000, Strategy: momentum, Symbols: SYM0,SYM1,SYM2,SYM3,SYM4,SYM5,SYM6,SYM7,SYM8,SYM9

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/simulator?symbols=SYM0,SYM1,SYM2,SYM3,SYM4,SYM5,SYM6,SYM7,SYM8,SYM9,SYM10,SYM11,SYM12,SYM13,SYM14,SYM15,SYM16,SYM17,SYM18,SYM19 HTTP/1.1" 200 438 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: '; DROP TABLE buy_sell_daily; --, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=%27%3B%20DROP%20TABLE%20buy_sell_daily%3B%20-- HTTP/1.1" 200 49863 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: SYMBOL中文, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=SYMBOL%E4%B8%AD%E6%96%87 HTTP/1.1" 200 48284 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: , type: , timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=&signal_type= HTTP/1.1" 200 47042 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol:    , type: 	, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=%20%20%20&signal_type=%09 HTTP/1.1" 200 43777 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals HTTP/1.1" 200 47104 "-" "-"
  console.log
    🔄 Trading positions requested for user: anonymous

      at log (routes/trading.js:1212:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/positions HTTP/1.1" 200 75 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: false

      at log (routes/trading.js:1790:13)

  console.log
    🎮 Trading simulator requested - Portfolio: $100000, Strategy: momentum, Symbols: SPY,QQQ,AAPL,TSLA,NVDA

      at log (routes/trading.js:1601:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies HTTP/1.1" 200 544 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/performance HTTP/1.1" 200 89 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/simulator HTTP/1.1" 200 401 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=10 HTTP/1.1" 200 5610 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=10 HTTP/1.1" 200 5642 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=10 HTTP/1.1" 200 5402 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=10 HTTP/1.1" 200 5608 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=10 HTTP/1.1" 200 5650 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?limit=500 HTTP/1.1" 200 231761 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?limit=5

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { limit: '5' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:22.212Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 5, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 4 rows out of 4 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals/daily?limit=5 HTTP/1.1" 200 1329 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/performance?days=30 HTTP/1.1" 200 89 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/swing-signals?limit=3 HTTP/1.1" 200 836 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies?limit=2 HTTP/1.1" 200 543 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals HTTP/1.1" 200 46956 "-" "-"
  console.log
    [TRADING] Debug endpoint called

      at log (routes/trading.js:146:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/debug HTTP/1.1" 200 392 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/health HTTP/1.1" 200 137 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: undefined, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals HTTP/1.1" 200 47047 "-" "-"
  console.log
    📈 Trading strategies requested - category: all, risk: all, active: false

      at log (routes/trading.js:1790:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/strategies HTTP/1.1" 200 544 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/performance HTTP/1.1" 200 89 "-" "-"
  console.error
    Error: SyntaxError: Unexpected end of JSON input
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"invalid": ',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 400 135 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1" 200 51787 "-" "-"
  console.log
    🎯 Trading signals requested - user: undefined, symbol: @, type: undefined, timeframe: daily

      at log (routes/trading.js:203:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals?symbol=@ HTTP/1.1" 200 46761 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
  console.log
    [TRADING] ========= ROUTE ENTRY =========

      at log (routes/trading.js:446:11)

  console.log
    [TRADING] Request URL: /signals/daily?limit=10

      at log (routes/trading.js:447:11)

  console.log
    [TRADING] Received request for /signals/:timeframe {
      params: { timeframe: 'daily' },
      query: { limit: '10' },
      path: '/signals/daily',
      method: 'GET',
      time: '2025-09-23T13:39:22.307Z'
    }

      at log (routes/trading.js:448:11)

  console.log
    [TRADING] Table existence check results:

      at log (routes/trading.js:733:13)

  console.log
      Main table exists: true

      at log (routes/trading.js:734:13)

  console.log
      Company profile exists: true

      at log (routes/trading.js:735:13)

  console.log
      Price daily exists: true

      at log (routes/trading.js:736:13)

  console.log
    [TRADING] Executing SQL: 
            SELECT 
              bs.symbol,
              bs.date,
              bs.signal_type as signal,
              bs.price,
              bs.stoplevel as stoplevel,
              bs.inposition as inposition,
              pd.close as current_price,
              cp.short_name as company_name,
              cp.sector as sector,
              NULL as market_cap,
              NULL as trailing_pe,
              pd.dividends as dividend_yield,
              CASE 
                WHEN bs.signal_type = 'BUY' AND pd.close > bs.price
                THEN ((pd.close - bs.price) / bs.price * 100)
                WHEN bs.signal_type = 'SELL' AND pd.close < bs.price
                THEN ((bs.price - pd.close) / bs.price * 100)
                ELSE 0
              END as performance_percent
            FROM buy_sell_daily bs
            LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
            LEFT JOIN fundamental_metrics fm ON bs.symbol = fm.symbol
            LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
            
            ORDER BY bs.date DESC, bs.symbol ASC
            LIMIT $1 OFFSET $2
           Params: [ 10, 0 ]

      at log (routes/trading.js:737:13)

  console.log
    [TRADING] Executing count SQL: 
            SELECT COUNT(*) as total
            FROM buy_sell_daily bs
            
           Params: []

      at log (routes/trading.js:738:13)

  console.log
    [TRADING] About to execute main query...

      at log (routes/trading.js:745:13)

  console.log
    [TRADING] Main query successful, now executing count query...

      at log (routes/trading.js:747:13)

  console.log
    [TRADING] Both queries successful

      at log (routes/trading.js:754:13)

  console.log
    [TRADING] Query returned 4 rows out of 4 total

      at log (routes/trading.js:784:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/signals/daily?limit=10 HTTP/1.1" 200 1330 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/orders HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "GET /api/trading/orders HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 0.5 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, BUY 1 aapl

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 400 91 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 616 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, buy 1000000 AAPL

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 622 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 Order placement requested for user: dev-user-bypass, sell 10 TSLA

      at log (routes/trading.js:1458:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:22 +0000] "POST /api/trading/orders HTTP/1.1" 201 625 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/routes/trading.integration.test.js
  Trading Routes Integration Tests
    GET /api/trading (Root endpoint)
      ✓ should return trading API information (4 ms)
      ✓ should handle concurrent requests to root endpoint (4 ms)
    GET /api/trading/health
      ✓ should return health status without authentication (2 ms)
      ✓ should return consistent health status across multiple calls (4 ms)
    GET /api/trading/debug
      ✓ should return debug information about trading tables (25 ms)
    GET /api/trading/signals
      ✓ should return all trading signals without authentication (6 ms)
      ✓ should handle limit parameter for signals (8 ms)
      ✓ should handle symbol filtering (4 ms)
      ✓ should handle signal type filtering (5 ms)
      ✓ should reject invalid limit values (3 ms)
      ✓ should reject excessive limit values (3 ms)
    GET /api/trading/signals/:timeframe
      ✓ should return daily signals (34 ms)
      ✓ should return weekly signals (29 ms)
      ✓ should return monthly signals (30 ms)
      ✓ should reject invalid timeframes (11 ms)
      ✓ should handle pagination parameters (25 ms)
      ✓ should handle latest_only parameter (29 ms)
      ✓ should handle symbol and signal type filters together (15 ms)
    GET /api/trading/summary/:timeframe
      ✓ should return daily signals summary (3 ms)
      ✓ should return weekly signals summary (5 ms)
      ✓ should reject invalid timeframes for summary (2 ms)
    GET /api/trading/swing-signals
      ✓ should return swing trading signals (13 ms)
      ✓ should handle pagination for swing signals (14 ms)
    GET /api/trading/:ticker/technicals
      ✓ should return technical indicators for a stock (2 ms)
      ✓ should handle timeframe parameter for technicals (1 ms)
      ✓ should handle monthly timeframe for technicals (2 ms)
    GET /api/trading/performance
      ✓ should return performance summary of recent signals (3 ms)
      ✓ should handle custom days parameter (4 ms)
      ✓ should handle invalid days parameter gracefully (3 ms)
    GET /api/trading/positions
      ✓ should return current trading positions (3 ms)
      ✓ should return positions summary when requested (5 ms)
    GET /api/trading/orders (Authenticated)
      ✓ should require authentication for orders (1 ms)
      ✓ should return trading orders with valid authentication (7 ms)
      ✓ should handle database unavailability for orders (9 ms)
    POST /api/trading/orders (Authenticated)
      ✓ should require authentication for order creation (3 ms)
      ✓ should create market buy order with valid data (4 ms)
      ✓ should create limit sell order with valid data (5 ms)
      ✓ should reject order with missing required fields (5 ms)
      ✓ should reject order with invalid order type (3 ms)
      ✓ should reject order with invalid side (3 ms)
      ✓ should reject order with invalid quantity (2 ms)
      ✓ should reject limit order without limit price (3 ms)
      ✓ should handle stop limit order with valid data (4 ms)
    GET /api/trading/simulator
      ✓ should return trading simulation results with default parameters (6 ms)
      ✓ should handle custom simulation parameters (6 ms)
      ✓ should reject invalid portfolio values (1 ms)
      ✓ should reject negative portfolio values (3 ms)
      ✓ should reject invalid strategy (1 ms)
    GET /api/trading/strategies
      ✓ should return all trading strategies (4 ms)
      ✓ should filter strategies by category (4 ms)
      ✓ should filter strategies by risk level (3 ms)
      ✓ should filter active strategies only (4 ms)
      ✓ should handle limit parameter (5 ms)
      ✓ should combine multiple filters (3 ms)
    GET /api/trading/strategies/:strategyId
      ✓ should return detailed strategy information (4 ms)
      ✓ should include signals when requested (3 ms)
      ✓ should include backtest results when requested (5 ms)
      ✓ should include both signals and backtest when both requested (6 ms)
      ✓ should return strategy details without optional includes (3 ms)
      ✓ should include signals when requested (3 ms)
      ✓ should include backtest results when requested (3 ms)
      ✓ should handle both signals and backtest parameters (4 ms)
      ✓ should handle invalid strategy ID gracefully (4 ms)
    Advanced Parameter Validation
      ✓ should handle multiple complex query parameters for signals (18 ms)
      ✓ should handle zero and negative page numbers (24 ms)
      ✓ should handle extremely large page numbers (24 ms)
      ✓ should handle performance endpoint with edge case days parameter (3 ms)
      ✓ should handle performance endpoint with very large days parameter (13 ms)
      ✓ should handle simulator with minimum portfolio value (5 ms)
      ✓ should handle simulator with maximum realistic portfolio (8 ms)
      ✓ should handle simulator with extensive symbol list (6 ms)
    Database Edge Cases
      ✓ should handle potential SQL injection in symbol parameters (5 ms)
      ✓ should handle Unicode and international symbols (4 ms)
      ✓ should handle empty string parameters gracefully (5 ms)
      ✓ should handle whitespace-only parameters (4 ms)
    Performance and Load Testing
      ✓ should handle multiple concurrent requests to different endpoints (16 ms)
      ✓ should handle rapid sequential requests to same endpoint (15 ms)
      ✓ should maintain response time consistency across requests (3 ms)
      ✓ should handle memory-intensive operations gracefully (12 ms)
    Data Consistency and Validation
      ✓ should validate signal data structure consistency (25 ms)
      ✓ should validate performance data calculation accuracy (3 ms)
      ✓ should validate swing signals structure (13 ms)
      ✓ should validate strategies data completeness (4 ms)
    Error Recovery and Resilience
      ✓ should gracefully handle database connection timeouts (6 ms)
      ✓ should handle partial data availability scenarios (8 ms)
      ✓ should maintain API availability during high error rates (10 ms)
    Edge Cases and Error Handling
      ✓ should handle malformed JSON in POST requests (6 ms)
      ✓ should handle very long symbol names (5 ms)
      ✓ should handle special characters in symbol parameter (4 ms)
      ✓ should handle concurrent order submissions (10 ms)
      ✓ should handle performance testing with response time validation (22 ms)
      ✓ should handle missing authentication header gracefully (1 ms)
      ✓ should handle malformed authentication token (7 ms)
      ✓ should handle large payload sizes gracefully (4 ms)
      ✓ should handle order validation edge cases (13 ms)
      ✓ should handle complex stop-limit order scenarios (4 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Portfolio rebalance execution called for user: dev-user-bypass

      at log (routes/portfolio.js:2076:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio allocation requested for user: dev-user-bypass

      at log (routes/portfolio.js:5785:13)

  console.error
    Database query error: {
      error: 'column ph.cost_basis does not exist',
      query: '\n' +
        '      SELECT \n' +
        '        ph.symbol, ph.quantity, ph.market_value, ph.cost_basis,\n' +
        '        COALESCE(cp.s...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/portfolio.js:5803:28

  console.error
    Portfolio allocation error: error: column ph.cost_basis does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/portfolio.js:5803:28 {
      length: 111,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '65',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      5909 |     });
      5910 |   } catch (error) {
    > 5911 |     console.error("Portfolio allocation error:", error);
           |             ^
      5912 |     res.status(500).json({
      5913 |       success: false,
      5914 |       error: "Failed to fetch portfolio allocation",

      at error (routes/portfolio.js:5911:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/unit/routes/portfolio.test.js
  Portfolio Routes Unit Tests
    GET /portfolio
      ○ skipped should return portfolio info
    GET /portfolio/holdings
      ○ skipped should return holdings data
    GET /portfolio/performance
      ○ skipped should return performance data
    GET /portfolio/analytics
      ○ skipped should return analytics data
    GET /portfolio/value
      ○ skipped should return portfolio value data
    GET /portfolio/risk-analysis
      ○ skipped should return risk analysis data
    GET /portfolio/returns
      ○ skipped should return returns data
    GET /portfolio/benchmark
      ○ skipped should return benchmark data
    GET /portfolio/risk
      ○ skipped should return risk data
    GET /portfolio/risk-metrics
      ○ skipped should return risk metrics
    POST /portfolio/rebalance/execute
      ○ skipped should execute rebalance with valid recommendations
      ○ skipped should reject rebalance without recommendations
      ○ skipped should reject invalid recommendations format
    GET /portfolio/allocation - metadata integration
      ✕ should return allocation with last rebalance date from metadata (78 ms)
    GET /portfolio/optimization
      ○ skipped should return portfolio optimization recommendations
      ○ skipped should handle optimization with risk tolerance parameters
      ○ skipped should include rebalancing suggestions
    POST /portfolio/optimization/execute
      ○ skipped should execute optimization recommendations
    GET /portfolio/analysis
      ○ skipped should return comprehensive portfolio analysis
      ○ skipped should include sector breakdown
      ○ skipped should handle time period analysis
    GET /portfolio/rebalance
      ○ skipped should return rebalancing recommendations
      ○ skipped should handle custom target allocations
      ○ skipped should validate allocation percentages sum to 100
    GET /portfolio/metrics
      ○ skipped should return detailed portfolio metrics
      ○ skipped should include advanced risk metrics
      ○ skipped should support different time periods
    GET /portfolio/holdings/detailed
      ○ skipped should return detailed holdings information
      ○ skipped should filter holdings by minimum value
      ○ skipped should sort holdings by different criteria
    POST /portfolio/holdings/add
      ○ skipped should add new holding to portfolio
      ○ skipped should validate required fields
      ○ skipped should handle duplicate holdings
    GET /portfolio/performance/history
      ○ skipped should return historical performance data
      ○ skipped should handle date range filtering
      ○ skipped should include benchmark comparison
    GET /portfolio/performance/attribution
      ○ skipped should return performance attribution analysis
      ○ skipped should break down attribution by holdings
    GET /portfolio/watchlist
      ○ skipped should return portfolio watchlist
      ○ skipped should include price alerts
    POST /portfolio/watchlist/add
      ○ skipped should add symbol to watchlist
      ○ skipped should validate symbol format
    GET /portfolio/export
      ○ skipped should export portfolio data in CSV format
      ○ skipped should export portfolio data in JSON format
      ○ skipped should include all requested data fields
    Error handling
      ○ skipped should handle invalid endpoints gracefully
      ○ skipped should handle missing authorization
      ○ skipped should handle database connection errors
      ○ skipped should handle invalid query parameters
      ○ skipped should handle large data requests with pagination

  ● Portfolio Routes Unit Tests › GET /portfolio/allocation - metadata integration › should return allocation with last rebalance date from metadata

    expected 200 "OK", got 500 "Internal Server Error"

      252 |         .get("/portfolio/allocation")
      253 |         .set("Authorization", "Bearer dev-bypass-token")
    > 254 |         .expect(200);
          |          ^
      255 |
      256 |       expect(response.body).toHaveProperty("success", true);
      257 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/unit/routes/portfolio.test.js:254:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/summary HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/alerts/active HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/trades HTTP/1.1" 200 152 "-" "-"
::ffff:127.0.0.1 - test [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/alerts/active HTTP/1.1" 200 1508 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "POST /api/portfolio/analyze HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/alerts/active HTTP/1.1" 200 1508 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/alerts/active HTTP/1.1" 200 1508 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/summary HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/positions HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/analytics HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/analysis HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/risk-analysis HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/performance HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/holdings HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/transactions HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/trades HTTP/1.1" 200 152 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/alerts/active HTTP/1.1" 401 529 "-" "-"
  console.log
    📊 Backtest results requested - ID: all, limit: 50

      at log (routes/backtest.js:855:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/backtest/results HTTP/1.1" 200 934 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/health HTTP/1.1" 200 500 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/health HTTP/1.1" 200 500 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "POST /api/portfolio/analyze HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 404 131 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/auth/auth-flow.integration.test.js
  Authentication Flow Integration
    Token-Based Authentication Flow
      ✓ should handle dev bypass token authentication (6 ms)
      ✓ should reject invalid tokens (12 ms)
      ✕ should handle missing authorization header (5 ms)
    Authorization Header Validation
      ✓ should validate Bearer token format (14 ms)
      ✓ should handle case sensitivity in authorization (12 ms)
    Authentication Context Propagation
      ✓ should maintain authentication context across request pipeline (26 ms)
      ✓ should handle authentication in POST/PUT requests (7 ms)
    Multi-Request Authentication Sessions
      ✓ should handle multiple sequential authenticated requests (23 ms)
      ✓ should handle concurrent authenticated requests (29 ms)
    Authentication Error Handling
      ✓ should provide consistent error responses for auth failures (6 ms)
      ✓ should not leak sensitive information in auth errors (4 ms)
    Route-Specific Authentication
      ✓ should enforce authentication on protected routes (15 ms)
      ✓ should allow public access to public routes (23 ms)
      ✓ should handle mixed public/protected route access (14 ms)
    Authentication Performance
      ✓ should handle authentication efficiently (26 ms)
      ✓ should handle rapid authentication attempts (52 ms)
    Authentication Integration with Other Middleware
      ✓ should work with request validation (9 ms)
      ✓ should work with error handling middleware (4 ms)

  ● Authentication Flow Integration › Token-Based Authentication Flow › should handle missing authorization header

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 403, 500]

      87 |         const response = await request(app).get(endpoint);
      88 |
    > 89 |         expect([401, 403, 500]).toContain(response.status);
         |                                 ^
      90 |
      91 |         // Should return authentication error
      92 |         if (response.status === 401 || response.status === 403) {

      at Object.toContain (tests/integration/auth/auth-flow.integration.test.js:89:33)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic HTTP/1.1" 200 493 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=1&limit=10 HTTP/1.1" 200 493 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?series=GDP HTTP/1.1" 200 187 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?series=UNEMPLOYMENT_RATE HTTP/1.1" 200 197 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?series=VIX HTTP/1.1" 200 184 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?series=FEDERAL_FUNDS_RATE HTTP/1.1" 200 199 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?series=INFLATION_RATE HTTP/1.1" 200 194 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?limit=5 HTTP/1.1" 200 492 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=-1&limit=10 HTTP/1.1" 400 100 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=0&limit=10 HTTP/1.1" 400 100 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=1&limit=-5 HTTP/1.1" 400 101 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=abc&limit=def HTTP/1.1" 400 100 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?page=999999&limit=1000 HTTP/1.1" 404 56 "-" "-"
  console.log
    📊 Economic indicators requested, category: all

      at log (routes/economic.js:210:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/indicators HTTP/1.1" 200 1956 "-" "-"
  console.log
    📊 Economic indicators requested, category: all

      at log (routes/economic.js:210:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/indicators HTTP/1.1" 200 1956 "-" "-"
  console.log
    📊 Economic indicators requested, category: growth

      at log (routes/economic.js:210:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/indicators?category=growth HTTP/1.1" 404 248 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: 2025-01-01, end: 2025-12-31, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?start_date=2025-01-01&end_date=2025-12-31 HTTP/1.1" 200 116 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: high, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?importance=high HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: medium, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?importance=medium HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: low, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?importance=low HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: US

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?country=US HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: EU

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?country=EU HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: JP

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?country=JP HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: GB

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?country=GB HTTP/1.1" 200 104 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: CA

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar?country=CA HTTP/1.1" 200 104 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: VIX, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/VIX HTTP/1.1" 200 347 "-" "-"
  console.log
    📈 Economic series requested - series: FEDERAL_FUNDS_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/FEDERAL_FUNDS_RATE HTTP/1.1" 200 377 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: 1Y

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP?timeframe=1Y HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: 2Y

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP?timeframe=2Y HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: 5Y

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP?timeframe=5Y HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: 10Y

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP?timeframe=10Y HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: GDP, timeframe: max

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP?timeframe=max HTTP/1.1" 200 353 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?frequency=daily HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?frequency=weekly HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?frequency=monthly HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?frequency=quarterly HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?frequency=annual HTTP/1.1" 200 373 "-" "-"
  console.log
    📈 Economic series requested - series: INVALID_SERIES, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/INVALID_SERIES HTTP/1.1" 404 352 "-" "-"
  console.log
    ⚖️ Economic comparison requested - series: GDP,UNEMPLOYMENT_RATE,VIX

      at log (routes/economic.js:619:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/compare?series=GDP,UNEMPLOYMENT_RATE,VIX HTTP/1.1" 200 661 "-" "-"
  console.log
    ⚖️ Economic comparison requested - series: GDP,UNEMPLOYMENT_RATE

      at log (routes/economic.js:619:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/compare?series=GDP,UNEMPLOYMENT_RATE&normalize=true HTTP/1.1" 200 458 "-" "-"
  console.log
    ⚖️ Economic comparison requested - series: GDP,UNEMPLOYMENT_RATE

      at log (routes/economic.js:619:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/compare?series=GDP,UNEMPLOYMENT_RATE&align_period=quarterly HTTP/1.1" 200 461 "-" "-"
  console.log
    🔮 Economic forecast requested - series: GDP, horizon: undefined

      at log (routes/economic.js:413:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/forecast?series=GDP HTTP/1.1" 404 269 "-" "-"
  console.log
    🔮 Economic forecast requested - series: UNEMPLOYMENT_RATE, horizon: 1Q

      at log (routes/economic.js:413:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/forecast?series=UNEMPLOYMENT_RATE&horizon=1Q HTTP/1.1" 404 283 "-" "-"
  console.log
    🔮 Economic forecast requested - series: UNEMPLOYMENT_RATE, horizon: undefined

      at log (routes/economic.js:413:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/forecast?series=UNEMPLOYMENT_RATE&confidence=0.95 HTTP/1.1" 404 283 "-" "-"
  console.log
    🔗 Economic correlations requested - series: FEDERAL_FUNDS_RATE, timeframe: undefined

      at log (routes/economic.js:510:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/correlations?series=FEDERAL_FUNDS_RATE HTTP/1.1" 200 254 "-" "-"
  console.log
    🔗 Economic correlations requested - series: UNEMPLOYMENT_RATE, timeframe: 5Y

      at log (routes/economic.js:510:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/correlations?series=UNEMPLOYMENT_RATE&timeframe=5Y HTTP/1.1" 200 253 "-" "-"
  console.log
    📊 Economic indicators requested, category: all

      at log (routes/economic.js:210:13)

  console.log
    📅 Economic calendar requested - start: undefined, end: undefined, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

  console.log
    📈 Economic series requested - series: GDP, timeframe: undefined

      at log (routes/economic.js:333:13)

  console.log
    🔮 Economic forecast requested - series: UNEMPLOYMENT_RATE, horizon: undefined

      at log (routes/economic.js:413:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic HTTP/1.1" 200 493 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/forecast?series=UNEMPLOYMENT_RATE HTTP/1.1" 404 283 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/indicators HTTP/1.1" 200 1956 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/calendar HTTP/1.1" 200 104 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/series/GDP HTTP/1.1" 200 353 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic?limit=1000 HTTP/1.1" 200 495 "-" "-"
  console.log
    📊 Economic indicators requested, category: all

      at log (routes/economic.js:210:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:23 +0000] "GET /api/economic/indicators HTTP/1.1" 200 1956 "-" "-"
  console.log
    📅 Economic calendar requested - start: invalid-date, end: undefined, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

  console.error
    Database query error: {
      error: 'invalid input syntax for type date: "invalid-date"',
      query: '\n' +
        '      SELECT \n' +
        '        series_id as event_name,\n' +
        '        date as event_date,\n' +
        '        value as forecas...',
      params: '2 parameters',
      code: '22007'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/economic.js:289:28

  console.error
    Economic calendar error: error: invalid input syntax for type date: "invalid-date"
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/economic.js:289:28 {
      length: 116,
      severity: 'ERROR',
      code: '22007',
      detail: undefined,
      hint: undefined,
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'datetime.c',
      line: '4026',
      routine: 'DateTimeParseError'
    }

      315 |     });
      316 |   } catch (error) {
    > 317 |     console.error("Economic calendar error:", error);
          |             ^
      318 |     return res.status(500).json({
      319 |       success: false,
      320 |       error: "Failed to fetch economic calendar data",

      at error (routes/economic.js:317:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/calendar?start_date=invalid-date HTTP/1.1" 500 247 "-" "-"
  console.log
    📅 Economic calendar requested - start: undefined, end: 2025-13-40, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

  console.error
    Database query error: {
      error: 'date/time field value out of range: "2025-13-40"',
      query: '\n' +
        '      SELECT \n' +
        '        series_id as event_name,\n' +
        '        date as event_date,\n' +
        '        value as forecas...',
      params: '2 parameters',
      code: '22008'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/economic.js:289:28

  console.error
    Economic calendar error: error: date/time field value out of range: "2025-13-40"
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/economic.js:289:28 {
      length: 165,
      severity: 'ERROR',
      code: '22008',
      detail: undefined,
      hint: 'Perhaps you need a different "datestyle" setting.',
      position: undefined,
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'datetime.c',
      line: '3992',
      routine: 'DateTimeParseError'
    }

      315 |     });
      316 |   } catch (error) {
    > 317 |     console.error("Economic calendar error:", error);
          |             ^
      318 |     return res.status(500).json({
      319 |       success: false,
      320 |       error: "Failed to fetch economic calendar data",

      at error (routes/economic.js:317:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/calendar?end_date=2025-13-40 HTTP/1.1" 500 245 "-" "-"
  console.log
    📅 Economic calendar requested - start: 2025-12-31, end: 2025-01-01, importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/calendar?start_date=2025-12-31&end_date=2025-01-01 HTTP/1.1" 200 116 "-" "-"
  console.log
    📅 Economic calendar requested - start: , end: , importance: undefined, country: undefined

      at log (routes/economic.js:284:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/calendar?start_date=&end_date= HTTP/1.1" 200 104 "-" "-"
  console.log
    📈 Economic series requested - series: UNEMPLOYMENT_RATE, timeframe: undefined

      at log (routes/economic.js:333:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/series/UNEMPLOYMENT_RATE?limit=10 HTTP/1.1" 200 373 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic HTTP/1.1" 200 493 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic?series=GDP%27%3B%20DROP%20TABLE%20economic_data%3B%20-- HTTP/1.1" 404 56 "-" "-"
  console.log
    ⚖️ Economic comparison requested - series: GDP,UNEMPLOYMENT_RATE,FEDERAL_FUNDS_RATE,INFLATION_RATE

      at log (routes/economic.js:619:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/compare?series=GDP,UNEMPLOYMENT_RATE,FEDERAL_FUNDS_RATE,INFLATION_RATE&timeframe=max HTTP/1.1" 200 1047 "-" "-"
  console.log
    🔮 Economic forecast requested - series: GDP, horizon: 1Y

      at log (routes/economic.js:413:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/economic/forecast?series=GDP&horizon=1Y HTTP/1.1" 404 269 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/economic.integration.test.js
  Economic Routes Integration Tests
    GET /api/economic (Economic Data)
      ✓ should return economic data with pagination (8 ms)
      ✓ should handle page and limit parameters (2 ms)
      ✓ should filter by economic series (14 ms)
      ✓ should validate economic data structure (2 ms)
      ✕ should handle invalid pagination parameters (8 ms)
    GET /api/economic/indicators
      ✓ should return available economic indicators (8 ms)
      ✓ should categorize economic indicators (4 ms)
      ✕ should handle category filter for indicators (4 ms)
    GET /api/economic/calendar
      ✓ should return economic calendar events (6 ms)
      ✓ should handle date range for calendar (4 ms)
      ✓ should filter by importance level (10 ms)
      ✓ should handle country filter (19 ms)
    GET /api/economic/series/:seriesId
      ✓ should return specific economic series data (19 ms)
      ✓ should handle timeframe parameter for series (18 ms)
      ✓ should handle frequency parameter (19 ms)
      ✓ should handle invalid series ID (4 ms)
    GET /api/economic/compare
      ✓ should compare multiple economic series (5 ms)
      ✓ should handle normalization parameter (4 ms)
      ✓ should handle period alignment (4 ms)
    GET /api/economic/forecast
      ✕ should return economic forecasts (4 ms)
      ✕ should handle forecast horizon parameter (4 ms)
      ✕ should handle confidence level parameter (4 ms)
    GET /api/economic/correlations
      ✓ should return correlations with market indices (5 ms)
      ✓ should handle timeframe for correlations (3 ms)
    Performance and Edge Cases
      ✕ should handle concurrent requests to economic endpoints (19 ms)
      ✓ should handle large data requests gracefully (2 ms)
      ✓ should maintain response time consistency (3 ms)
      ✓ should handle malformed date parameters (27 ms)
      ✓ should validate economic data value ranges (4 ms)
      ✓ should handle database connection failures gracefully (2 ms)
      ✕ should handle SQL injection attempts (2 ms)
      ✓ should handle memory pressure with large datasets (4 ms)
      ✓ should validate forecast accuracy metadata (3 ms)

  ● Economic Routes Integration Tests › GET /api/economic (Economic Data) › should handle invalid pagination parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

       99 |         const response = await request(app).get(`/api/economic?${params}`);
      100 |
    > 101 |         expect([200, 400, 500, 503].includes(response.status)).toBe(true);
          |                                                                ^
      102 |       }
      103 |     });
      104 |   });

      at Object.toBe (tests/integration/routes/economic.integration.test.js:101:64)

  ● Economic Routes Integration Tests › GET /api/economic/indicators › should handle category filter for indicators

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      148 |         );
      149 |
    > 150 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      151 |       }
      152 |     });
      153 |   });

      at Object.toBe (tests/integration/routes/economic.integration.test.js:150:54)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should return economic forecasts

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      312 |       );
      313 |
    > 314 |       expect(response.status).toBe(200);
          |                               ^
      315 |
      316 |       if (response.status === 200) {
      317 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/economic.integration.test.js:314:31)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should handle forecast horizon parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      331 |         );
      332 |
    > 333 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      334 |       }
      335 |     });
      336 |

      at Object.toBe (tests/integration/routes/economic.integration.test.js:333:54)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should handle confidence level parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      340 |       );
      341 |
    > 342 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      343 |     });
      344 |   });
      345 |

      at Object.toBe (tests/integration/routes/economic.integration.test.js:342:52)

  ● Economic Routes Integration Tests › Performance and Edge Cases › should handle concurrent requests to economic endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      387 |
      388 |       responses.forEach((response) => {
    > 389 |         expect(response.status).toBe(200);
          |                                 ^
      390 |       });
      391 |     });
      392 |

      at toBe (tests/integration/routes/economic.integration.test.js:389:33)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/economic.integration.test.js:388:17)

  ● Economic Routes Integration Tests › Performance and Edge Cases › should handle SQL injection attempts

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      453 |       );
      454 |
    > 455 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      456 |     });
      457 |
      458 |     test("should handle memory pressure with large datasets", async () => {

      at Object.toBe (tests/integration/routes/economic.integration.test.js:455:52)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:24.460Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live market data request","correlationId":"livedata-market-1758634764460","userId":"dev-user-bypass","query":{"symbols":"AAPL,GOOGL"},"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:24.463Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live market data request completed","correlationId":"livedata-market-1758634764460","duration":3,"hasIndices":true,"hasWatchlist":true,"errors":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/market?symbols=AAPL%2CGOOGL HTTP/1.1" 200 332 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:24.469Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data stream request","correlationId":"livedata-stream-1758634764469","userId":"dev-user-bypass","symbols":"AAPL,MSFT","type":"quotes","format":"json","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:24.471Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data stream request completed (test mode)","correlationId":"livedata-stream-1758634764469","duration":2,"symbols":["AAPL","MSFT"],"type":"quotes","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/stream?symbols=AAPL%2CMSFT&type=quotes HTTP/1.1" 200 330 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: GOOGL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/GOOGL HTTP/1.1" 200 296 "-" "-"
  console.log
    📊 Latest data requested for symbols: MSFT

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/MSFT HTTP/1.1" 200 288 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/portfolio/stream/value HTTP/1.1" 404 132 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/portfolio/stream/positions HTTP/1.1" 404 136 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:24 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: GOOGL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: MSFT

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/MSFT HTTP/1.1" 200 288 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/GOOGL HTTP/1.1" 200 296 "-" "-"
  console.log
    📊 Latest data requested for symbols: INVALID

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/INVALID HTTP/1.1" 404 216 "-" "-"
  console.log
    📊 Latest data requested for symbols: NOTFOUND

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/NOTFOUND HTTP/1.1" 404 218 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/ HTTP/1.1" 404 126 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/market?symbols=AAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL%2CAAPL HTTP/1.1" 401 529 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL?detailed=true&history=1000 HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/market?symbols=AAPL%2CGOOGL%2CMSFT HTTP/1.1" 401 529 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/latest/AAPL HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/market?symbols=AAPL HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.792Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data stream request","correlationId":"livedata-stream-1758634765792","userId":"dev-user-bypass","symbols":"default_watchlist","type":"quote","format":"json","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.794Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data stream request completed (test mode)","correlationId":"livedata-stream-1758634765792","duration":2,"symbols":["AAPL","MSFT","GOOGL","AMZN","TSLA","NVDA","META"],"type":"quote","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/stream?symbol=AAPL&type=quote HTTP/1.1" 200 365 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.799Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data stream request","correlationId":"livedata-stream-1758634765799","userId":"dev-user-bypass","symbols":"default_watchlist","type":"trade","format":"json","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.801Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data stream request completed (test mode)","correlationId":"livedata-stream-1758634765799","duration":2,"symbols":["AAPL","MSFT","GOOGL","AMZN","TSLA","NVDA","META"],"type":"trade","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/stream?symbol=AAPL&type=trade HTTP/1.1" 200 365 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.805Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data stream request","correlationId":"livedata-stream-1758634765805","userId":"dev-user-bypass","symbols":"default_watchlist","type":"bar","format":"json","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/stream?symbol=AAPL&type=bar HTTP/1.1" 501 110 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:39:25.811Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data stream request","correlationId":"livedata-stream-1758634765811","userId":"dev-user-bypass","symbols":"default_watchlist","type":"news","format":"json","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/liveData/stream?symbol=AAPL&type=news HTTP/1.1" 501 111 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/portfolio/stream/value HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/portfolio/stream/value HTTP/1.1" 404 132 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/portfolio/stream/positions HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/portfolio/stream/positions HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/alerts/stream HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 [ALERTS] Fetching streaming alerts for user dev-user-bypass

      at log (routes/alerts.js:2652:15)

  console.log
    ✅ [ALERTS] Successfully streamed 0 alerts for user dev-user-bypass

      at log (routes/alerts.js:2744:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/alerts/stream HTTP/1.1" 200 279 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:25 +0000] "GET /api/portfolio/stream/value HTTP/1.1" 404 132 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/stream/positions HTTP/1.1" 404 136 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/stream/value HTTP/1.1" 404 132 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/streaming/streaming-data.integration.test.js
  Streaming Data Integration
    Real-Time Market Data Streaming
      ✓ should handle market data requests (13 ms)
      ✓ should handle streaming data subscriptions (8 ms)
      ✓ should handle real-time quote data (14 ms)
    Portfolio Streaming Updates
      ✓ should handle portfolio value streaming (3 ms)
      ✓ should handle position streaming updates (3 ms)
    Streaming Data Consistency
      ✓ should maintain data consistency across multiple requests (823 ms)
      ✓ should handle concurrent streaming requests (17 ms)
    Streaming Error Handling
      ✓ should handle invalid symbols gracefully (8 ms)
      ✓ should handle streaming service failures (5 ms)
      ✓ should handle network timeout scenarios (1 ms)
    Streaming Performance
      ✓ should deliver streaming data within reasonable time (4 ms)
      ✓ should handle high-frequency data requests (431 ms)
    Streaming Data Formats
      ✓ should return consistent data formats (6 ms)
      ✓ should handle different data type requests (24 ms)
    Authentication with Streaming Data
      ✓ should handle authentication for protected streaming endpoints (16 ms)
      ✓ should maintain streaming sessions with valid authentication (412 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    CORS not implemented - cross-origin requests allowed without explicit headers

      at Object.log (tests/integration/middleware/security-headers.integration.test.js:66:19)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 500 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    Request size limiting not implemented - recommendation for DoS protection

      at Object.log (tests/integration/middleware/security-headers.integration.test.js:192:17)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/stocks/%3Cscript%3Ealert(%27xss%27)%3C/script%3E/details HTTP/1.1" 404 166 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/stocks/AAPL%27;%20DROP%20TABLE%20stocks;%20--/details HTTP/1.1" 404 163 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/stocks/../../etc/passwd HTTP/1.1" 404 133 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 500 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 500 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    Rate limiting not implemented - recommendation for DDoS protection

      at Object.log (tests/integration/middleware/security-headers.integration.test.js:254:17)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 404 131 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/performance HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Portfolio performance endpoint called for user: dev-user-bypass, timeframe: invalid

      at log (routes/portfolio.js:1109:13)

  console.error
    Database query error: {
      error: 'column "benchmark_return" does not exist',
      query: '\n' +
        '      SELECT \n' +
        '        date, total_value, daily_pnl, daily_pnl_percent,\n' +
        '        total_pnl, total_pnl...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/portfolio.js:1133:31

  console.error
    Portfolio performance error: error: column "benchmark_return" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/portfolio.js:1133:31 {
      length: 117,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '119',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1217 |     res.json(responseWithTradingMode);
      1218 |   } catch (error) {
    > 1219 |     console.error("Portfolio performance error:", error);
           |             ^
      1220 |     return res.status(500).json({
      1221 |       success: false,
      1222 |       error: "Failed to fetch portfolio performance",

      at error (routes/portfolio.js:1219:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio/performance?timeframe=invalid&detailed=true&complex=true HTTP/1.1" 500 209 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:26 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "Mozilla/5.0 TestAgent"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/middleware/security-headers.integration.test.js
  Security Headers Integration
    CORS Headers
      ✓ should include proper CORS headers for API endpoints (8 ms)
      ✓ should handle preflight OPTIONS requests (1 ms)
      ✓ should handle cross-origin requests securely (4 ms)
    Security Headers
      ✓ should include security headers in responses (3 ms)
      ✓ should set appropriate content-type headers (4 ms)
      ✓ should handle authentication headers securely (3 ms)
    Content Security Policy
      ✓ should include CSP headers if configured (6 ms)
      ✓ should prevent clickjacking with frame options (4 ms)
    Request Validation Security
      ✓ should reject oversized request bodies (8 ms)
      ✕ should sanitize request parameters (1 ms)
      ✕ should prevent SQL injection attempts (2 ms)
      ✕ should handle path traversal attempts (1 ms)
    Rate Limiting Security
      ✓ should implement basic rate limiting (55 ms)
      ✓ should rate limit authenticated endpoints more strictly (46 ms)
    Error Information Leakage
      ✓ should not expose sensitive error information (3 ms)
      ✓ should not expose database connection details (5 ms)
      ✓ should handle server errors securely (57 ms)
    Authentication Security
      ✕ should reject requests with malformed authentication (1 ms)
      ✓ should handle authentication bypass attempts (5 ms)
    Input Validation Security
      ✓ should validate and sanitize JSON payloads (12 ms)
      ✓ should prevent header injection attacks (4 ms)

  ● Security Headers Integration › Request Validation Security › should sanitize request parameters

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      201 |         .set("Authorization", "Bearer dev-bypass-token");
      202 |
    > 203 |       expect([400, 422]).toContain(response.status);
          |                          ^
      204 |
      205 |       // Should handle malicious input safely
      206 |       if (response.body && typeof response.body === "string") {

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:203:26)

  ● Security Headers Integration › Request Validation Security › should prevent SQL injection attempts

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      214 |         .set("Authorization", "Bearer dev-bypass-token");
      215 |
    > 216 |       expect([400, 422]).toContain(response.status);
          |                          ^
      217 |       expect(response.headers["content-type"]).toMatch(/application\/json/);
      218 |     });
      219 |

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:216:26)

  ● Security Headers Integration › Request Validation Security › should handle path traversal attempts

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      223 |         .set("Authorization", "Bearer dev-bypass-token");
      224 |
    > 225 |       expect([400, 422]).toContain(response.status);
          |                          ^
      226 |       expect(response.headers["content-type"]).toMatch(/application\/json/);
      227 |     });
      228 |   });

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:225:26)

  ● Security Headers Integration › Authentication Security › should reject requests with malformed authentication

    expect(received).toContain(expected) // indexOf

    Expected value: 401
    Received array: [400, 422]

      352 |           .set("Authorization", token);
      353 |
    > 354 |         expect([400, 422]).toContain(response.status);
          |                            ^
      355 |         expect(response.headers["content-type"]).toMatch(/application\/json/);
      356 |
      357 |         // Should not reflect malicious content in response

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:354:28)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:39:27.349Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Operation not found","correlationId":"b907326c","operationId":"non_existent_timer","severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/performanceMonitor.test.js
  Performance Monitor Integration Tests
    Performance Timing
      ✓ should measure operation duration accurately (1 ms)
      ✓ should handle multiple concurrent timers (1 ms)
      ✓ should handle invalid timer IDs gracefully (6 ms)
    Metrics Recording
      ✕ should record custom metrics (1 ms)
      ✕ should record metrics with different categories (1 ms)
      ✕ should handle metrics with metadata
    Performance Analytics
      ✕ should calculate average response times
      ✓ should handle empty metrics gracefully (1 ms)
      ✕ should calculate metrics for different time ranges
    System Health Monitoring
      ✕ should collect system health metrics (1 ms)
      ✕ should include database health in system metrics
      ✕ should detect system health status accurately
    Anomaly Detection
      ✓ should detect performance anomalies (1 ms)
      ✓ should handle normal data without false positives
      ✕ should detect trend-based anomalies (1 ms)
    Performance Reporting
      ✕ should generate comprehensive performance report
      ✕ should include performance recommendations (1 ms)
      ✕ should filter report by categories
    Performance Benchmarking
      ✕ should benchmark database operations (4 ms)
      ✕ should benchmark API response times (272 ms)
      ✕ should compare performance across time periods (1 ms)
    Error Handling and Edge Cases
      ✓ should handle database connection issues gracefully
      ✕ should handle invalid time ranges
      ✕ should handle very large metric values
      ✕ should handle concurrent metric recording

  ● Performance Monitor Integration Tests › Metrics Recording › should record custom metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      137 |       const metrics = await getMetrics("test_metric", "1h");
      138 |
    > 139 |       expect(Array.isArray(metrics)).toBe(true);
          |                                      ^
      140 |       expect(metrics.length).toBeGreaterThan(0);
      141 |
      142 |       const values = metrics.map((m) => m.value);

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:139:38)

  ● Performance Monitor Integration Tests › Metrics Recording › should record metrics with different categories

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      164 |       const cacheMetrics = await getMetrics("response_time", "1h", "cache");
      165 |
    > 166 |       expect(apiMetrics.length).toBeGreaterThan(0);
          |                                 ^
      167 |       expect(dbMetrics.length).toBeGreaterThan(0);
      168 |       expect(cacheMetrics.length).toBeGreaterThan(0);
      169 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:166:33)

  ● Performance Monitor Integration Tests › Metrics Recording › should handle metrics with metadata

    TypeError: metrics.find is not a function

      184 |
      185 |       const metrics = await getMetrics("request_duration", "1h", "api");
    > 186 |       const metric = metrics.find(
          |                              ^
      187 |         (m) => m.metadata?.user_id === "test_user_123"
      188 |       );
      189 |

      at Object.find (tests/integration/utils/performanceMonitor.test.js:186:30)

  ● Performance Monitor Integration Tests › Performance Analytics › should calculate average response times

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      208 |       );
      209 |
    > 210 |       expect(avgResponseTime).toBeGreaterThan(0);
          |                               ^
      211 |       expect(avgResponseTime).toBe(143.75); // (100 + 150 + 200 + 125) / 4
      212 |     });
      213 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:210:31)

  ● Performance Monitor Integration Tests › Performance Analytics › should calculate metrics for different time ranges

    expect(received).toBeLessThanOrEqual(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      240 |       const metrics2h = await getMetrics("time_test", "2h", "test");
      241 |
    > 242 |       expect(metrics1h.length).toBeLessThanOrEqual(metrics2h.length);
          |                                ^
      243 |     });
      244 |   });
      245 |

      at Object.toBeLessThanOrEqual (tests/integration/utils/performanceMonitor.test.js:242:32)

  ● Performance Monitor Integration Tests › System Health Monitoring › should collect system health metrics

    expect(received).toHaveProperty(path)

    Expected path: "timestamp"
    Received path: []

    Received value: {"averageDuration": 109, "score": 98, "slowOperations": 0, "status": "healthy", "successRate": "100.00", "totalOperations": 17}

      249 |
      250 |       expect(health).toHaveProperty("status");
    > 251 |       expect(health).toHaveProperty("timestamp");
          |                      ^
      252 |       expect(health).toHaveProperty("metrics");
      253 |
      254 |       expect(health.metrics).toHaveProperty("memory");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:251:22)

  ● Performance Monitor Integration Tests › System Health Monitoring › should include database health in system metrics

    expect(received).toHaveProperty(path)

    Matcher error: received value must not be null nor undefined

    Received has value: undefined

      272 |       const health = await getSystemHealth();
      273 |
    > 274 |       expect(health.metrics).toHaveProperty("database");
          |                              ^
      275 |       expect(health.metrics.database).toHaveProperty("connected");
      276 |       expect(health.metrics.database).toHaveProperty("pool_size");
      277 |       expect(health.metrics.database).toHaveProperty("active_connections");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:274:30)

  ● Performance Monitor Integration Tests › System Health Monitoring › should detect system health status accurately

    TypeError: Cannot read properties of undefined (reading 'memory')

      288 |
      289 |       if (health.status === "healthy") {
    > 290 |         expect(health.metrics.memory.usage_percent).toBeLessThan(90);
          |                               ^
      291 |         expect(health.metrics.cpu.usage).toBeLessThan(90);
      292 |       }
      293 |     });

      at Object.memory (tests/integration/utils/performanceMonitor.test.js:290:31)

  ● Performance Monitor Integration Tests › Anomaly Detection › should detect trend-based anomalies

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      343 |       const anomalies = await detectAnomalies("trend_test", "1h", "trend");
      344 |
    > 345 |       expect(anomalies.length).toBeGreaterThan(0);
          |                                ^
      346 |
      347 |       const dropAnomaly = anomalies.find((a) => a.value === 50);
      348 |       expect(dropAnomaly).toBeDefined();

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:345:32)

  ● Performance Monitor Integration Tests › Performance Reporting › should generate comprehensive performance report

    expect(received).toHaveProperty(path)

    Expected path: "summary"
    Received path: []

    Received value: {"activeRequests": 1, "alerts": [], "errorRate": 0, "status": "healthy", "timestamp": "2025-09-23T13:39:27.369Z", "totalRequests": 53, "uptime": 13.778414811}

      367 |       const report = await generatePerformanceReport("1h");
      368 |
    > 369 |       expect(report).toHaveProperty("summary");
          |                      ^
      370 |       expect(report).toHaveProperty("metrics");
      371 |       expect(report).toHaveProperty("anomalies");
      372 |       expect(report).toHaveProperty("recommendations");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:369:22)

  ● Performance Monitor Integration Tests › Performance Reporting › should include performance recommendations

    TypeError: Cannot read properties of undefined (reading 'length')

      391 |       const report = await generatePerformanceReport("1h");
      392 |
    > 393 |       expect(report.recommendations.length).toBeGreaterThan(0);
          |                                     ^
      394 |
      395 |       const recommendations = report.recommendations;
      396 |       const hasPerformanceRecommendation = recommendations.some(

      at Object.length (tests/integration/utils/performanceMonitor.test.js:393:37)

  ● Performance Monitor Integration Tests › Performance Reporting › should filter report by categories

    TypeError: Cannot read properties of undefined (reading 'every')

      417 |       const dbReport = await generatePerformanceReport("1h", "database");
      418 |
    > 419 |       expect(apiReport.metrics.every((m) => m.category === "api")).toBe(true);
          |                                ^
      420 |       expect(dbReport.metrics.every((m) => m.category === "database")).toBe(
      421 |         true
      422 |       );

      at Object.every (tests/integration/utils/performanceMonitor.test.js:419:32)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should benchmark database operations

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      445 |       // Verify metric was recorded
      446 |       const metrics = await getMetrics("db_benchmark", "1h", "database");
    > 447 |       expect(metrics.length).toBeGreaterThan(0);
          |                              ^
      448 |       expect(metrics[0].value).toBe(duration);
      449 |     });
      450 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:447:30)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should benchmark API response times

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: undefined

      477 |       // Verify all metrics were recorded
      478 |       const metrics = await getMetrics("api_benchmark", "1h", "api");
    > 479 |       expect(metrics.length).toBe(operations.length);
          |                              ^
      480 |     });
      481 |
      482 |     test("should compare performance across time periods", async () => {

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:479:30)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should compare performance across time periods

    TypeError: currentMetrics.reduce is not a function

      510 |       const currentMetrics = await getMetrics("comparison_test", "30m", "test");
      511 |       const currentAvg =
    > 512 |         currentMetrics.reduce((sum, m) => sum + m.value, 0) /
          |                        ^
      513 |         currentMetrics.length;
      514 |
      515 |       expect(previousAvg).toBeGreaterThan(currentAvg); // Performance improved

      at Object.reduce (tests/integration/utils/performanceMonitor.test.js:512:24)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle invalid time ranges

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      536 |     test("should handle invalid time ranges", async () => {
      537 |       const metrics = await getMetrics("test_metric", "invalid_range", "test");
    > 538 |       expect(Array.isArray(metrics)).toBe(true);
          |                                      ^
      539 |       // Should default to a reasonable time range
      540 |     });
      541 |

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:538:38)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle very large metric values

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      548 |
      549 |       const metrics = await getMetrics("large_value_test", "1h", "test");
    > 550 |       expect(metrics.length).toBeGreaterThan(0);
          |                              ^
      551 |       expect(metrics[0].value).toBe(largeValue);
      552 |     });
      553 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:550:30)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle concurrent metric recording

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: undefined

      563 |
      564 |       const metrics = await getMetrics("concurrent_test", "1h", "test");
    > 565 |       expect(metrics.length).toBe(10);
          |                              ^
      566 |
      567 |       // Verify all values were recorded correctly
      568 |       const values = metrics.map((m) => m.value).sort((a, b) => a - b);

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:565:30)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔍 Risk analyze requested - symbols: 2, portfolio: false

      at log (routes/risk.js:1608:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "POST /api/risk/analyze HTTP/1.1" 200 641 "-" "-"
  console.log
    📊 Market data endpoint called

      at log (routes/market.js:70:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/market/data?symbols=AAPL&timeframe=1D HTTP/1.1" 200 977 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "POST /api/technical/indicators HTTP/1.1" 404 130 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: buy

      at log (routes/orders.js:399:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "POST /api/orders HTTP/1.1" 400 85 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "POST /api/websocket/subscribe HTTP/1.1" 200 301 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🆕 New alert creation requested by user: dev-user-bypass for AAPL

      at log (routes/alerts.js:460:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "POST /api/alerts HTTP/1.1" 201 351 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/alerts/active HTTP/1.1" 200 1508 "-" "-"
  console.log
    📈 Live market data requested for symbols: AAPL

      at log (routes/market.js:5654:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/market/live?symbols=AAPL HTTP/1.1" 200 159 "-" "-"
  console.log
    📊 Historical market data requested for symbols: AAPL

      at log (routes/market.js:5698:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/market/historical?symbols=AAPL&start_date=2024-01-01&end_date=2024-12-31 HTTP/1.1" 200 12948 "-" "-"
  console.log
    📊 Market data endpoint called

      at log (routes/market.js:70:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:27 +0000] "GET /api/market/data?symbols=AAPL HTTP/1.1" 200 977 "-" "-"
  console.log
    📊 Market data endpoint called

      at log (routes/market.js:70:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/market/data?symbols=AAPL HTTP/1.1" 200 977 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    POST /rebalance called for user: dev-user-bypass

      at log (routes/portfolio.js:1979:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/portfolio/rebalance HTTP/1.1" 400 125 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/services/cross-service-integration.test.js
  Cross-Service Integration
    Portfolio → Market Data → Risk Analysis Integration
      ✓ should integrate portfolio analysis with market data and risk engine (22 ms)
      ✕ should integrate market data with technical analysis (22 ms)
    Authentication → Database → Service Integration
      ✓ should maintain user context across database operations (16 ms)
      ✕ should handle database transactions across multiple services (12 ms)
    Real-Time Data → WebSocket → Client Integration
      ✓ should coordinate real-time data with WebSocket notifications (2 ms)
      ✓ should integrate streaming data with alert system (10 ms)
    External Service Integration
      ✓ should integrate with Alpaca API service (6 ms)
      ✓ should handle external service timeouts (5 ms)
    Database → Cache → Service Integration
      ✓ should coordinate database queries with caching layer (34 ms)
    Error Recovery Integration
      ✕ should handle service failure cascades gracefully (4 ms)

  ● Cross-Service Integration › Portfolio → Market Data → Risk Analysis Integration › should integrate market data with technical analysis

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [200, 400, 401, 500, 501]

      73 |           });
      74 |
    > 75 |         expect([200, 400, 401, 500, 501]).toContain(technicalResponse.status);
         |                                           ^
      76 |
      77 |         if (technicalResponse.status === 200) {
      78 |           expect(technicalResponse.body).toHaveProperty("success", true);

      at Object.toContain (tests/integration/services/cross-service-integration.test.js:75:43)

  ● Cross-Service Integration › Authentication → Database → Service Integration › should handle database transactions across multiple services

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      112 |         .send(orderData);
      113 |
    > 114 |       expect(response.status).toBe(200);
          |                               ^
      115 |
      116 |       // If order is processed, it should involve:
      117 |       // 1. Order validation service

      at Object.toBe (tests/integration/services/cross-service-integration.test.js:114:31)

  ● Cross-Service Integration › Error Recovery Integration › should handle service failure cascades gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      244 |         });
      245 |
    > 246 |       expect(response.status).toBe(200);
          |                               ^
      247 |
      248 |       // Should handle complex operation failures without crashing
      249 |       expect(response.body).toHaveProperty("success");

      at Object.toBe (tests/integration/services/cross-service-integration.test.js:246:31)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?status=filled HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?side=buy HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?limit=10&offset=5 HTTP/1.1" 200 453 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 1606 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Order details request for user: dev-user-bypass, order: test-order-123

      at log (routes/orders.js:1964:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/test-order-123 HTTP/1.1" 404 173 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Order details request for user: dev-user-bypass, order: non-existent-order

      at log (routes/orders.js:1964:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/non-existent-order HTTP/1.1" 404 181 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/test-order-123 HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: buy

      at log (routes/orders.js:399:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 400 85 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: undefined

      at log (routes/orders.js:399:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 400 91 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: buy

      at log (routes/orders.js:399:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 400 101 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: buy

      at log (routes/orders.js:399:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 400 85 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Update order request for user: dev-user-bypass, order: test-order-123

      at log (routes/orders.js:1739:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "PUT /api/orders/test-order-123 HTTP/1.1" 400 163 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Update order request for user: dev-user-bypass, order: test-order-123

      at log (routes/orders.js:1739:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "PUT /api/orders/test-order-123 HTTP/1.1" 400 163 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "PUT /api/orders/test-order-123 HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Delete order request for user: dev-user-bypass, order: test-order-123

      at log (routes/orders.js:1874:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "DELETE /api/orders/test-order-123 HTTP/1.1" 400 163 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Delete order request for user: dev-user-bypass, order: non-existent-order

      at log (routes/orders.js:1874:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "DELETE /api/orders/non-existent-order HTTP/1.1" 400 167 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "DELETE /api/orders/test-order-123 HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Order history requested for user: dev-user-bypass

      at log (routes/orders.js:810:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history HTTP/1.1" 200 139 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Order history requested for user: dev-user-bypass

      at log (routes/orders.js:810:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history?from=2023-01-01&to=2023-12-31 HTTP/1.1" 200 139 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Order history requested for user: dev-user-bypass

      at log (routes/orders.js:810:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history?include_summary=true HTTP/1.1" 200 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Order history requested for user: dev-user-bypass

      at log (routes/orders.js:810:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📝 New order submission for user: dev-user-bypass, symbol: AAPL, side: buy

      at log (routes/orders.js:399:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "POST /api/orders HTTP/1.1" 400 85 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history HTTP/1.1" 200 139 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?limit=invalid HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?offset=-1 HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders?status=invalid_status HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Order details request for user: dev-user-bypass, order: '; DROP TABLE orders; --

      at log (routes/orders.js:1964:11)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/%27%3B%20DROP%20TABLE%20orders%3B%20-- HTTP/1.1" 404 193 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Order history requested for user: dev-user-bypass

      at log (routes/orders.js:810:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/history HTTP/1.1" 200 139 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Orders endpoint called for user: dev-user-bypass

      at log (routes/orders.js:71:11)

  console.log
    Executing orders query with timeout protection

      at log (routes/orders.js:144:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 453 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders HTTP/1.1" 200 1606 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Recent orders requested - limit: 20, days: 7, status: all

      at log (routes/orders.js:1049:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/recent HTTP/1.1" 200 7816 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Recent orders requested - limit: 10, days: 30, status: filled

      at log (routes/orders.js:1049:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:28 +0000] "GET /api/orders/recent?limit=10&days=30&status=filled HTTP/1.1" 200 155 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/orders.integration.test.js
  Orders Routes Integration Tests
    GET /api/orders (List Orders)
      ✓ should return user orders (13 ms)
      ✓ should handle status filter (6 ms)
      ✓ should handle side filter (6 ms)
      ✓ should handle pagination parameters (9 ms)
      ✓ should require authentication (3 ms)
    GET /api/orders/:orderId (Get Specific Order)
      ✕ should handle order lookup (5 ms)
      ✓ should return 404 for non-existent order (5 ms)
      ✓ should require authentication (1 ms)
    POST /api/orders (Create Order)
      ✓ should create new order with valid data (6 ms)
      ✓ should validate required fields (3 ms)
      ✓ should validate quantity is positive (4 ms)
      ✓ should validate order types (3 ms)
      ✓ should require authentication (1 ms)
    PUT /api/orders/:orderId (Update Order)
      ✓ should update order (4 ms)
      ✓ should validate numeric fields (3 ms)
      ✓ should require authentication (1 ms)
    DELETE /api/orders/:orderId (Cancel Order)
      ✕ should cancel order (7 ms)
      ✕ should return 404 for non-existent order (5 ms)
      ✓ should require authentication (1 ms)
    GET /api/orders/history (Order History)
      ✓ should return order history (5 ms)
      ✓ should handle date filtering (6 ms)
      ✓ should include performance summary (8 ms)
      ✓ should require authentication (2 ms)
    Performance and Edge Cases
      ✓ should handle concurrent requests (22 ms)
      ✓ should handle invalid parameters gracefully (20 ms)
      ✓ should maintain response time consistency (8 ms)
      ✕ should handle SQL injection attempts safely (5 ms)
      ✓ should validate response content types (13 ms)
      ✓ should handle database connection issues gracefully (6 ms)
    Authentication and Trading Mode
      ✓ should respect trading mode restrictions (7 ms)
      ✓ should handle malformed authorization headers (2 ms)
      ✓ should handle empty authorization headers (2 ms)
    GET /api/orders/recent (Recent Orders)
      ✓ should return recent orders with sample data (11 ms)
      ✓ should handle query parameters for recent orders (7 ms)

  ● Orders Routes Integration Tests › GET /api/orders/:orderId (Get Specific Order) › should handle order lookup

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      81 |         .set("Authorization", "Bearer dev-bypass-token");
      82 |
    > 83 |       expect([200, 401].includes(response.status)).toBe(true);
         |                                                    ^
      84 |
      85 |       if (response.status === 200) {
      86 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/orders.integration.test.js:83:52)

  ● Orders Routes Integration Tests › DELETE /api/orders/:orderId (Cancel Order) › should cancel order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      234 |         .set("Authorization", "Bearer dev-bypass-token");
      235 |
    > 236 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      237 |
      238 |       if (response.status === 200) {
      239 |         // Order deletion successful - no additional validation needed for this test

      at Object.toBe (tests/integration/routes/orders.integration.test.js:236:52)

  ● Orders Routes Integration Tests › DELETE /api/orders/:orderId (Cancel Order) › should return 404 for non-existent order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      246 |         .set("Authorization", "Bearer dev-bypass-token");
      247 |
    > 248 |       expect([404, 401, 403, 500].includes(response.status)).toBe(true);
          |                                                              ^
      249 |     });
      250 |
      251 |     test("should require authentication", async () => {

      at Object.toBe (tests/integration/routes/orders.integration.test.js:248:62)

  ● Orders Routes Integration Tests › Performance and Edge Cases › should handle SQL injection attempts safely

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      375 |           .set("Authorization", "Bearer dev-bypass-token");
      376 |
    > 377 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      378 |       }
      379 |     });
      380 |

      at Object.toBe (tests/integration/routes/orders.integration.test.js:377:59)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 200 472 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Trading mode requested for user: dev-user-bypass

      at log (routes/settings.js:259:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/trading-mode HTTP/1.1" 200 232 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/trading-mode HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔄 Trading mode toggle requested for user: dev-user-bypass

      at log (routes/settings.js:310:13)

  console.log
    ✅ Trading mode updated to paper for user: dev-user-bypass

      at log (routes/settings.js:353:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/trading-mode HTTP/1.1" 200 323 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔄 Trading mode toggle requested for user: dev-user-bypass

      at log (routes/settings.js:310:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/trading-mode HTTP/1.1" 400 130 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/trading-mode HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'column "last_used" does not exist',
      query: '\n' +
        '        SELECT broker_name as provider, updated_at, created_at, last_used\n' +
        '        FROM user_api_key...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at ApiKeyService.listProviders (utils/apiKeyService.js:1187:24)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

  console.error
    Provider listing error: error: column "last_used" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at ApiKeyService.listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1187:24)
        at listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1395:14)
        at /home/stocks/algo/webapp/lambda/routes/settings.js:398:23 {
      length: 109,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '66',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1220 |     } catch (error) {
      1221 |       this.recordFailure(error);
    > 1222 |       console.error("Provider listing error:", error);
           |               ^
      1223 |       throw error; // Re-throw error so wrapper can handle it
      1224 |     }
      1225 |   }

      at ApiKeyService.error [as listProviders] (utils/apiKeyService.js:1222:15)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys HTTP/1.1" 200 205 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'column "last_used" does not exist',
      query: '\n' +
        '        SELECT broker_name as provider, updated_at, created_at, last_used\n' +
        '        FROM user_api_key...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at ApiKeyService.listProviders (utils/apiKeyService.js:1187:24)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

  console.error
    Provider listing error: error: column "last_used" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at ApiKeyService.listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1187:24)
        at listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1395:14)
        at /home/stocks/algo/webapp/lambda/routes/settings.js:398:23 {
      length: 109,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '66',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1220 |     } catch (error) {
      1221 |       this.recordFailure(error);
    > 1222 |       console.error("Provider listing error:", error);
           |               ^
      1223 |       throw error; // Re-throw error so wrapper can handle it
      1224 |     }
      1225 |   }

      at ApiKeyService.error [as listProviders] (utils/apiKeyService.js:1222:15)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys HTTP/1.1" 200 205 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/api-keys HTTP/1.1" 400 100 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/api-keys HTTP/1.1" 400 100 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/api-keys HTTP/1.1" 400 100 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/api-keys HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/alpaca HTTP/1.1" 404 65 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/alpaca HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "PUT /api/settings/api-keys/alpaca HTTP/1.1" 404 79 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "PUT /api/settings/api-keys/alpaca HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "DELETE /api/settings/api-keys/alpaca HTTP/1.1" 404 65 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "DELETE /api/settings/api-keys/alpaca HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 200 472 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Trading mode requested for user: dev-user-bypass

      at log (routes/settings.js:259:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/trading-mode HTTP/1.1" 200 232 "-" "-"
  console.error
    Database query error: {
      error: 'column "last_used" does not exist',
      query: '\n' +
        '        SELECT broker_name as provider, updated_at, created_at, last_used\n' +
        '        FROM user_api_key...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at ApiKeyService.listProviders (utils/apiKeyService.js:1187:24)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

  console.error
    Provider listing error: error: column "last_used" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at ApiKeyService.listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1187:24)
        at listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1395:14)
        at /home/stocks/algo/webapp/lambda/routes/settings.js:398:23 {
      length: 109,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '66',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1220 |     } catch (error) {
      1221 |       this.recordFailure(error);
    > 1222 |       console.error("Provider listing error:", error);
           |               ^
      1223 |       throw error; // Re-throw error so wrapper can handle it
      1224 |     }
      1225 |   }

      at ApiKeyService.error [as listProviders] (utils/apiKeyService.js:1222:15)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys HTTP/1.1" 200 205 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔄 Trading mode toggle requested for user: dev-user-bypass

      at log (routes/settings.js:310:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/trading-mode HTTP/1.1" 400 130 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/invalid-provider-name HTTP/1.1" 404 80 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "POST /api/settings/api-keys HTTP/1.1" 400 100 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/%27%3B%20DROP%20TABLE%20user_api_keys%3B%20-- HTTP/1.1" 404 90 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/1%27%20OR%20%271%27%3D%271 HTTP/1.1" 404 71 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/UNION%20SELECT%20*%20FROM%20users HTTP/1.1" 404 84 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys/%3Cscript%3Ealert(%27xss%27)%3C%2Fscript%3E HTTP/1.1" 404 88 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 200 472 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Trading mode requested for user: dev-user-bypass

      at log (routes/settings.js:259:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/trading-mode HTTP/1.1" 200 232 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'column "last_used" does not exist',
      query: '\n' +
        '        SELECT broker_name as provider, updated_at, created_at, last_used\n' +
        '        FROM user_api_key...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at ApiKeyService.listProviders (utils/apiKeyService.js:1187:24)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

  console.error
    Provider listing error: error: column "last_used" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at ApiKeyService.listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1187:24)
        at listProviders (/home/stocks/algo/webapp/lambda/utils/apiKeyService.js:1395:14)
        at /home/stocks/algo/webapp/lambda/routes/settings.js:398:23 {
      length: 109,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '66',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1220 |     } catch (error) {
      1221 |       this.recordFailure(error);
    > 1222 |       console.error("Provider listing error:", error);
           |               ^
      1223 |       throw error; // Re-throw error so wrapper can handle it
      1224 |     }
      1225 |   }

      at ApiKeyService.error [as listProviders] (utils/apiKeyService.js:1222:15)
      at listProviders (utils/apiKeyService.js:1395:14)
      at routes/settings.js:398:23

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/api-keys HTTP/1.1" 200 205 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚙️ Dashboard settings requested for user: dev-user-bypass

      at log (routes/settings.js:44:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/dashboard HTTP/1.1" 200 2899 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings HTTP/1.1" 401 528 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/apikeys HTTP/1.1" 302 44 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/settings/apikeys?broker=test&active=true HTTP/1.1" 302 68 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/settings.integration.test.js
  Settings Routes Integration Tests
    GET /api/settings (Root Endpoint)
      ✓ should return settings API information (9 ms)
      ✓ should require authentication (2 ms)
    GET /api/settings/dashboard (Dashboard Settings)
      ✓ should return dashboard settings (11 ms)
      ✓ should handle database connection issues (7 ms)
      ✓ should require authentication (2 ms)
    GET /api/settings/trading-mode (Trading Mode)
      ✓ should return current trading mode (5 ms)
      ✓ should require authentication (1 ms)
    POST /api/settings/trading-mode (Toggle Trading Mode)
      ✓ should toggle trading mode (16 ms)
      ✓ should validate trading mode values (3 ms)
      ✓ should require authentication (2 ms)
    GET /api/settings/api-keys (API Keys)
      ✕ should return user API keys (32 ms)
      ✓ should mask sensitive API key data (10 ms)
      ✓ should require authentication (2 ms)
    POST /api/settings/api-keys (Create API Key)
      ✓ should create new API key (3 ms)
      ✓ should validate required fields (4 ms)
      ✓ should validate provider types (2 ms)
      ✓ should require authentication (1 ms)
    GET /api/settings/api-keys/:provider (Get Specific API Key)
      ✕ should return specific provider API key status (10 ms)
      ✓ should require authentication (2 ms)
    PUT /api/settings/api-keys/:provider (Update API Key)
      ✓ should update API key (2 ms)
      ✓ should require authentication (2 ms)
    DELETE /api/settings/api-keys/:provider (Delete API Key)
      ✕ should delete API key (5 ms)
      ✓ should require authentication (2 ms)
    Performance and Edge Cases
      ✓ should handle concurrent requests to settings endpoints (27 ms)
      ✓ should maintain response time consistency (5 ms)
      ✓ should handle invalid parameters gracefully (9 ms)
      ✓ should handle SQL injection attempts safely (15 ms)
      ✓ should validate response content types (17 ms)
      ✓ should handle database connection issues gracefully (6 ms)
    Authentication Edge Cases
      ✓ should handle malformed authorization headers (1 ms)
      ✓ should handle empty authorization headers (1 ms)
      ✓ should handle missing bearer token (1 ms)
    GET /api/settings/apikeys (Redirect Endpoint)
      ✓ should redirect to /api/settings/api-keys (5 ms)
      ✓ should handle query parameters in redirect (3 ms)

  ● Settings Routes Integration Tests › GET /api/settings/api-keys (API Keys) › should return user API keys

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      145 |       if (response.status === 200) {
      146 |         expect(response.body).toHaveProperty("providers");
    > 147 |         expect(Array.isArray(response.body.providers)).toBe(true);
          |                                                        ^
      148 |       }
      149 |     });
      150 |

      at Object.toBe (tests/integration/routes/settings.integration.test.js:147:56)

  ● Settings Routes Integration Tests › GET /api/settings/api-keys/:provider (Get Specific API Key) › should return specific provider API key status

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      232 |         .set("Authorization", "Bearer dev-bypass-token");
      233 |
    > 234 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      235 |
      236 |       if (response.status === 200) {
      237 |         expect(response.body).toHaveProperty("provider", "alpaca");

      at Object.toBe (tests/integration/routes/settings.integration.test.js:234:52)

  ● Settings Routes Integration Tests › DELETE /api/settings/api-keys/:provider (Delete API Key) › should delete API key

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      281 |         .set("Authorization", "Bearer dev-bypass-token");
      282 |
    > 283 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      284 |
      285 |       if (response.status === 200) {
      286 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/settings.integration.test.js:283:52)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance HTTP/1.1" 200 207 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/health HTTP/1.1" 200 150 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/benchmark HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1y

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/benchmark HTTP/1.1" 200 414 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1y

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/benchmark?benchmark=SPY HTTP/1.1" 200 414 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1d

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/benchmark?period=1d HTTP/1.1" 200 412 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1m

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/benchmark?benchmark=SPY&period=1m HTTP/1.1" 200 413 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/portfolio HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/portfolio?period=1d HTTP/1.1" 404 281 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/returns HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/returns HTTP/1.1" 404 247 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/returns?type=time_weighted HTTP/1.1" 404 247 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:29 +0000] "GET /api/performance/attribution HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Performance attribution endpoint accessed - user: dev-user-bypass, period: 1y, level: sector, method: brinson

      at log (routes/performance.js:1007:13)

  console.error
    Database query error: {
      error: 'column th.side does not exist',
      query: '\n' +
        '      WITH portfolio_holdings AS (\n' +
        '        SELECT \n' +
        '          th.symbol,\n' +
        '          th.side,\n' +
        '        ...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/performance.js:1123:16

  console.error
    Attribution analysis query failed: column th.side does not exist

      1123 |       result = await query(attributionQuery, [userId]);
      1124 |     } catch (dbError) {
    > 1125 |       console.error("Attribution analysis query failed:", dbError.message);
           |               ^
      1126 |       return res.status(500).json({
      1127 |         success: false,
      1128 |         error: "Attribution analysis query failed",

      at error (routes/performance.js:1125:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/attribution HTTP/1.1" 500 142 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Performance attribution endpoint accessed - user: dev-user-bypass, period: 1y, level: sector, method: brinson

      at log (routes/performance.js:1007:13)

  console.error
    Database query error: {
      error: 'column th.side does not exist',
      query: '\n' +
        '      WITH portfolio_holdings AS (\n' +
        '        SELECT \n' +
        '          th.symbol,\n' +
        '          th.side,\n' +
        '        ...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/performance.js:1123:16

  console.error
    Attribution analysis query failed: column th.side does not exist

      1123 |       result = await query(attributionQuery, [userId]);
      1124 |     } catch (dbError) {
    > 1125 |       console.error("Attribution analysis query failed:", dbError.message);
           |               ^
      1126 |       return res.status(500).json({
      1127 |         success: false,
      1128 |         error: "Attribution analysis query failed",

      at error (routes/performance.js:1125:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/attribution?type=sector HTTP/1.1" 500 142 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics?period=1m HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics?period=3m HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics?period=6m HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics?period=1y HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics?period=2y HTTP/1.1" 200 362 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/risk HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/risk HTTP/1.1" 404 162 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance HTTP/1.1" 200 207 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1y

      at log (routes/performance.js:87:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 362 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/benchmark HTTP/1.1" 200 414 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/returns HTTP/1.1" 404 247 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio?period=invalid HTTP/1.1" 404 286 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1y

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/benchmark HTTP/1.1" 200 414 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/returns HTTP/1.1" 404 247 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 361 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance HTTP/1.1" 200 207 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/health HTTP/1.1" 200 150 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📈 Performance benchmark requested for user: dev-user-bypass, benchmark: SPY, period: 1y

      at log (routes/performance.js:87:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/benchmark HTTP/1.1" 200 414 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio HTTP/1.1" 404 281 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/returns HTTP/1.1" 404 247 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/metrics HTTP/1.1" 200 362 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/performance/portfolio?period=10y HTTP/1.1" 404 282 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/performance.integration.test.js
  Performance Routes Integration Tests
    GET /api/performance (Root Endpoint)
      ✓ should return performance API information (3 ms)
    GET /api/performance/health (Health Check)
      ✓ should return performance service health status (2 ms)
    GET /api/performance/benchmark (Benchmark Comparison)
      ✓ should require authentication for benchmark comparison (1 ms)
      ✓ should return benchmark comparison with authentication (18 ms)
      ✕ should handle different benchmark symbols (6 ms)
      ✕ should handle different time periods (6 ms)
      ✓ should validate benchmark comparison metrics (8 ms)
    GET /api/performance/portfolio (Portfolio Performance)
      ✓ should require authentication for portfolio performance (1 ms)
      ✕ should return portfolio performance data with authentication (4 ms)
      ✕ should handle period parameter for portfolio performance (3 ms)
      ✓ should validate portfolio performance metrics (4 ms)
    GET /api/performance/returns (Return Calculations)
      ✓ should require authentication for return calculations (1 ms)
      ✕ should return return calculations with authentication (5 ms)
      ✕ should handle calculation type parameter (6 ms)
    GET /api/performance/attribution (Performance Attribution)
      ✓ should require authentication for performance attribution (1 ms)
      ✕ should return performance attribution analysis (9 ms)
      ✕ should handle attribution type parameter (13 ms)
    GET /api/performance/metrics (Performance Metrics)
      ✓ should require authentication for performance metrics (1 ms)
      ✓ should return comprehensive performance metrics (4 ms)
      ✓ should validate metric value ranges (3 ms)
      ✓ should handle period parameter for metrics (15 ms)
    GET /api/performance/risk (Risk Metrics)
      ✓ should require authentication for risk metrics (1 ms)
      ✕ should return risk analysis metrics (9 ms)
    Performance and Edge Cases
      ✕ should handle concurrent requests to performance endpoints (21 ms)
      ✓ should maintain response time consistency (3 ms)
      ✕ should handle invalid parameters gracefully (3 ms)
      ✓ should handle malformed authentication tokens (8 ms)
      ✓ should validate numeric data integrity across endpoints (16 ms)
      ✕ should handle database connection issues gracefully (5 ms)
      ✓ should validate response content types (17 ms)
      ✕ should handle memory pressure with large data requests (4 ms)

  ● Performance Routes Integration Tests › GET /api/performance/benchmark (Benchmark Comparison) › should handle different benchmark symbols

    expect(received).toHaveProperty(path, value)

    Expected path: "symbol"
    Received path: []

    Expected value: "SPY"
    Received value: {}

      103 |
      104 |         if (response.status === 200 && response.body.data.benchmark) {
    > 105 |           expect(response.body.data.benchmark).toHaveProperty(
          |                                                ^
      106 |             "symbol",
      107 |             benchmark
      108 |           );

      at Object.toHaveProperty (tests/integration/routes/performance.integration.test.js:105:48)

  ● Performance Routes Integration Tests › GET /api/performance/benchmark (Benchmark Comparison) › should handle different time periods

    expect(received).toHaveProperty(path, value)

    Expected path: "period"
    Received path: []

    Expected value: "1d"
    Received value: {"alpha": null, "beta": 0, "correlation": 0, "excess_return": null, "information_ratio": null, "outperformance": null, "tracking_error": null}

      122 |
      123 |         if (response.status === 200 && response.body.data.comparison) {
    > 124 |           expect(response.body.data.comparison).toHaveProperty(
          |                                                 ^
      125 |             "period",
      126 |             period
      127 |           );

      at Object.toHaveProperty (tests/integration/routes/performance.integration.test.js:124:49)

  ● Performance Routes Integration Tests › GET /api/performance/portfolio (Portfolio Performance) › should return portfolio performance data with authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      176 |         .set("Authorization", `Bearer ${authToken}`);
      177 |
    > 178 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      179 |
      180 |       if (response.status === 200) {
      181 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:178:52)

  ● Performance Routes Integration Tests › GET /api/performance/portfolio (Portfolio Performance) › should handle period parameter for portfolio performance

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      205 |           .set("Authorization", `Bearer ${authToken}`);
      206 |
    > 207 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      208 |       }
      209 |     });
      210 |

      at Object.toBe (tests/integration/routes/performance.integration.test.js:207:59)

  ● Performance Routes Integration Tests › GET /api/performance/returns (Return Calculations) › should return return calculations with authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      265 |         .set("Authorization", `Bearer ${authToken}`);
      266 |
    > 267 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      268 |
      269 |       if (response.status === 200) {
      270 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:267:52)

  ● Performance Routes Integration Tests › GET /api/performance/returns (Return Calculations) › should handle calculation type parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      301 |           .set("Authorization", `Bearer ${authToken}`);
      302 |
    > 303 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      304 |       }
      305 |     });
      306 |   });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:303:59)

  ● Performance Routes Integration Tests › GET /api/performance/attribution (Performance Attribution) › should return performance attribution analysis

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      318 |         .set("Authorization", `Bearer ${authToken}`);
      319 |
    > 320 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      321 |
      322 |       if (response.status === 200) {
      323 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:320:52)

  ● Performance Routes Integration Tests › GET /api/performance/attribution (Performance Attribution) › should handle attribution type parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      354 |           .set("Authorization", `Bearer ${authToken}`);
      355 |
    > 356 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      357 |       }
      358 |     });
      359 |   });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:356:59)

  ● Performance Routes Integration Tests › GET /api/performance/risk (Risk Metrics) › should return risk analysis metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      452 |         .set("Authorization", `Bearer ${authToken}`);
      453 |
    > 454 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      455 |
      456 |       if (response.status === 200) {
      457 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/performance.integration.test.js:454:52)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle concurrent requests to performance endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      507 |
      508 |       responses.forEach((response) => {
    > 509 |         expect([200, 401].includes(response.status)).toBe(true);
          |                                                      ^
      510 |       });
      511 |     });
      512 |

      at toBe (tests/integration/routes/performance.integration.test.js:509:54)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/performance.integration.test.js:508:17)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle invalid parameters gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      536 |           .set("Authorization", `Bearer ${authToken}`);
      537 |
    > 538 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      539 |       }
      540 |     });
      541 |

      at Object.toBe (tests/integration/routes/performance.integration.test.js:538:59)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle database connection issues gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      597 |         .set("Authorization", `Bearer ${authToken}`);
      598 |
    > 599 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      600 |
      601 |       if (response.status >= 500) {
      602 |         expect(response.body).toHaveProperty("error");

      at Object.toBe (tests/integration/routes/performance.integration.test.js:599:52)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle memory pressure with large data requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      635 |       expect(
      636 |         [200, 400, 401, 403, 413, 500, 503].includes(response.status)
    > 637 |       ).toBe(true);
          |         ^
      638 |     });
      639 |   });
      640 | });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:637:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/nonexistent HTTP/1.1" 404 121 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/portfolio/invalid-endpoint HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/calendar/nonexistent-calendar-type HTTP/1.1" 404 144 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    📊 Retrieving backtest results for ID: nonexistent-id

      at log (routes/backtest.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/backtest/results/nonexistent-id HTTP/1.1" 404 162 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token 'j', "{"malformed": json}" is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"malformed": json}',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/nonexistent-endpoint HTTP/1.1" 404 130 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "POST /api/portfolio/invalid-action HTTP/1.1" 404 134 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/nonexistent-endpoint HTTP/1.1" 404 130 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "POST /api/portfolio/positions HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: '; DROP TABLE users; --, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/calendar/earnings?symbol=%27;%20DROP%20TABLE%20users;%20-- HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/nonexistent-endpoint HTTP/1.1" 404 130 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 6ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    📊 Backtest results requested - ID: all, limit: 50

      at log (routes/backtest.js:855:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/backtest/results HTTP/1.1" 200 934 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/invalid HTTP/1.1" 404 117 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "GET /api/portfolio/invalid HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "POST /api/health HTTP/1.1" 404 116 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "PUT /api/calendar/earnings HTTP/1.1" 404 127 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:30 +0000] "DELETE /api/market/overview HTTP/1.1" 404 125 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/middleware/errorHandler-middleware.integration.test.js
  Error Handler Middleware Integration
    Error Response Formatting
      ✓ should format 404 errors consistently (11 ms)
      ✓ should format 500 errors consistently (17 ms)
      ✓ should handle malformed request errors (5 ms)
    Error Context Preservation
      ✓ should maintain request context in error responses (1 ms)
      ✓ should handle errors with user authentication context (3 ms)
      ✓ should handle errors without authentication context (2 ms)
    Error Security and Information Disclosure
      ✕ should not expose sensitive information in error responses (5 ms)
      ✓ should sanitize error messages (5 ms)
    Error Response Headers
      ✓ should set appropriate response headers for errors (2 ms)
      ✕ should handle CORS headers in error responses (1 ms)
    Async Error Handling
      ✓ should handle async route errors properly (23 ms)
      ✓ should handle database connection errors gracefully (14 ms)
    Error Handling Consistency Across Routes
      ✕ should maintain consistent error format across all routes (2 ms)
      ✓ should handle method not allowed errors consistently (3 ms)

  ● Error Handler Middleware Integration › Error Security and Information Disclosure › should not expose sensitive information in error responses

    expect(received).not.toMatch(expected)

    Expected pattern: not /password|secret|key|token|database|connection|stack|trace|internal/
    Received string:      "invalid token"

      142 |           // Should not expose sensitive internal information
      143 |           const errorMessage = response.body.error.toLowerCase();
    > 144 |           expect(errorMessage).not.toMatch(
          |                                    ^
      145 |             /password|secret|key|token|database|connection|stack|trace|internal/
      146 |           );
      147 |           expect(errorMessage).not.toMatch(

      at Object.toMatch (tests/integration/middleware/errorHandler-middleware.integration.test.js:144:36)

  ● Error Handler Middleware Integration › Error Response Headers › should handle CORS headers in error responses

    expect(received).toContain(expected) // indexOf

    Expected value: 204
    Received array: [200, 404, 500, 501]

      214 |
      215 |       // CORS preflight for non-existent endpoint
    > 216 |       expect([200, 404, 500, 501]).toContain(response.status);
          |                                    ^
      217 |
      218 |       // Should still handle CORS appropriately even for errors
      219 |       if (response.headers["access-control-allow-origin"]) {

      at Object.toContain (tests/integration/middleware/errorHandler-middleware.integration.test.js:216:36)

  ● Error Handler Middleware Integration › Error Handling Consistency Across Routes › should maintain consistent error format across all routes

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      295 |         const response = await request(app).get(scenario.endpoint);
      296 |
    > 297 |         expect(response.status).toBe(scenario.expectedStatus);
          |                                 ^
      298 |         expect(response.body).toHaveProperty("success", false);
      299 |         expect(response.body).toHaveProperty("error");
      300 |         expect(response.headers["content-type"]).toMatch(/application\/json/);

      at Object.toBe (tests/integration/middleware/errorHandler-middleware.integration.test.js:297:33)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket HTTP/1.1" 200 411 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/portfolio HTTP/1.1" 404 129 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/portfolio HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/portfolio HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/portfolio HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/market HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/invalid HTTP/1.1" 404 127 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token 'n', "not json" is not valid JSON
        at JSON.parse (<anonymous>)
        at createStrictSyntaxError (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:169:10)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:86:15)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: 'not json',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token '}', "{"incomplete": }" is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"incomplete": }',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 400 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/websocket/info HTTP/1.1" 404 124 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/subscribe/portfolio HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/session HTTP/1.1" 404 127 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/session/validate HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/session/refresh HTTP/1.1" 404 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/websocket/validate-message HTTP/1.1" 404 136 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/websocket/websocket.integration.test.js
  WebSocket Integration
    WebSocket Connection Establishment
      ✕ should handle WebSocket upgrade requests (3 ms)
      ✓ should handle WebSocket connection info requests (2 ms)
      ✕ should validate WebSocket authentication requirements (2 ms)
    WebSocket Message Handling
      ✓ should handle WebSocket message format validation (7 ms)
      ✕ should handle invalid WebSocket message formats (6 ms)
    WebSocket Subscription Management
      ✓ should handle market data subscriptions (2 ms)
      ✓ should handle portfolio subscriptions (3 ms)
      ✓ should handle subscription limits (13 ms)
    WebSocket Error Scenarios
      ✕ should handle connection errors gracefully (1 ms)
      ✕ should handle malformed WebSocket messages (7 ms)
      ✓ should handle WebSocket security issues (4 ms)
    WebSocket Performance and Scalability
      ✕ should handle concurrent WebSocket requests (9 ms)
      ✓ should handle high-frequency message validation (17 ms)
      ✓ should maintain performance under load (9 ms)
    WebSocket Integration with Authentication
      ✕ should handle WebSocket authentication flow (3 ms)
      ✓ should handle WebSocket session management (3 ms)
    WebSocket Data Consistency
      ✓ should maintain consistent WebSocket message ordering (5 ms)

  ● WebSocket Integration › WebSocket Connection Establishment › should handle WebSocket upgrade requests

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [404, 500]

      35 |
      36 |       // WebSocket upgrade might return specific status codes
    > 37 |       expect([404, 500]).toContain(response.status);
         |                          ^
      38 |
      39 |       if (response.status === 101) {
      40 |         // Successful WebSocket upgrade

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:37:26)

  ● WebSocket Integration › WebSocket Connection Establishment › should validate WebSocket authentication requirements

    expect(received).toBe(expected) // Object.is equality

    Expected: 401
    Received: 404

      79 |           .set("Connection", "Upgrade");
      80 |
    > 81 |         expect(unauthResponse.status).toBe(401);
         |                                       ^
      82 |
      83 |         // Test with auth header
      84 |         const authResponse = await request(app)

      at Object.toBe (tests/integration/websocket/websocket.integration.test.js:81:39)

  ● WebSocket Integration › WebSocket Message Handling › should handle invalid WebSocket message formats

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      136 |           .send(message);
      137 |
    > 138 |         expect([400, 422]).toContain(response.status);
          |                            ^
      139 |
      140 |         if (response.status === 400 || response.status === 422) {
      141 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:138:28)

  ● WebSocket Integration › WebSocket Error Scenarios › should handle connection errors gracefully

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      258 |         const response = await requestBuilder;
      259 |
    > 260 |         expect([400, 422]).toContain(response.status);
          |                            ^
      261 |
      262 |         if ([400, 404].includes(response.status)) {
      263 |           // Error responses should be properly formatted

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:260:28)

  ● WebSocket Integration › WebSocket Error Scenarios › should handle malformed WebSocket messages

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      286 |           .send(message);
      287 |
    > 288 |         expect([400, 422]).toContain(response.status);
          |                            ^
      289 |
      290 |         if (response.status >= 400 && response.body) {
      291 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:288:28)

  ● WebSocket Integration › WebSocket Performance and Scalability › should handle concurrent WebSocket requests

    expect(received).toBeGreaterThan(expected)

    Expected: > 7
    Received:   0

      370 |       // Most connections should succeed
      371 |       const successfulConnections = results.filter((r) => r.success);
    > 372 |       expect(successfulConnections.length).toBeGreaterThan(
          |                                            ^
      373 |         concurrentConnections * 0.7
      374 |       );
      375 |

      at Object.toBeGreaterThan (tests/integration/websocket/websocket.integration.test.js:372:44)

  ● WebSocket Integration › WebSocket Integration with Authentication › should handle WebSocket authentication flow

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      512 |       results.forEach((result) => {
      513 |         if (result.status) {
    > 514 |           expect(result.status).toBe(200);
          |                                 ^
      515 |           expect(result.authenticated).toBe(true);
      516 |         }
      517 |       });

      at toBe (tests/integration/websocket/websocket.integration.test.js:514:33)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/websocket/websocket.integration.test.js:512:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    📊 Backtest results requested - ID: all, limit: 50

      at log (routes/backtest.js:855:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/backtest/results HTTP/1.1" 200 934 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 382 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "POST /api/portfolio/analyze HTTP/1.1" 413 124 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.error
    Database query error: {
      error: 'column "date" does not exist',
      query: '\n' +
        '      SELECT \n' +
        '        symbol,\n' +
        '        symbol as company_name,\n' +
        '        date as report_date,\n' +
        '        ...',
      params: '2 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
          at async Promise.all (index 0)
      at routes/calendar.js:750:57

  console.error
    Error fetching earnings metrics: error: column "date" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at async Promise.all (index 0)
        at /home/stocks/algo/webapp/lambda/routes/calendar.js:750:57 {
      length: 104,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '72',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      794 |     });
      795 |   } catch (error) {
    > 796 |     console.error("Error fetching earnings metrics:", error);
          |             ^
      797 |     res.status(500).json({
      798 |       success: false,
      799 |       error: "Failed to fetch earnings metrics",

      at error (routes/calendar.js:796:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings-metrics HTTP/1.1" 500 176 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/market/analysis HTTP/1.1" 404 125 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 6ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:31 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio analysis requested for user: dev-user-bypass, period: 1y

      at log (routes/portfolio.js:566:13)

  console.error
    Database query error: {
      error: 'column ph.cost_basis does not exist',
      query: '\n' +
        '      SELECT \n' +
        '        ph.symbol,\n' +
        '        ph.quantity,\n' +
        '        ph.market_value,\n' +
        '        ph.cost_basi...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/portfolio.js:585:28

  console.error
    Portfolio analysis error: error: column ph.cost_basis does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/portfolio.js:585:28 {
      length: 111,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '89',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      740 |     });
      741 |   } catch (error) {
    > 742 |     console.error("Portfolio analysis error:", error);
          |             ^
      743 |     return res.status(500).json({
      744 |       success: false,
      745 |       error: "Failed to generate portfolio analysis",

      at error (routes/portfolio.js:742:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/portfolio/analysis HTTP/1.1" 500 113 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/detailed-analysis HTTP/1.1" 404 134 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 120ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 130ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 117ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 117ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 129ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 117ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 109ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 106ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 113ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 125ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 107ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 111ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 98ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 133ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 106ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 136ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 103ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 110ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 107ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 101ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 99ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 92ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 110ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 88ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 103ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 97ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 85ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 100ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 89ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 109ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 86ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 94ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 91ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 86ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 69ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 84ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 82ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 80ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 66ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 84ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 75ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 90ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 71ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 81ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 67ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 66ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 75ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 65ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 72ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 162ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:32 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 355 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    Portfolio performance endpoint called for user: dev-user-bypass, timeframe: 1y

      at log (routes/portfolio.js:1109:13)

  console.error
    Database query error: {
      error: 'column "benchmark_return" does not exist',
      query: '\n' +
        '      SELECT \n' +
        '        date, total_value, daily_pnl, daily_pnl_percent,\n' +
        '        total_pnl, total_pnl...',
      params: '1 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at routes/portfolio.js:1133:31

  console.error
    Portfolio performance error: error: column "benchmark_return" does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1351:20)
        at /home/stocks/algo/webapp/lambda/routes/portfolio.js:1133:31 {
      length: 117,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '119',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      1217 |     res.json(responseWithTradingMode);
      1218 |   } catch (error) {
    > 1219 |     console.error("Portfolio performance error:", error);
           |             ^
      1220 |     return res.status(500).json({
      1221 |       success: false,
      1222 |       error: "Failed to fetch portfolio performance",

      at error (routes/portfolio.js:1219:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/performance HTTP/1.1" 500 209 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/complex-analysis HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/complex-metrics HTTP/1.1" 404 134 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/heavy-computation HTTP/1.1" 404 134 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    📊 Backtest results requested - ID: all, limit: 50

      at log (routes/backtest.js:855:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/backtest/results HTTP/1.1" 200 934 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/errors/5xx-server-errors.integration.test.js
  5xx Server Error Scenarios Integration
    500 Internal Server Error Scenarios
      ✓ should handle database connection failures gracefully (20 ms)
      ✓ should handle application errors with proper formatting (3 ms)
      ✓ should handle memory or resource exhaustion (3 ms)
      ✓ should maintain response format during server errors (41 ms)
    502 Bad Gateway Scenarios
      ✓ should handle upstream service failures (13 ms)
    503 Service Unavailable Scenarios
      ✓ should handle service maintenance mode (6 ms)
      ✓ should handle database pool exhaustion (85 ms)
    504 Gateway Timeout Scenarios
      ✓ should handle slow upstream responses (44 ms)
    Server Error Recovery and Resilience
      ✓ should recover gracefully from temporary failures (1188 ms)
      ✓ should maintain error logging during server errors (3 ms)
      ✓ should handle cascading failures appropriately (27 ms)
    Server Error Security
      ✓ should not expose sensitive information in server errors (11 ms)
      ✓ should sanitize error messages from external sources (6 ms)
    Cross-Route 5xx Error Consistency
      ✓ should maintain consistent 5xx error format across all routes (6 ms)
      ✓ should provide consistent error codes across similar failures (14 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 6ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings-estimates HTTP/1.1" 200 1442 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings-history HTTP/1.1" 200 2045 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/nonexistent HTTP/1.1" 404 121 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/nonexistent HTTP/1.1" 404 121 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "POST /api/health HTTP/1.1" 404 116 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "POST /api/calendar/earnings HTTP/1.1" 404 127 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: NONEXISTENT, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings?symbol=NONEXISTENT&start_date=2050-01-01&end_date=2050-01-02 HTTP/1.1" 200 259 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/calendar/health HTTP/1.1" 200 157 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:33 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/alerts/active HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔔 Active alerts requested for user: dev-user-bypass, status: active

      at log (routes/alerts.js:38:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/alerts/active HTTP/1.1" 200 1508 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/middleware/responseFormatter-middleware.integration.test.js
  Response Formatter Middleware Integration
    Success Response Formatting
      ✓ should format successful responses consistently (22 ms)
      ✓ should format paginated responses consistently (19 ms)
    Error Response Formatting
      ✕ should format error responses with consistent structure (2 ms)
      ✓ should format validation error responses consistently (5 ms)
    Content-Type Header Consistency
      ✓ should set JSON content-type for all API responses (17 ms)
      ✓ should maintain content-type consistency across HTTP methods (10 ms)
    Response Header Standards
      ✓ should include standard security headers (4 ms)
      ✓ should handle CORS headers appropriately (12 ms)
    Response Data Formatting
      ✓ should format nested data structures consistently (3 ms)
      ✓ should handle empty data responses consistently (4 ms)
    Response Timing and Performance Headers
      ✓ should include performance-related headers when available (3 ms)
      ✓ should maintain response time consistency (3 ms)
    Cross-Route Response Consistency
      ✓ should maintain consistent response structure across route families (14 ms)
      ✓ should format authentication-related responses consistently (15 ms)

  ● Response Formatter Middleware Integration › Error Response Formatting › should format error responses with consistent structure

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      109 |         const response = await request(app).get(scenario.endpoint);
      110 |
    > 111 |         expect(response.status).toBe(scenario.expectedStatus);
          |                                 ^
      112 |         expect(response.headers["content-type"]).toMatch(/application\/json/);
      113 |
      114 |         // Error response should have error information

      at Object.toBe (tests/integration/middleware/responseFormatter-middleware.integration.test.js:111:33)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.error
    Error: SyntaxError: Unexpected token 'j', "{"incomplete": json" is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"incomplete": json',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Expected property name or '}' in JSON at position 1
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{invalid: "json"',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token '}', ..."omplete": }" is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"nested": {"incomplete": }',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.error
    Error: SyntaxError: Unexpected non-whitespace character after JSON at position 18
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"valid": "start"}{invalid continuation}',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected non-whitespace character after JSON at position 27
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"escaped": "quote\\"break"}malformed',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/portfolio/../../../etc/passwd HTTP/1.1" 404 139 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/portfolio/%2e%2e%2f%2e%2e%2fetc%2fpasswd HTTP/1.1" 404 150 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/portfolio/ HTTP/1.1" 200 577 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/calendar/earnings?param=value% HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/calendar/earnings?param=value%ZZ HTTP/1.1" 200 259 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 413 124 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 352 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 346 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token 'n', "not json content" is not valid JSON
        at JSON.parse (<anonymous>)
        at createStrictSyntaxError (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:169:10)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:86:15)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: 'not json content',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 347 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 347 "-" "-"
  console.error
    Error: UnsupportedMediaTypeError: unsupported charset "ISO-8859-1"
        at jsonParser (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:130:12)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at logger (/home/stocks/algo/webapp/lambda/node_modules/morgan/index.js:144:5)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at cors (/home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:188:7)
        at /home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:224:17
        at originCallback (/home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:214:15)
        at /home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:219:13
        at optionsCallback (/home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:199:9)
        at corsMiddleware (/home/stocks/algo/webapp/lambda/node_modules/cors/lib/index.js:204:7)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:537:6)
        at xXssProtectionMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:315:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xPoweredByMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:308:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xPermittedCrossDomainPoliciesMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:301:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xFrameOptionsMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:285:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xDownloadOptionsMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:265:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xDnsPrefetchControlMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:258:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at xContentTypeOptionsMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:250:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at strictTransportSecurityMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:243:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at referrerPolicyMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:211:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at originAgentClusterMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:186:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at crossOriginResourcePolicyMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:179:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at crossOriginOpenerPolicyMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:163:3)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at contentSecurityPolicyMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:128:4)
        at internalNext (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:535:6)
        at helmetMiddleware (/home/stocks/algo/webapp/lambda/node_modules/helmet/index.cjs:539:6)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at expressInit (/home/stocks/algo/webapp/lambda/node_modules/express/lib/middleware/init.js:40:5)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at query (/home/stocks/algo/webapp/lambda/node_modules/express/lib/middleware/query.js:45:5)
        at Layer.handle [as handle_request] (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/layer.js:95:5)
        at trim_prefix (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:328:13)
        at /home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:286:9
        at Function.process_params (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:346:12)
        at next (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:280:10)
        at Function.handle (/home/stocks/algo/webapp/lambda/node_modules/express/lib/router/index.js:175:3)
        at Function.handle (/home/stocks/algo/webapp/lambda/node_modules/express/lib/application.js:181:10)
        at Server.app (/home/stocks/algo/webapp/lambda/node_modules/express/lib/express.js:39:9)
        at Server.emit (node:events:524:28)
        at parserOnIncoming (node:_http_server:1141:12)
        at HTTPParser.parserOnHeadersComplete (node:_http_common:118:17) {
      charset: 'iso-8859-1',
      type: 'charset.unsupported'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at jsonParser (node_modules/body-parser/lib/types/json.js:130:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at logger (node_modules/morgan/index.js:144:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at internalNext (node_modules/helmet/index.cjs:537:6)
      at xXssProtectionMiddleware (node_modules/helmet/index.cjs:315:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xPoweredByMiddleware (node_modules/helmet/index.cjs:308:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xPermittedCrossDomainPoliciesMiddleware (node_modules/helmet/index.cjs:301:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xFrameOptionsMiddleware (node_modules/helmet/index.cjs:285:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xDownloadOptionsMiddleware (node_modules/helmet/index.cjs:265:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xDnsPrefetchControlMiddleware (node_modules/helmet/index.cjs:258:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at xContentTypeOptionsMiddleware (node_modules/helmet/index.cjs:250:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at strictTransportSecurityMiddleware (node_modules/helmet/index.cjs:243:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at referrerPolicyMiddleware (node_modules/helmet/index.cjs:211:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at originAgentClusterMiddleware (node_modules/helmet/index.cjs:186:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at crossOriginResourcePolicyMiddleware (node_modules/helmet/index.cjs:179:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at crossOriginOpenerPolicyMiddleware (node_modules/helmet/index.cjs:163:3)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at contentSecurityPolicyMiddleware (node_modules/helmet/index.cjs:128:4)
      at internalNext (node_modules/helmet/index.cjs:535:6)
      at helmetMiddleware (node_modules/helmet/index.cjs:539:6)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 415 101 "-" "-"
  console.error
    Error: SyntaxError: Expected ',' or '}' after property value in JSON at position 30
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"malicious": "<script>alert("xss")</script>"}',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 140 "-" "-"
  console.error
    Error: SyntaxError: Unterminated string in JSON at position 20
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"unclosed": "string',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token 'u', ..."nction": function() "... is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"function": function() {}}',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected token 'u', ..."defined": undefined}" is not valid JSON
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"undefined": undefined}',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.error
    Error: SyntaxError: Unexpected end of JSON input
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"invalid": ',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.error
    Error: SyntaxError: Unexpected end of JSON input
        at JSON.parse (<anonymous>)
        at parse (/home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/types/json.js:92:19)
        at /home/stocks/algo/webapp/lambda/node_modules/body-parser/lib/read.js:128:18
        at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
        at invokeCallback (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:238:16)
        at done (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:227:7)
        at IncomingMessage.onEnd (/home/stocks/algo/webapp/lambda/node_modules/raw-body/index.js:287:7)
        at IncomingMessage.emit (node:events:524:28)
        at endReadableNT (node:internal/streams/readable:1698:12)
        at processTicksAndRejections (node:internal/process/task_queues:82:21) {
      expose: true,
      statusCode: 400,
      status: 400,
      body: '{"invalid": ',
      type: 'entity.parse.failed'
    }

      242 | app.use((err, req, res, _next) => {
      243 |   try {
    > 244 |     console.error("Error:", err);
          |             ^
      245 |   } catch (e) {
      246 |     // Ignore console logging errors
      247 |   }

      at error (server.js:244:13)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (node_modules/express/lib/router/index.js:326:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at node_modules/body-parser/lib/read.js:130:7
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "POST /api/portfolio/analyze HTTP/1.1" 400 135 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/health HTTP/1.1" 200 501 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Market overview completed in 16ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:34 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/errors/malformed-request.integration.test.js
  Malformed Request Integration
    JSON Parsing Error Scenarios
      ✕ should handle malformed JSON gracefully (25 ms)
      ✕ should handle JSON with dangerous characters (2 ms)
      ✕ should handle deeply nested JSON structures (8 ms)
    HTTP Header Malformation
      ✕ should handle malformed authorization headers
      ✕ should handle malformed content-type headers (1 ms)
      ✕ should handle custom header injection attempts (5 ms)
    URL and Path Malformation
      ✕ should handle malformed URLs and paths (10 ms)
      ✕ should handle malformed query parameters (9 ms)
    Request Body Malformation
      ✓ should handle oversized request bodies (9 ms)
      ✓ should handle binary data in JSON fields (7 ms)
      ✕ should handle mismatched content-type and body (3 ms)
    Character Encoding Issues
      ✓ should handle invalid UTF-8 sequences (6 ms)
      ✕ should handle different character encodings (11 ms)
    Security and Sanitization
      ✓ should sanitize error messages containing malformed input (9 ms)
      ✓ should not expose stack traces in malformed request errors (7 ms)
    Error Response Consistency
      ✕ should maintain consistent error format for all malformed requests (3 ms)
      ✓ should handle malformed requests without service disruption (23 ms)

  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle malformed JSON gracefully

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not ""
    Received string:        "Invalid symbols array"

      71 |         // Error should not expose the malformed content
      72 |         if (response.body?.error) {
    > 73 |           expect(response.body.error).not.toContain(test.body);
         |                                           ^
      74 |         }
      75 |       }
      76 |     });

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:73:43)

  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle JSON with dangerous characters

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      114 |
      115 |         // Should handle safely
    > 116 |         expect([200, 404]).toContain(response.status);
          |                            ^
      117 |
      118 |         if (response.status >= 400) {
      119 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:116:28)

  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle deeply nested JSON structures

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      146 |
      147 |       // Should handle deep nesting gracefully
    > 148 |       expect([200, 404]).toContain(response.status);
          |                          ^
      149 |
      150 |       if (response.status >= 400) {
      151 |         expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:148:26)

  ● Malformed Request Integration › HTTP Header Malformation › should handle malformed authorization headers

    TypeError: Invalid character in header content ["Authorization"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › HTTP Header Malformation › should handle malformed content-type headers

    TypeError: Invalid character in header content ["Content-Type"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › HTTP Header Malformation › should handle custom header injection attempts

    expect(received).toMatch(expected)

    Expected pattern: /invalid|malformed|header/i
    Received string:  "expect(received).not.toMatch(expected)·
    Matcher error: received value must be a string·
    Received has value: undefined"

      283 |         } catch (error) {
      284 |           // Some malformed headers might be rejected at HTTP level
    > 285 |           expect(error.message).toMatch(/invalid|malformed|header/i);
          |                                 ^
      286 |         }
      287 |       }
      288 |     });

      at Object.toMatch (tests/integration/errors/malformed-request.integration.test.js:285:33)

  ● Malformed Request Integration › URL and Path Malformation › should handle malformed URLs and paths

    expect(received).toMatch(expected)

    Expected pattern: /invalid|malformed|url/i
    Received string:  "expect(received).toContain(expected) // indexOf·
    Expected value: 200
    Received array: [400, 404, 500]"

      336 |         } catch (error) {
      337 |           // Some malformed URLs might be rejected at HTTP level
    > 338 |           expect(error.message).toMatch(/invalid|malformed|url/i);
          |                                 ^
      339 |         }
      340 |       }
      341 |     });

      at Object.toMatch (tests/integration/errors/malformed-request.integration.test.js:338:33)

  ● Malformed Request Integration › URL and Path Malformation › should handle malformed query parameters

    TypeError: Request path contains unescaped characters

      at Test.request (node_modules/superagent/src/node/index.js:808:22)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › Request Body Malformation › should handle mismatched content-type and body

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      472 |           .send(test.body);
      473 |
    > 474 |         expect([200, 404]).toContain(response.status);
          |                            ^
      475 |
      476 |         if (response.status >= 400) {
      477 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:474:28)

  ● Malformed Request Integration › Character Encoding Issues › should handle different character encodings

    expect(received).toContain(expected) // indexOf

    Expected value: 415
    Received array: [200, 404]

      538 |           .send(testBody);
      539 |
    > 540 |         expect([200, 404]).toContain(response.status);
          |                            ^
      541 |
      542 |         if (response.status >= 400) {
      543 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:540:28)

  ● Malformed Request Integration › Error Response Consistency › should maintain consistent error format for all malformed requests

    TypeError: Invalid character in header content ["Authorization"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/alerts/active HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio/summary HTTP/1.1" 401 529 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "POST /api/portfolio/nonexistent-endpoint HTTP/1.1" 404 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:35 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/infrastructure/middleware-chains.integration.test.js
  Middleware Chain Integration
    Authentication → Validation → Response Pipeline
      ✓ should process complete middleware chain for valid requests (5 ms)
      ✓ should handle auth failure → error formatting chain (2 ms)
      ✓ should handle malformed authorization headers (12 ms)
    Cross-Route Middleware Consistency
      ✓ should apply auth middleware consistently across protected routes (4 ms)
      ✓ should format responses consistently across all routes (6 ms)
    Error Propagation Integration
      ✓ should handle database connection errors gracefully (8 ms)
      ✓ should handle invalid route requests through middleware chain (6 ms)
    Request Context Propagation
      ✓ should maintain user context through service calls (10 ms)
      ✓ should handle concurrent requests through middleware chain (13 ms)
    Performance Under Middleware Load
      ✓ should maintain middleware chain performance (3 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream HTTP/1.1" 404 122 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=AAPL%2CMSFT%2CGOOGL HTTP/1.1" 404 150 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?interval=1000 HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/quotes HTTP/1.1" 404 122 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/quotes?symbols=AAPL%2CMSFT HTTP/1.1" 404 142 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/quotes?limit=5&offset=10 HTTP/1.1" 404 140 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/optimization HTTP/1.1" 404 128 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "POST /live-data/admin/toggle-stream HTTP/1.1" 404 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "POST /live-data/admin/clear-cache HTTP/1.1" 404 133 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/health HTTP/1.1" 404 122 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/health HTTP/1.1" 404 122 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/quotes?symbols=AAPL&limit=1 HTTP/1.1" 404 143 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=AAPL HTTP/1.1" 404 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=MSFT HTTP/1.1" 404 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=GOOGL HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=&interval=-1000 HTTP/1.1" 404 146 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?symbols=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1" 404 1131 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream?interval=invalid HTTP/1.1" 404 139 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /live-data/stream HTTP/1.1" 404 122 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/streaming/sse-streaming.integration.test.js
  SSE Streaming Integration Tests
    Server-Sent Events Streaming
      ✓ should establish SSE connection for live quotes stream (7 ms)
      ✓ should handle SSE streaming with symbol filters (2 ms)
      ✓ should handle SSE streaming with update interval (2 ms)
    Live Data Quotes API
      ✓ should return live quotes with comprehensive data structure (1 ms)
      ✓ should handle symbol filtering for live quotes (1 ms)
      ✓ should handle pagination for live quotes (1 ms)
    Live Data Administration
      ✓ should provide optimization status (1 ms)
      ✓ should handle stream toggle administration (3 ms)
      ✓ should handle cache clearing administration (1 ms)
    Live Data Service Health
      ✓ should provide comprehensive health status (1 ms)
      ✓ should validate streaming service health metrics (1 ms)
    Real-time Data Consistency
      ✓ should maintain data consistency across SSE and API endpoints (1 ms)
      ✓ should handle concurrent SSE connections (3 ms)
    Error Handling and Edge Cases
      ✓ should handle malformed SSE requests gracefully (3 ms)
      ✓ should handle SSE connection interruptions (1 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities HTTP/1.1" 200 415 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities HTTP/1.1" 200 415 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/health HTTP/1.1" 200 130 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/categories HTTP/1.1" 200 1344 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/categories HTTP/1.1" 200 1344 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/categories HTTP/1.1" 200 1344 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/prices HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/prices?limit=5 HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/prices?category=energy HTTP/1.1" 200 575 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/prices?category=metals HTTP/1.1" 200 178 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/prices?category=agriculture HTTP/1.1" 200 381 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations?timeframe=1W HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations?timeframe=1M HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations?timeframe=3M HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations?timeframe=1Y HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/correlations HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/news HTTP/1.1" 200 484 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:36 +0000] "GET /api/commodities/news?category=energy HTTP/1.1" 200 297 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/news?limit=5 HTTP/1.1" 200 483 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/news HTTP/1.1" 200 484 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities HTTP/1.1" 200 415 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/categories HTTP/1.1" 200 1344 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/correlations HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?limit=-1 HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?limit=abc HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?category=invalid-category HTTP/1.1" 200 188 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?timeframe=invalid-timeframe HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?limit=1000 HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities HTTP/1.1" 200 415 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/categories HTTP/1.1" 200 1344 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/market-summary HTTP/1.1" 200 517 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/correlations HTTP/1.1" 200 1252 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/news HTTP/1.1" 200 484 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices HTTP/1.1" 200 1372 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?category=%27%3B%20DROP%20TABLE%20commodities%3B%20-- HTTP/1.1" 200 201 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?category=1%27%20OR%20%271%27%3D%271 HTTP/1.1" 200 184 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?category=UNION%20SELECT%20*%20FROM%20users HTTP/1.1" 200 197 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:38 +0000] "GET /api/commodities/prices?category=%3Cscript%3Ealert(%27xss%27)%3C%2Fscript%3E HTTP/1.1" 200 201 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/commodities.integration.test.js
  Commodities Routes Integration Tests
    GET /api/commodities (Root Endpoint)
      ✓ should return commodities system information (4 ms)
      ✓ should include expected endpoint information (1 ms)
    GET /api/commodities/health (Health Check)
      ✓ should return health status (1 ms)
    GET /api/commodities/categories (Commodity Categories)
      ✓ should return commodity categories (2 ms)
      ✓ should validate category performance data (6 ms)
      ✓ should include major commodity categories (1 ms)
    GET /api/commodities/prices (Current Prices)
      ✓ should return current commodity prices (1 ms)
      ✕ should handle limit parameter (2 ms)
      ✓ should handle category filter (4 ms)
    GET /api/commodities/market-summary (Market Summary)
      ✓ should return market summary data (2 ms)
      ✓ should validate market overview structure (1 ms)
      ✓ should validate top gainers and losers (1 ms)
    GET /api/commodities/correlations (Price Correlations)
      ✓ should return correlation analysis (2 ms)
      ✓ should handle timeframe parameter (4 ms)
      ✕ should validate correlation strength classifications (1 ms)
    GET /api/commodities/news (Commodity News)
      ✕ should return commodity-related news (3 ms)
      ✕ should handle category filter for news (2 ms)
      ✕ should handle limit parameter for news (1990 ms)
      ✕ should validate news article timestamps (2 ms)
    Performance and Edge Cases
      ✓ should handle concurrent requests to commodity endpoints (4 ms)
      ✓ should maintain response time consistency (1 ms)
      ✓ should handle invalid parameters gracefully (4 ms)
      ✓ should validate numeric data integrity (1 ms)
      ✓ should handle memory pressure with large data requests (2 ms)
      ✓ should validate response content types (9 ms)
      ✓ should handle database connection issues gracefully (1 ms)
      ✓ should handle SQL injection attempts safely (4 ms)

  ● Commodities Routes Integration Tests › GET /api/commodities/prices (Current Prices) › should handle limit parameter

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 5
    Received:    6

      163 |
      164 |       if (response.status === 200 && response.body.data.length > 0) {
    > 165 |         expect(response.body.data.length).toBeLessThanOrEqual(5);
          |                                           ^
      166 |       }
      167 |     });
      168 |

      at Object.toBeLessThanOrEqual (tests/integration/routes/commodities.integration.test.js:165:43)

  ● Commodities Routes Integration Tests › GET /api/commodities/correlations (Price Correlations) › should validate correlation strength classifications

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      295 |         response.body.data.correlations.forEach((corr) => {
      296 |           if (corr.strength) {
    > 297 |             expect(validStrengths.includes(corr.strength.toLowerCase())).toBe(
          |                                                                          ^
      298 |               true
      299 |             );
      300 |           }

      at toBe (tests/integration/routes/commodities.integration.test.js:297:74)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/commodities.integration.test.js:295:41)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should return commodity-related news

    expect(received).toHaveProperty(path)

    Expected path: "articles"
    Received path: []

    Received value: [{"category": "commodities", "id": 7, "publishedAt": "2025-09-22T04:00:05.183Z", "source": "WSJ", "symbol": "GLD", "title": "Gold Prices Surge on Economic Uncertainty", "url": "https://example.com/4"}, {"category": "energy", "id": 8, "publishedAt": "2025-09-22T03:00:05.183Z", "source": "MarketWatch", "symbol": "OIL", "title": "Oil Futures Rise Due to Supply Concerns", "url": "https://example.com/5"}]

      312 |       if (response.status === 200) {
      313 |         expect(response.body).toHaveProperty("data");
    > 314 |         expect(response.body.data).toHaveProperty("articles");
          |                                    ^
      315 |         expect(Array.isArray(response.body.data.articles)).toBe(true);
      316 |
      317 |         if (response.body.data.articles.length > 0) {

      at Object.toHaveProperty (tests/integration/routes/commodities.integration.test.js:314:36)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should handle category filter for news

    TypeError: Cannot read properties of undefined (reading 'length')

      339 |         expect([200, 400].includes(response.status)).toBe(true);
      340 |
    > 341 |         if (response.status === 200 && response.body.data.articles.length > 0) {
          |                                                                    ^
      342 |           response.body.data.articles.forEach((article) => {
      343 |             expect(article.category.toLowerCase()).toBe(category.toLowerCase());
      344 |           });

      at Object.length (tests/integration/routes/commodities.integration.test.js:341:68)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should handle limit parameter for news

    TypeError: Cannot read properties of undefined (reading 'length')

      353 |
      354 |       if (response.status === 200) {
    > 355 |         expect(response.body.data.articles.length).toBeLessThanOrEqual(5);
          |                                            ^
      356 |       }
      357 |     });
      358 |

      at Object.length (tests/integration/routes/commodities.integration.test.js:355:44)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should validate news article timestamps

    TypeError: Cannot read properties of undefined (reading 'length')

      360 |       const response = await request(app).get("/api/commodities/news");
      361 |
    > 362 |       if (response.status === 200 && response.body.data.articles.length > 0) {
          |                                                                  ^
      363 |         response.body.data.articles.forEach((article) => {
      364 |           if (article.published_at) {
      365 |             expect(new Date(article.published_at)).toBeInstanceOf(Date);

      at Object.length (tests/integration/routes/commodities.integration.test.js:362:66)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📊 Portfolio summary requested for user: dev-user-bypass

      at log (routes/portfolio.js:174:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio/summary HTTP/1.1" 200 656 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 520 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "POST /api/portfolio/analyze HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/alerts/active HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/trades HTTP/1.1" 200 152 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:40 +0000] "GET /api/portfolio HTTP/1.1" 401 528 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/middleware/auth-middleware.integration.test.js
  Auth Middleware with Service Integration
    Token Validation with Real Auth Service
      ✓ should validate tokens against real auth service (8 ms)
      ✓ should handle expired tokens in service calls (6 ms)
      ✓ should handle malformed auth headers (5 ms)
    Auth Context Propagation Through Service Chain
      ✓ should propagate auth context through service chain (11 ms)
      ✓ should maintain user context across multiple service calls (4 ms)
      ✓ should handle auth failures in middleware chain (2 ms)
    Auth Middleware with Different Route Types
      ✕ should protect all authenticated routes consistently (18 ms)
      ✕ should allow public routes without authentication (5 ms)
    Auth Service Error Handling
      ✓ should handle auth service unavailability gracefully (2 ms)
      ✓ should provide consistent error responses (4 ms)

  ● Auth Middleware with Service Integration › Auth Middleware with Different Route Types › should protect all authenticated routes consistently

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 403, 500]

      127 |         const response = await request(app).get(route);
      128 |
    > 129 |         expect([401, 403, 500]).toContain(response.status);
          |                                 ^
      130 |
      131 |         if (response.status === 401 || response.status === 403) {
      132 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/middleware/auth-middleware.integration.test.js:129:33)

  ● Auth Middleware with Service Integration › Auth Middleware with Different Route Types › should allow public routes without authentication

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 500]

      142 |         const response = await request(app).get(route);
      143 |
    > 144 |         expect([401, 500]).toContain(response.status);
          |                            ^
      145 |       }
      146 |     });
      147 |   });

      at Object.toContain (tests/integration/middleware/auth-middleware.integration.test.js:144:28)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    Processing request: GET /api/earnings

      at log (index.js:403:11)

  console.log
    Initializing database connection...

      at log (index.js:362:13)

  console.log
    Database connection established successfully

      at log (index.js:388:17)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📈 Earnings data requested

      at log (routes/earnings.js:14:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/earnings HTTP/1.1" 200 1489 "-" "-"
  console.log
    Processing request: GET /api/earnings/AAPL

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📈 Earnings details requested for symbol: AAPL

      at log (routes/earnings.js:360:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/earnings/AAPL HTTP/1.1" 200 544 "-" "-"
  console.log
    Processing request: GET /api/earnings

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📈 Earnings data requested

      at log (routes/earnings.js:14:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/earnings?period=upcoming&limit=5 HTTP/1.1" 200 1260 "-" "-"
  console.log
    Processing request: GET /api/calendar/earnings

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Processing request: GET /api/calendar/earnings-history

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/calendar/earnings-history HTTP/1.1" 200 2045 "-" "-"
  console.log
    Processing request: GET /api/calendar/earnings-estimates

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/calendar/earnings-estimates HTTP/1.1" 200 1442 "-" "-"
  console.log
    Processing request: GET /api/earnings/INVALID_SYMBOL

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📈 Earnings details requested for symbol: INVALID_SYMBOL

      at log (routes/earnings.js:360:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:41 +0000] "GET /api/earnings/INVALID_SYMBOL HTTP/1.1" 404 126 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/earnings.integration.test.js
  Earnings Data Integration
    Earnings Calendar (Delegated)
      ✕ should delegate to calendar earnings endpoint (12 ms)
      ✕ should delegate symbol-specific requests to calendar (9 ms)
      ✕ should handle query parameters for delegation (6 ms)
    Direct Calendar Earnings Access
      ✕ should access earnings via calendar route directly (6 ms)
      ✓ should access earnings history via calendar route (12 ms)
      ✓ should access earnings estimates via calendar route (5 ms)
    Error Handling
      ✓ should handle delegation errors gracefully (6 ms)

  ● Earnings Data Integration › Earnings Calendar (Delegated) › should delegate to calendar earnings endpoint

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.64", "eps_difference": null, "eps_estimate": "1.59", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.1", "symbol": "GOOGL"}, {"eps_actual": "2.93", "eps_difference": null, "eps_estimate": "2.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "2.8", "symbol": "MSFT"}, {"eps_actual": "0.71", "eps_difference": null, "eps_estimate": "0.73", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "-2.7", "symbol": "TSLA"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}, {"eps_actual": "2.69", "eps_difference": null, "eps_estimate": "2.65", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "1.5", "symbol": "MSFT"}], "pagination": {"hasMore": false, "limit": 50, "page": 1, "total": 6}, "success": true, "timestamp": "2025-09-23T13:39:41.029Z"}

      17 |
      18 |       if (response.status === 200) {
    > 19 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      20 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      21 |       }
      22 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:19:31)

  ● Earnings Data Integration › Earnings Calendar (Delegated) › should delegate symbol-specific requests to calendar

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"count": 2, "data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}], "success": true, "symbol": "AAPL", "timestamp": "2025-09-23T13:39:41.042Z"}

      28 |
      29 |       if (response.status === 200) {
    > 30 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      31 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      32 |       }
      33 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:30:31)

  ● Earnings Data Integration › Earnings Calendar (Delegated) › should handle query parameters for delegation

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.64", "eps_difference": null, "eps_estimate": "1.59", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.1", "symbol": "GOOGL"}, {"eps_actual": "2.93", "eps_difference": null, "eps_estimate": "2.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "2.8", "symbol": "MSFT"}, {"eps_actual": "0.71", "eps_difference": null, "eps_estimate": "0.73", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "-2.7", "symbol": "TSLA"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}], "pagination": {"hasMore": true, "limit": 5, "page": 1, "total": 5}, "success": true, "timestamp": "2025-09-23T13:39:41.047Z"}

      41 |
      42 |       if (response.status === 200) {
    > 43 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      44 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      45 |         // Should respect limit parameter when delegating
      46 |         expect(response.body.earnings.length).toBeLessThanOrEqual(5);

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:43:31)

  ● Earnings Data Integration › Direct Calendar Earnings Access › should access earnings via calendar route directly

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": {"earnings": [], "grouped_by_date": {}, "summary": {"completed_reports": 0, "message": "No earnings data found for the specified criteria", "sectors_represented": 0, "total_earnings": 0, "upcoming_reports": 0}}, "success": true, "timestamp": "2025-09-23T13:39:41.054Z"}

      56 |
      57 |       if (response.status === 200) {
    > 58 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      59 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      60 |       }
      61 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:58:31)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/unit/routes/trades.test.js
  Trades Routes - Testing Your Actual Site
    GET /trades/health - Health check
      ○ skipped should return trade service health status
    GET /trades/ - Root endpoint
      ○ skipped should return trade API ready message
    GET /trades/import/status - Trade import status
      ○ skipped should require authentication and handle protected endpoint
      ○ skipped should handle missing dependencies gracefully
    Authentication
      ○ skipped should require authentication for protected routes
      ○ skipped should handle route errors gracefully
    GET /trades/history - Trade history
      ○ skipped should return user trade history with pagination
      ○ skipped should handle date range filtering
      ○ skipped should filter by symbol
      ○ skipped should support pagination parameters
    GET /trades/analytics - Trade analytics
      ○ skipped should return trade performance analytics
      ○ skipped should handle time period filters
      ○ skipped should include benchmark comparison
    POST /trades/import - Import trades
      ○ skipped should import trades from CSV data
      ○ skipped should validate required fields
      ○ skipped should handle duplicate trades
      ○ skipped should handle invalid data formats
    GET /trades/export - Export trades
      ○ skipped should export trades in CSV format
      ○ skipped should export trades in JSON format
      ○ skipped should handle date range for export
    GET /trades/brokers - Broker integration status
      ✕ should return connected brokers status (12 ms)
    POST /trades/sync/:broker - Sync trades from broker
      ○ skipped should sync trades from Alpaca
      ○ skipped should handle unsupported broker
      ○ skipped should validate date parameters
    GET /trades/performance - Performance analysis
      ○ skipped should return detailed performance metrics
      ○ skipped should include benchmark comparison
      ○ skipped should support different time periods
    GET /trades/performance/attribution - Performance attribution
      ○ skipped should return performance attribution analysis
    GET /trades/stats - Trade statistics
      ○ skipped should return comprehensive trade statistics
      ○ skipped should filter stats by date range
      ○ skipped should group stats by time period
    POST /trades/validate - Trade validation
      ○ skipped should validate trade data before import
      ○ skipped should identify invalid trade data
    POST /trades/search - Advanced trade search
      ○ skipped should search trades by multiple criteria
      ○ skipped should handle empty search criteria
    Error handling
      ○ skipped should handle database connection errors
      ○ skipped should handle transaction rollback on import errors
      ○ skipped should handle malformed request data
      ○ skipped should handle missing authentication
      ○ skipped should handle various error scenarios
      ○ skipped should validate request parameters

  ● Trades Routes - Testing Your Actual Site › GET /trades/brokers - Broker integration status › should return connected brokers status

    expect(received).toHaveProperty(path)

    Expected path: "brokers"
    Received path: []

    Received value: {"broker_name": "alpaca", "last_sync": "2024-01-15T10:00:00Z", "status": "connected", "trade_count": 50}

      449 |       expect(response.body).toHaveProperty("success", true);
      450 |       expect(response.body).toHaveProperty("data");
    > 451 |       expect(response.body.data).toHaveProperty("brokers");
          |                                  ^
      452 |       expect(Array.isArray(response.body.data.brokers)).toBe(true);
      453 |
      454 |       if (response.body.data.brokers.length > 0) {

      at Object.toHaveProperty (tests/unit/routes/trades.test.js:451:34)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/services/aiStrategyGenerator.test.js
  AI Strategy Generator Service Integration Tests
    Service Initialization
      ✓ should initialize service with proper configuration (1 ms)
      ✓ should generate unique correlation IDs (1 ms)
    Strategy Generation Workflow
      ✕ should generate strategy from natural language description
      ✕ should handle different asset types
      ✕ should validate generated strategies (1 ms)
      ✕ should handle complex multi-indicator strategies
    Strategy Optimization
      ✕ should optimize strategy parameters (1 ms)
      ✕ should provide optimization explanations
    Strategy Explanation and Documentation
      ✕ should explain strategy logic clearly
      ✕ should provide educational content
    Error Handling and Edge Cases
      ✕ should handle invalid strategy descriptions gracefully (1 ms)
      ✕ should handle malformed preferences
      ✕ should fallback to templates when AI is unavailable
      ✕ should handle timeout scenarios
    Performance and Metrics
      ✕ should track generation performance metrics
      ✕ should handle concurrent strategy generation requests
    Integration with Backend Services
      ✕ should integrate with database for strategy storage
      ✕ should provide strategy export formats

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should generate strategy from natural language description

    TypeError: generator.generateStrategy is not a function

      62 |       };
      63 |
    > 64 |       const result = await generator.generateStrategy(description, preferences);
         |                                      ^
      65 |
      66 |       expect(result).toHaveProperty("success", true);
      67 |       expect(result).toHaveProperty("strategy");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:64:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should handle different asset types

    TypeError: generator.generateStrategy is not a function

      76 |       const description = "Simple moving average crossover strategy";
      77 |
    > 78 |       const stockResult = await generator.generateStrategy(description, {
         |                                           ^
      79 |         risk_level: "low",
      80 |         timeframe: "1hour",
      81 |         asset_type: "stock",

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:78:43)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should validate generated strategies

    TypeError: generator.generateStrategy is not a function

      102 |       };
      103 |
    > 104 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      105 |
      106 |       expect(result.success).toBe(true);
      107 |       expect(result.strategy).toHaveProperty("validation");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:104:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should handle complex multi-indicator strategies

    TypeError: generator.generateStrategy is not a function

      120 |       };
      121 |
    > 122 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      123 |
      124 |       expect(result.success).toBe(true);
      125 |       expect(result.strategy.code).toContain("rsi");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:122:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Optimization › should optimize strategy parameters

    TypeError: generator.optimizeStrategy is not a function

      147 |       };
      148 |
    > 149 |       const result = await generator.optimizeStrategy(strategy, {
          |                                      ^
      150 |         optimization_method: "grid_search",
      151 |         metric: "sharpe_ratio",
      152 |       });

      at Object.optimizeStrategy (tests/integration/services/aiStrategyGenerator.test.js:149:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Optimization › should provide optimization explanations

    TypeError: generator.optimizeStrategy is not a function

      167 |       };
      168 |
    > 169 |       const result = await generator.optimizeStrategy(strategy, {
          |                                      ^
      170 |         optimization_method: "bayesian",
      171 |         metric: "total_return",
      172 |       });

      at Object.optimizeStrategy (tests/integration/services/aiStrategyGenerator.test.js:169:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Explanation and Documentation › should explain strategy logic clearly

    TypeError: generator.generateStrategy is not a function

      194 |       };
      195 |
    > 196 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      197 |
      198 |       expect(result.success).toBe(true);
      199 |       expect(result.strategy.explanation).toContain("RSI");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:196:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Explanation and Documentation › should provide educational content

    TypeError: generator.explainStrategy is not a function

      208 |       };
      209 |
    > 210 |       const result = await generator.explainStrategy(strategy);
          |                                      ^
      211 |
      212 |       expect(result).toHaveProperty("success", true);
      213 |       expect(result).toHaveProperty("explanation");

      at Object.explainStrategy (tests/integration/services/aiStrategyGenerator.test.js:210:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle invalid strategy descriptions gracefully

    TypeError: generator.generateStrategy is not a function

      234 |       };
      235 |
    > 236 |       const result = await generator.generateStrategy(
          |                                      ^
      237 |         invalidDescription,
      238 |         preferences
      239 |       );

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:236:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle malformed preferences

    TypeError: generator.generateStrategy is not a function

      252 |       };
      253 |
    > 254 |       const result = await generator.generateStrategy(
          |                                      ^
      255 |         description,
      256 |         invalidPreferences
      257 |       );

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:254:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should fallback to templates when AI is unavailable

    TypeError: generator.generateStrategy is not a function

      274 |       };
      275 |
    > 276 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      277 |
      278 |       expect(result.success).toBe(true);
      279 |       expect(result.strategy.code).toContain("def run_strategy");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:276:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle timeout scenarios

    TypeError: generator.generateStrategy is not a function

      293 |       generator.aiConfig.timeout = 100; // 100ms
      294 |
    > 295 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      296 |
      297 |       // Should either succeed quickly or fail gracefully with timeout
      298 |       expect(typeof result.success).toBe("boolean");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:295:38)

  ● AI Strategy Generator Service Integration Tests › Performance and Metrics › should track generation performance metrics

    TypeError: generator.generateStrategy is not a function

      322 |
      323 |       const startTime = Date.now();
    > 324 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      325 |       const endTime = Date.now();
      326 |
      327 |       expect(result.success).toBe(true);

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:324:38)

  ● AI Strategy Generator Service Integration Tests › Performance and Metrics › should handle concurrent strategy generation requests

    TypeError: generator.generateStrategy is not a function

      338 |       for (let i = 0; i < 3; i++) {
      339 |         requests.push(
    > 340 |           generator.generateStrategy(`RSI strategy ${i}`, {
          |                     ^
      341 |             risk_level: "medium",
      342 |             timeframe: "1day",
      343 |             asset_type: "stock",

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:340:21)

  ● AI Strategy Generator Service Integration Tests › Integration with Backend Services › should integrate with database for strategy storage

    TypeError: generator.generateStrategy is not a function

      371 |       };
      372 |
    > 373 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      374 |
      375 |       expect(result.success).toBe(true);
      376 |

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:373:38)

  ● AI Strategy Generator Service Integration Tests › Integration with Backend Services › should provide strategy export formats

    TypeError: generator.exportStrategy is not a function

      390 |       };
      391 |
    > 392 |       const exportResult = await generator.exportStrategy(strategy, "json");
          |                                            ^
      393 |
      394 |       expect(exportResult).toHaveProperty("success", true);
      395 |       expect(exportResult).toHaveProperty("exported_strategy");

      at Object.exportStrategy (tests/integration/services/aiStrategyGenerator.test.js:392:44)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.error
    Database query error: {
      error: 'column "name" of relation "stock_symbols" does not exist',
      query: 'INSERT INTO stock_symbols (symbol, name) VALUES ($1, $2) ON CONFLICT (symbol) DO UPDATE SET name = $...',
      params: '2 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:746:7)

  console.error
    Database query error: {
      error: 'column "name" of relation "stock_symbols" does not exist',
      query: 'INSERT INTO stock_symbols (symbol, name, sector) VALUES ($1, $2, $3) ON CONFLICT (symbol) DO UPDATE ...',
      params: '3 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:821:7)

  console.error
    Database query error: {
      error: 'column "symbol" does not exist',
      query: "DELETE FROM market_data WHERE symbol LIKE 'T%' OR symbol LIKE 'U%' OR symbol LIKE 'A%' OR symbol LIK...",
      params: 'no parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:37:7)

  console.warn
    Cleanup warning: column "symbol" does not exist

      42 |       );
      43 |     } catch (error) {
    > 44 |       console.warn("Cleanup warning:", error.message);
         |               ^
      45 |     }
      46 |
      47 |     await closeDatabase();

      at Object.warn (tests/integration/utils/database.integration.test.js:44:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/database.integration.test.js
  Database Real Site Functionality Tests
    Real Database Query Operations
      ○ skipped should execute basic SELECT queries against real database
      ○ skipped should handle parameterized queries correctly
      ○ skipped should prevent SQL injection attacks with parameterized queries
      ○ skipped should handle database errors gracefully
      ○ skipped should handle syntax errors gracefully
      ○ skipped should work with complex JOIN queries on real tables
      ○ skipped should handle aggregate functions and calculations
      ○ skipped should handle date/time operations
    Database Initialization and Schema
      ○ skipped should initialize database and create required tables
      ○ skipped should verify database connection and schema integrity
      ○ skipped should handle database configuration from environment variables
    Real Database Schema Operations
      ○ skipped should initialize and verify schema tables
      ○ skipped should handle table creation and constraints
      ○ skipped should handle unique constraints properly
    Connection Pool Management
      ○ skipped should provide working connection pool
      ○ skipped should manage connection lifecycle properly
      ○ skipped should perform accurate health checks
      ○ skipped should handle concurrent connections properly
      ○ skipped should handle connection pool stats
    Transaction Support
      ○ skipped should execute transactions with commit
      ○ skipped should rollback transactions on error
      ○ skipped should handle nested transaction operations
    Real-World Data Operations
      ○ skipped should handle bulk data insertions efficiently
      ○ skipped should handle complex analytical queries
      ○ skipped should handle time-based queries with proper indexing performance
    Advanced Transaction Integration Scenarios
      ✕ should handle concurrent transactions without conflicts (2 ms)
      ✕ should handle transaction rollback with concurrent access (6 ms)
      ✕ should handle cross-table transaction consistency (7 ms)
      ✕ should handle transaction isolation levels (2 ms)
      ✕ should handle large transaction data volumes (14 ms)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle concurrent transactions without conflicts

    error: column "name" of relation "stock_symbols" does not exist

      694 |
      695 |           // Insert stock symbol
    > 696 |           await client.query(
          |           ^
      697 |             "INSERT INTO stock_symbols (symbol, name, sector) VALUES ($1, $2, $3) ON CONFLICT (symbol) DO UPDATE SET name = $2",
      698 |             [symbol, `Concurrent Test ${i}`, "Technology"]
      699 |           );

      at node_modules/pg/lib/client.js:545:17
      at tests/integration/utils/database.integration.test.js:696:11
      at transaction (utils/database.js:1461:20)
          at async Promise.all (index 0)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:720:23)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle transaction rollback with concurrent access

    error: column "name" of relation "stock_symbols" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:746:7)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle cross-table transaction consistency

    error: column "name" of relation "stock_symbols" does not exist

      782 |       const result = await transaction(async (client) => {
      783 |         // Insert stock symbol and market data in same transaction
    > 784 |         const stockResult = await client.query(
          |                             ^
      785 |           "INSERT INTO stock_symbols (symbol, name, sector, market_cap) VALUES ($1, $2, $3, $4) ON CONFLICT (symbol) DO UPDATE SET name = $2 RETURNING symbol",
      786 |           [symbol, "Cross Table Test", "Finance", 1000000000]
      787 |         );

      at node_modules/pg/lib/client.js:545:17
      at tests/integration/utils/database.integration.test.js:784:29
      at transaction (utils/database.js:1461:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:782:22)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle transaction isolation levels

    error: column "name" of relation "stock_symbols" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:821:7)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle large transaction data volumes

    error: column "name" of relation "stock_symbols" does not exist

      916 |         }
      917 |
    > 918 |         await Promise.all(insertPromises);
          |         ^
      919 |
      920 |         // Verify all data within transaction
      921 |         const countResult = await client.query(

      at node_modules/pg/lib/client.js:545:17
          at async Promise.all (index 0)
      at tests/integration/utils/database.integration.test.js:918:9
      at transaction (utils/database.js:1461:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:888:22)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/tradingModeHelper.test.js
  Trading Mode Helper Integration Tests
    Trading Mode Management
      ✕ should get current trading mode (2 ms)
      ✕ should switch to paper trading mode (2 ms)
      ✕ should switch to live trading mode with validation (1 ms)
      ✕ should handle simulation mode
    Mode Validation
      ✕ should validate paper trading requirements
      ✕ should validate live trading requirements (1 ms)
      ✕ should prevent unauthorized mode switches (1 ms)
    Trading Environment Configuration
      ✕ should configure paper trading environment
      ✕ should configure live trading environment
      ✕ should handle environment health checks
    Risk Management Integration
      ✕ should enforce risk limits by trading mode
      ✓ should adjust risk limits based on trading mode (1 ms)
    Mode-Specific Features
      ✓ should handle paper trading simulations (2 ms)
      ✕ should track paper trading performance
      ✕ should handle backtesting mode
    Data Isolation and Security
      ✕ should maintain data isolation between modes (1 ms)
      ✕ should secure live trading credentials (1 ms)
    Performance and Monitoring
      ✕ should monitor mode switching performance (2 ms)
      ✕ should handle concurrent mode operations
    Error Handling and Edge Cases
      ✕ should handle invalid mode transitions
      ✕ should handle system failures gracefully
      ✕ should handle network connectivity issues
    Audit and Compliance
      ✕ should log all mode changes (6 ms)
      ✕ should maintain compliance records (1 ms)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should get current trading mode

    expect(received).toBeDefined()

    Received: undefined

      24 |
      25 |       expect(currentMode).toBeDefined();
    > 26 |       expect(currentMode.mode).toBeDefined();
         |                                ^
      27 |       expect(["paper", "live", "simulation", "backtest"]).toContain(
      28 |         currentMode.mode
      29 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:26:32)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should switch to paper trading mode

    expect(received).toBe(expected) // Object.is equality

    Expected: "paper"
    Received: undefined

      43 |       expect(switchResult.success).toBe(true);
      44 |       expect(switchResult.previousMode).toBeDefined();
    > 45 |       expect(switchResult.currentMode).toBe("paper");
         |                                        ^
      46 |       expect(switchResult.switchedAt).toBeDefined();
      47 |       expect(switchResult.confirmation).toBeDefined();
      48 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:45:40)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should switch to live trading mode with validation

    expect(received).toBe(expected) // Object.is equality

    Expected: "live"
    Received: undefined

      70 |
      71 |       if (switchResult.success) {
    > 72 |         expect(switchResult.currentMode).toBe("live");
         |                                          ^
      73 |         expect(switchResult.riskLimits).toEqual(liveConfig.riskLimits);
      74 |         expect(switchResult.safeguards).toBeDefined();
      75 |       } else {

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:72:42)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should handle simulation mode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

       95 |       );
       96 |
    >  97 |       expect(switchResult.success).toBe(true);
          |                                    ^
       98 |       expect(switchResult.currentMode).toBe("simulation");
       99 |       expect(switchResult.simulationSettings).toEqual(simulationConfig);
      100 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:97:36)

  ● Trading Mode Helper Integration Tests › Mode Validation › should validate paper trading requirements

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      110 |
      111 |       expect(validation).toBeDefined();
    > 112 |       expect(validation.isValid).toBe(true);
          |                                  ^
      113 |       expect(validation.requirements).toBeDefined();
      114 |       expect(validation.checks).toBeDefined();
      115 |

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:112:34)

  ● Trading Mode Helper Integration Tests › Mode Validation › should validate live trading requirements

    TypeError: Cannot read properties of undefined (reading 'find')

      141 |
      142 |       requiredChecks.forEach((checkName) => {
    > 143 |         const check = validation.checks.find((c) => c.name === checkName);
          |                                         ^
      144 |         expect(check).toBeDefined();
      145 |       });
      146 |     });

      at find (tests/integration/utils/tradingModeHelper.test.js:143:41)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/tradingModeHelper.test.js:142:22)

  ● Trading Mode Helper Integration Tests › Mode Validation › should prevent unauthorized mode switches

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      155 |       );
      156 |
    > 157 |       expect(switchResult.success).toBe(false);
          |                                    ^
      158 |       expect(switchResult.error).toBeDefined();
      159 |       expect(switchResult.error.code).toBe("UNAUTHORIZED");
      160 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:157:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should configure paper trading environment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      177 |
      178 |       expect(configResult).toBeDefined();
    > 179 |       expect(configResult.success).toBe(true);
          |                                    ^
      180 |       expect(configResult.configuration).toEqual(paperConfig);
      181 |       expect(configResult.environmentReady).toBe(true);
      182 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:179:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should configure live trading environment

    expect(received).toBeDefined()

    Received: undefined

      204 |       } else {
      205 |         // May fail in test environment
    > 206 |         expect(configResult.error).toBeDefined();
          |                                    ^
      207 |       }
      208 |     });
      209 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:206:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should handle environment health checks

    expect(received).toBeDefined()

    Received: undefined

      213 |
      214 |       expect(healthCheck).toBeDefined();
    > 215 |       expect(healthCheck.status).toBeDefined();
          |                                  ^
      216 |       expect(["healthy", "degraded", "unhealthy"]).toContain(
      217 |         healthCheck.status
      218 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:215:34)

  ● Trading Mode Helper Integration Tests › Risk Management Integration › should enforce risk limits by trading mode

    expect(received).toBeDefined()

    Received: undefined

      245 |
      246 |       expect(riskCheck).toBeDefined();
    > 247 |       expect(riskCheck.approved).toBeDefined();
          |                                  ^
      248 |       expect(riskCheck.riskScore).toBeDefined();
      249 |       expect(riskCheck.appliedLimits).toBeDefined();
      250 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:247:34)

  ● Trading Mode Helper Integration Tests › Mode-Specific Features › should track paper trading performance

    expect(received).toBeDefined()

    Received: undefined

      321 |       expect(performance).toBeDefined();
      322 |       expect(performance.totalReturn).toBeDefined();
    > 323 |       expect(performance.realizedPnL).toBeDefined();
          |                                       ^
      324 |       expect(performance.unrealizedPnL).toBeDefined();
      325 |       expect(performance.tradeCount).toBeDefined();
      326 |       expect(performance.winRate).toBeDefined();

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:323:39)

  ● Trading Mode Helper Integration Tests › Mode-Specific Features › should handle backtesting mode

    expect(received).toBeDefined()

    Received: undefined

      348 |
      349 |       expect(backtestResult).toBeDefined();
    > 350 |       expect(backtestResult.backtestId).toBeDefined();
          |                                         ^
      351 |       expect(backtestResult.status).toBeDefined();
      352 |       expect(backtestResult.progress).toBeDefined();
      353 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:350:41)

  ● Trading Mode Helper Integration Tests › Data Isolation and Security › should maintain data isolation between modes

    TypeError: tradingModeHelper.getPositions is not a function

      374 |       });
      375 |
    > 376 |       const paperPositions = await tradingModeHelper.getPositions(userId);
          |                                                      ^
      377 |
      378 |       // Switch to simulation mode
      379 |       await tradingModeHelper.switchMode(userId, "simulation");

      at Object.getPositions (tests/integration/utils/tradingModeHelper.test.js:376:54)

  ● Trading Mode Helper Integration Tests › Data Isolation and Security › should secure live trading credentials

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      398 |
      399 |       expect(securityCheck).toBeDefined();
    > 400 |       expect(securityCheck.encrypted).toBe(true);
          |                                       ^
      401 |       expect(securityCheck.keyStrength).toBeDefined();
      402 |       expect(securityCheck.securityScore).toBeDefined();
      403 |

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:400:39)

  ● Trading Mode Helper Integration Tests › Performance and Monitoring › should monitor mode switching performance

    expect(received).toBeDefined()

    Received: undefined

      421 |       expect(metrics.averageSwitchTime).toBeDefined();
      422 |       expect(metrics.successRate).toBeDefined();
    > 423 |       expect(metrics.activeUsers).toBeDefined();
          |                                   ^
      424 |     });
      425 |
      426 |     test("should handle concurrent mode operations", async () => {

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:423:35)

  ● Trading Mode Helper Integration Tests › Performance and Monitoring › should handle concurrent mode operations

    TypeError: tradingModeHelper.getPositions is not a function

      432 |         tradingModeHelper.validateModeRequirements(userId, "paper"),
      433 |         tradingModeHelper.getCurrentRiskLimits(userId),
    > 434 |         tradingModeHelper.getPositions(userId),
          |                           ^
      435 |       ];
      436 |
      437 |       const results = await Promise.all(operations);

      at Object.getPositions (tests/integration/utils/tradingModeHelper.test.js:434:27)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle invalid mode transitions

    expect(received).toBe(expected) // Object.is equality

    Expected: "INVALID_MODE"
    Received: undefined

      455 |       expect(invalidTransition.success).toBe(false);
      456 |       expect(invalidTransition.error).toBeDefined();
    > 457 |       expect(invalidTransition.error.code).toBe("INVALID_MODE");
          |                                            ^
      458 |     });
      459 |
      460 |     test("should handle system failures gracefully", async () => {

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:457:44)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle system failures gracefully

    expect(received).toBeDefined()

    Received: undefined

      471 |
      472 |       expect(failureRecovery).toBeDefined();
    > 473 |       expect(failureRecovery.recovered).toBeDefined();
          |                                         ^
      474 |       expect(failureRecovery.fallbackActivated).toBeDefined();
      475 |
      476 |       if (failureRecovery.fallbackActivated) {

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:473:41)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle network connectivity issues

    expect(received).toBeDefined()

    Received: undefined

      485 |
      486 |       expect(connectivityCheck).toBeDefined();
    > 487 |       expect(connectivityCheck.status).toBeDefined();
          |                                        ^
      488 |       expect(["connected", "degraded", "disconnected"]).toContain(
      489 |         connectivityCheck.status
      490 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:487:40)

  ● Trading Mode Helper Integration Tests › Audit and Compliance › should log all mode changes

    expect(received).toBe(expected) // Object.is equality

    Expected: "MODE_SWITCH"
    Received: "mode_switch"

      516 |
      517 |       const latestEntry = auditLog.entries[0];
    > 518 |       expect(latestEntry.action).toBe("MODE_SWITCH");
          |                                  ^
      519 |       expect(latestEntry.userId).toBe(userId);
      520 |       expect(latestEntry.details.targetMode).toBe("paper");
      521 |       expect(latestEntry.timestamp).toBeDefined();

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:518:34)

  ● Trading Mode Helper Integration Tests › Audit and Compliance › should maintain compliance records

    expect(received).toBeDefined()

    Received: undefined

      527 |
      528 |       expect(compliance).toBeDefined();
    > 529 |       expect(compliance.status).toBeDefined();
          |                                 ^
      530 |       expect(compliance.checks).toBeDefined();
      531 |       expect(compliance.lastUpdate).toBeDefined();
      532 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:529:33)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    Step 1: Setting up risk limits...

      at Object.log (tests/integration/risk-management-workflow.integration.test.js:62:15)

  console.log
    ⚠️ Portfolio risk requested for user: integration-test-user

      at log (routes/trading.js:2251:13)

  console.error
    Database query error: {
      error: 'column "total_value" of relation "portfolio_holdings" does not exist',
      query: '\n' +
        '          INSERT INTO portfolio_holdings (\n' +
        '            user_id, symbol, quantity, average_cost, cur...',
      params: '10 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:400:9)

  console.error
    Database query error: {
      error: 'column "total_value" of relation "portfolio_holdings" does not exist',
      query: '\n' +
        '        INSERT INTO portfolio_holdings (\n' +
        '          user_id, symbol, quantity, average_cost, current...',
      params: '10 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:448:7)

  console.error
    Database query error: {
      error: 'column "total_value" of relation "portfolio_holdings" does not exist',
      query: '\n' +
        '        INSERT INTO portfolio_holdings (\n' +
        '          user_id, symbol, quantity, average_cost, current...',
      params: '10 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:510:7)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/risk-management-workflow.integration.test.js
  Risk Management Workflow Integration Tests
    Complete Risk Management Workflow
      ✕ should execute full risk management lifecycle (11 ms)
      ✕ should handle empty portfolio risk analysis (6 ms)
      ✕ should handle multiple rapid position closes (1 ms)
      ✕ should maintain data consistency across concurrent operations (6 ms)
    Risk Limit Compliance Checking
      ✕ should detect and report risk limit violations (7 ms)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should execute full risk management lifecycle

    expected 200 "OK", got 401 "Unauthorized"

      76 |         .post("/api/trading/risk/limits")
      77 |         .send(riskLimits)
    > 78 |         .expect(200);
         |          ^
      79 |
      80 |       expect(limitsResponse.body.success).toBe(true);
      81 |       expect(limitsResponse.body.data.maxDrawdown).toBe(15.0);

      at Object.expect (tests/integration/risk-management-workflow.integration.test.js:78:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should handle empty portfolio risk analysis

    TypeError: Cannot read properties of undefined (reading 'totalPositions')

      385 |
      386 |       expect(response.body.success).toBe(true);
    > 387 |       expect(response.body.data.portfolioSummary.totalPositions).toBe(0);
          |                                                  ^
      388 |       expect(response.body.data.portfolioSummary.totalValue).toBe(0);
      389 |       expect(response.body.data.riskMetrics.riskLevel).toBe("low");
      390 |       expect(response.body.data.recommendations).toContain(

      at Object.totalPositions (tests/integration/risk-management-workflow.integration.test.js:387:50)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should handle multiple rapid position closes

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:400:9)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should maintain data consistency across concurrent operations

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:448:7)

  ● Risk Management Workflow Integration Tests › Risk Limit Compliance Checking › should detect and report risk limit violations

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:510:7)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/portfolio.integration.test.js
  Portfolio Integration Tests - 100% Coverage
    Core Portfolio APIs
      ✕ GET /api/portfolio - should return portfolio API info (32 ms)
      ✕ GET /api/portfolio/summary - should return portfolio summary (2 ms)
      ✕ GET /api/portfolio/positions - should return portfolio positions (2 ms)
      ✕ GET /api/portfolio/holdings - should return portfolio holdings (2 ms)
      ✕ GET /api/portfolio/value - should return portfolio value data (2 ms)
      ✕ GET /api/portfolio/allocation - should return portfolio allocation (2 ms)
      ✕ GET /api/portfolio/allocations - should return portfolio allocations (2 ms)
    Analytics and Analysis APIs
      ✕ GET /api/portfolio/analytics - should return portfolio analytics (2 ms)
    Performance and Returns APIs
      ✕ GET /api/portfolio/returns - should return portfolio returns (1 ms)
      ✕ GET /api/portfolio/benchmark - should return benchmark comparison (1 ms)
    Risk Management APIs
      ✕ GET /api/portfolio/risk - should return risk assessment (1 ms)
      ✕ GET /api/portfolio/risk-analysis - should return risk analysis (1 ms)
      ✕ GET /api/portfolio/risk/analysis - should return detailed risk analysis (1 ms)
      ✕ GET /api/portfolio/risk/var - should return VaR analysis (2 ms)
      ✕ GET /api/portfolio/risk/stress-test - should return stress test results (1 ms)
      ✕ GET /api/portfolio/risk/concentration - should return concentration risk (2 ms)
    Portfolio Management APIs
      ✕ GET /api/portfolio/rebalance - should return rebalance recommendations (1 ms)
      ✕ GET /api/portfolio/optimization - should return optimization suggestions (2 ms)
      ✕ GET /api/portfolio/watchlist - should return portfolio watchlist (2 ms)
      ✕ GET /api/portfolio/transactions - should return portfolio transactions (1 ms)
    Broker Integration APIs
      ✕ GET /api/portfolio/api-keys - should return API keys status (2 ms)
      ✕ POST /api/portfolio/api-keys - should handle API key creation (6 ms)
    Health and System APIs
      ✕ GET /api/portfolio/health - should return portfolio service health (2 ms)
    Error Handling and Authentication
      ✓ should require authentication for protected endpoints (1 ms)
      ✕ should handle invalid endpoints gracefully (1 ms)
      ✕ should handle invalid user IDs gracefully (1 ms)
      ✕ DELETE /api/portfolio/api-keys/test-broker - should handle API key deletion (7 ms)
      ✕ GET /api/portfolio/data - should redirect to holdings endpoint (1 ms)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio - should return portfolio API info

    expected 200 "OK", got 401 "Unauthorized"

      16 |         .get("/api/portfolio")
      17 |         .set(auth)
    > 18 |         .expect(200);
         |          ^
      19 |
      20 |       expect(response.body).toHaveProperty("success", true);
      21 |       expect(response.body).toHaveProperty("message");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:18:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/summary - should return portfolio summary

    expected 200 "OK", got 401 "Unauthorized"

      28 |         .get("/api/portfolio/summary")
      29 |         .set(auth)
    > 30 |         .expect(200);
         |          ^
      31 |
      32 |       expect(response.body).toHaveProperty("success", true);
      33 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:30:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/positions - should return portfolio positions

    expected 200 "OK", got 401 "Unauthorized"

      38 |         .get("/api/portfolio/positions")
      39 |         .set(auth)
    > 40 |         .expect(200);
         |          ^
      41 |
      42 |       expect(response.body).toHaveProperty("success", true);
      43 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:40:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/holdings - should return portfolio holdings

    expected 200 "OK", got 401 "Unauthorized"

      48 |         .get("/api/portfolio/holdings")
      49 |         .set(auth)
    > 50 |         .expect(200);
         |          ^
      51 |
      52 |       expect(response.body).toHaveProperty("success", true);
      53 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:50:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/value - should return portfolio value data

    expected 200 "OK", got 401 "Unauthorized"

      61 |         .get("/api/portfolio/value")
      62 |         .set(auth)
    > 63 |         .expect(200);
         |          ^
      64 |
      65 |       expect(response.body).toHaveProperty("success", true);
      66 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:63:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/allocation - should return portfolio allocation

    expected 200 "OK", got 401 "Unauthorized"

      71 |         .get("/api/portfolio/allocation")
      72 |         .set(auth)
    > 73 |         .expect(200);
         |          ^
      74 |
      75 |       expect(response.body).toHaveProperty("success", true);
      76 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:73:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/allocations - should return portfolio allocations

    expected 200 "OK", got 401 "Unauthorized"

      81 |         .get("/api/portfolio/allocations")
      82 |         .set(auth)
    > 83 |         .expect(200);
         |          ^
      84 |
      85 |       expect(response.body).toHaveProperty("success", true);
      86 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:83:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Analytics and Analysis APIs › GET /api/portfolio/analytics - should return portfolio analytics

    expected 200 "OK", got 401 "Unauthorized"

      94 |         .get("/api/portfolio/analytics")
      95 |         .set(auth)
    > 96 |         .expect(200);
         |          ^
      97 |
      98 |       expect(response.body).toHaveProperty("success", true);
      99 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:96:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Performance and Returns APIs › GET /api/portfolio/returns - should return portfolio returns

    expected 200 "OK", got 401 "Unauthorized"

      107 |         .get("/api/portfolio/returns")
      108 |         .set(auth)
    > 109 |         .expect(200);
          |          ^
      110 |
      111 |       expect(response.body).toHaveProperty("success", true);
      112 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:109:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Performance and Returns APIs › GET /api/portfolio/benchmark - should return benchmark comparison

    expected 200 "OK", got 401 "Unauthorized"

      117 |         .get("/api/portfolio/benchmark")
      118 |         .set(auth)
    > 119 |         .expect(200);
          |          ^
      120 |
      121 |       expect(response.body).toHaveProperty("success", true);
      122 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:119:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk - should return risk assessment

    expected 200 "OK", got 401 "Unauthorized"

      130 |         .get("/api/portfolio/risk")
      131 |         .set(auth)
    > 132 |         .expect(200);
          |          ^
      133 |
      134 |       expect(response.body).toHaveProperty("success", true);
      135 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:132:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk-analysis - should return risk analysis

    expected 200 "OK", got 401 "Unauthorized"

      140 |         .get("/api/portfolio/risk-analysis")
      141 |         .set(auth)
    > 142 |         .expect(200);
          |          ^
      143 |
      144 |       expect(response.body).toHaveProperty("success", true);
      145 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:142:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/analysis - should return detailed risk analysis

    expected 200 "OK", got 401 "Unauthorized"

      150 |         .get("/api/portfolio/risk/analysis")
      151 |         .set(auth)
    > 152 |         .expect(200);
          |          ^
      153 |
      154 |       expect(response.body).toHaveProperty("success", true);
      155 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:152:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/var - should return VaR analysis

    expected 200 "OK", got 401 "Unauthorized"

      160 |         .get("/api/portfolio/risk/var")
      161 |         .set(auth)
    > 162 |         .expect(200);
          |          ^
      163 |
      164 |       expect(response.body).toHaveProperty("success", true);
      165 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:162:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/stress-test - should return stress test results

    expected 200 "OK", got 401 "Unauthorized"

      170 |         .get("/api/portfolio/risk/stress-test")
      171 |         .set(auth)
    > 172 |         .expect(200);
          |          ^
      173 |
      174 |       expect(response.body).toHaveProperty("success", true);
      175 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:172:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/concentration - should return concentration risk

    expected 200 "OK", got 401 "Unauthorized"

      180 |         .get("/api/portfolio/risk/concentration")
      181 |         .set(auth)
    > 182 |         .expect(200);
          |          ^
      183 |
      184 |       expect(response.body).toHaveProperty("success", true);
      185 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:182:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/rebalance - should return rebalance recommendations

    expected 200 "OK", got 401 "Unauthorized"

      193 |         .get("/api/portfolio/rebalance")
      194 |         .set(auth)
    > 195 |         .expect(200);
          |          ^
      196 |
      197 |       expect(response.body).toHaveProperty("success", true);
      198 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:195:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/optimization - should return optimization suggestions

    expected 200 "OK", got 401 "Unauthorized"

      203 |         .get("/api/portfolio/optimization")
      204 |         .set(auth)
    > 205 |         .expect(200);
          |          ^
      206 |
      207 |       expect(response.body).toHaveProperty("success", true);
      208 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:205:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/watchlist - should return portfolio watchlist

    expected 200 "OK", got 401 "Unauthorized"

      213 |         .get("/api/portfolio/watchlist")
      214 |         .set(auth)
    > 215 |         .expect(200);
          |          ^
      216 |
      217 |       expect(response.body).toHaveProperty("success", true);
      218 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:215:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/transactions - should return portfolio transactions

    expected 200 "OK", got 401 "Unauthorized"

      223 |         .get("/api/portfolio/transactions")
      224 |         .set(auth)
    > 225 |         .expect(200);
          |          ^
      226 |
      227 |       expect(response.body).toHaveProperty("success", true);
      228 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:225:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Broker Integration APIs › GET /api/portfolio/api-keys - should return API keys status

    expected 200 "OK", got 401 "Unauthorized"

      236 |         .get("/api/portfolio/api-keys")
      237 |         .set(auth)
    > 238 |         .expect(200);
          |          ^
      239 |
      240 |       expect(response.body).toHaveProperty("success", true);
      241 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:238:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Broker Integration APIs › POST /api/portfolio/api-keys - should handle API key creation

    expected 200 "OK", got 401 "Unauthorized"

      251 |           apiSecret: "test-secret",
      252 |         })
    > 253 |         .expect(200);
          |          ^
      254 |
      255 |       expect(response.body).toHaveProperty("success", true);
      256 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:253:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Health and System APIs › GET /api/portfolio/health - should return portfolio service health

    expected 200 "OK", got 401 "Unauthorized"

      263 |         .get("/api/portfolio/health")
      264 |         .set(auth)
    > 265 |         .expect(200);
          |          ^
      266 |
      267 |       expect(response.body).toHaveProperty("success", true);
      268 |       expect(response.body).toHaveProperty("status", "healthy");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:265:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › should handle invalid endpoints gracefully

    expected 404 "Not Found", got 401 "Unauthorized"

      292 |         .get("/api/portfolio/invalid-endpoint")
      293 |         .set(auth)
    > 294 |         .expect(404);
          |          ^
      295 |     });
      296 |
      297 |     test("should handle invalid user IDs gracefully", async () => {

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:294:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › should handle invalid user IDs gracefully

    expected 200 "OK", got 401 "Unauthorized"

      299 |         .get("/api/portfolio/invalid-user-id/holdings")
      300 |         .set(auth)
    > 301 |         .expect(200);
          |          ^
      302 |
      303 |       expect(response.body).toHaveProperty("success", true);
      304 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:301:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › DELETE /api/portfolio/api-keys/test-broker - should handle API key deletion

    expected 200 "OK", got 401 "Unauthorized"

      308 |         .delete("/api/portfolio/api-keys/test-broker")
      309 |         .set(auth)
    > 310 |         .expect(200);
          |          ^
      311 |
      312 |       expect(response.body).toHaveProperty("success", true);
      313 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:310:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › GET /api/portfolio/data - should redirect to holdings endpoint

    expected 302 "Found", got 401 "Unauthorized"

      317 |         .get("/api/portfolio/data")
      318 |         .set(auth)
    > 319 |         .expect(302);
          |          ^
      320 |
      321 |       // Verify that the redirect location contains the holdings endpoint
      322 |       expect(response.headers.location).toMatch(/\/holdings/);

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:319:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/unit/services/aiStrategyGenerator.test.js
  AIStrategyGenerator Service
    Constructor and Initialization
      ○ skipped should initialize with default configuration
      ○ skipped should have predefined asset type patterns
      ○ skipped should have strategy templates
    generateCorrelationId
      ○ skipped should generate unique correlation IDs
    generateFromNaturalLanguage
      ○ skipped should generate strategy with AI when enabled
      ○ skipped should fallback to templates when AI fails
      ○ skipped should handle errors gracefully
    generateWithClaude
      ○ skipped should attempt Claude generation but fail due to configuration
      ○ skipped should handle Claude configuration errors
    generateWithTemplates
      ○ skipped should generate momentum strategy from template
      ○ skipped should generate mean reversion strategy from template
      ○ skipped should generate breakout strategy from template
      ○ skipped should default to momentum strategy for unrecognized prompts
      ○ skipped should handle empty symbols gracefully
    parseIntent
      ○ skipped should parse buy intent correctly
      ○ skipped should parse sell intent correctly
      ○ skipped should parse strategy types correctly
      ○ skipped should identify indicators from prompt
      ○ skipped should identify timeframes from prompt
      ○ skipped should default to unknown action for ambiguous prompts
    generateStrategyCode
      ○ skipped should generate code for momentum strategy
      ○ skipped should generate code for mean reversion strategy
      ○ skipped should generate code for breakout strategy
      ○ skipped should handle multiple symbols in generated code
      ○ skipped should include proper error handling in generated code
    validateStrategy
      ○ skipped should validate complete strategy successfully
      ○ skipped should identify missing required fields
      ○ skipped should validate code syntax
      ○ skipped should validate parameter types
      ○ skipped should provide validation warnings for potential issues
    Template Methods
      ○ skipped should return momentum template code
      ○ skipped should return mean reversion template code
      ○ skipped should return breakout template code
    AI Helper Methods
      ○ skipped should build system prompt
      ○ skipped should build user prompt
      ○ skipped should generate AI metadata
      ○ skipped should generate AI visual config
    Error Handling and Edge Cases
      ○ skipped should handle null or undefined prompts
      ○ skipped should handle very long prompts
      ○ skipped should handle special characters in prompts
      ○ skipped should handle empty symbols array
      ○ skipped should handle very large symbols array
      ○ skipped should handle invalid options gracefully
      ○ skipped should maintain correlation ID consistency
      ○ skipped should handle concurrent strategy generation requests
    Integration with Logger
      ✓ should log strategy generation attempts (6 ms)
      ✕ should log errors appropriately (1 ms)
      ✓ should log warnings for fallback scenarios

  ● AIStrategyGenerator Service › Integration with Logger › should log errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "Strategy generation failed", ObjectContaining {"error": Any<Error>}

    Number of calls: 0

      725 |       await generator.generateFromNaturalLanguage("test strategy");
      726 |
    > 727 |       expect(mockLogger.error).toHaveBeenCalledWith(
          |                                ^
      728 |         "Strategy generation failed",
      729 |         expect.objectContaining({
      730 |           error: expect.any(Error),

      at Object.toHaveBeenCalledWith (tests/unit/services/aiStrategyGenerator.test.js:727:32)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.error
    Failed to add connection : Error: Connection ID is required
        at LiveDataManager._addConnectionInternal (/home/stocks/algo/webapp/lambda/utils/liveDataManager.js:303:15)
        at LiveDataManager._addConnectionInternal [as addConnection] (/home/stocks/algo/webapp/lambda/utils/liveDataManager.js:292:17)
        at Object.addConnection (/home/stocks/algo/webapp/lambda/tests/integration/utils/liveDataManager.test.js:530:38)
        at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
        at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)

      370 |       };
      371 |     } catch (error) {
    > 372 |       console.error(`Failed to add connection ${connectionId}:`, error);
          |               ^
      373 |       return {
      374 |         success: false,
      375 |         error: error.message,

      at LiveDataManager.error [as _addConnectionInternal] (utils/liveDataManager.js:372:15)
      at LiveDataManager._addConnectionInternal [as addConnection] (utils/liveDataManager.js:292:17)
      at Object.addConnection (tests/integration/utils/liveDataManager.test.js:530:38)

  console.error
    Failed to add subscription for symbol , user : Error: Symbol, provider, connectionId, and userId are required
        at LiveDataManager.addSubscription (/home/stocks/algo/webapp/lambda/utils/liveDataManager.js:547:15)
        at Object.addSubscription (/home/stocks/algo/webapp/lambda/tests/integration/utils/liveDataManager.test.js:538:38)
        at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
        at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)

      598 |       };
      599 |     } catch (error) {
    > 600 |       console.error(
          |               ^
      601 |         `Failed to add subscription for symbol ${symbol}, user ${userId}:`,
      602 |         error
      603 |       );

      at LiveDataManager.error [as addSubscription] (utils/liveDataManager.js:600:15)
      at Object.addSubscription (tests/integration/utils/liveDataManager.test.js:538:38)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/liveDataManager.test.js
  Live Data Manager Integration Tests
    Dashboard Status Management
      ✓ should get comprehensive dashboard status (2 ms)
      ✓ should get provider status by ID
      ✓ should handle non-existent provider
    Connection Management
      ✓ should add new connection successfully (1 ms)
      ✕ should get connection status
      ✕ should remove connection successfully (1 ms)
      ✓ should handle connection limit enforcement
    Subscription Management
      ✓ should add subscription successfully (1 ms)
      ✓ should get user subscriptions
      ✓ should remove subscription successfully (1 ms)
      ✓ should remove all subscriber subscriptions
    Provider Usage Tracking
      ✓ should track provider usage successfully
      ✓ should handle invalid provider usage tracking
    Performance Metrics
      ✓ should track latency successfully (1 ms)
      ✓ should calculate average latency
      ✓ should track errors successfully
      ✓ should calculate global performance metrics (1 ms)
    Rate Limiting
      ✓ should set rate limit for provider
      ✓ should handle requests within rate limit (1 ms)
      ✓ should enforce rate limits
      ✓ should reset rate limit counters
    Alert Generation
      ✓ should generate alerts for system limits (4 ms)
      ✓ should generate optimization recommendations (1 ms)
    Provider Status Updates
      ✓ should update provider status
      ✓ should emit status change events
    Analytics and Reporting
      ✓ should generate analytics report (1 ms)
      ✓ should generate performance report
      ✓ should subscribe users to multiple symbols (1 ms)
    Error Handling
      ✓ should handle invalid connection parameters (13 ms)
      ✓ should handle invalid subscription parameters (2 ms)
      ✓ should return empty arrays for invalid user queries
      ✓ should handle tracking for non-existent providers

  ● Live Data Manager Integration Tests › Connection Management › should get connection status

    TypeError: Cannot read properties of null (reading 'connectionId')

      84 |
      85 |       expect(status).toBeDefined();
    > 86 |       expect(status.connectionId).toBe(connectionId);
         |                     ^
      87 |       expect(status.provider).toBe("alpaca");
      88 |       expect(status.symbols).toBeDefined();
      89 |       expect(status.status).toBe("active");

      at Object.connectionId (tests/integration/utils/liveDataManager.test.js:86:21)

  ● Live Data Manager Integration Tests › Connection Management › should remove connection successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      100 |
      101 |       expect(result).toBeDefined();
    > 102 |       expect(result.success).toBe(true);
          |                              ^
      103 |       expect(result.connectionId).toBe(connectionId);
      104 |       expect(result.removedAt).toBeDefined();
      105 |       expect(result.provider).toBe("alpaca");

      at Object.toBe (tests/integration/utils/liveDataManager.test.js:102:30)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/schemaValidator.test.js
  Schema Validator Integration Tests
    Stock Data Validation
      ✓ should validate stock quote data (1 ms)
      ✕ should reject invalid stock data (1 ms)
      ✕ should validate portfolio data
    Trading Order Validation
      ✕ should validate buy order (1 ms)
      ✕ should validate limit order with price
      ✕ should reject invalid trading orders
    User Data Validation
      ✕ should validate user registration data
      ✕ should validate API key configuration
    Market Data Validation
      ✕ should validate technical indicators
      ✕ should validate earnings data
    Real-time Data Validation
      ✕ should validate WebSocket message format
      ✕ should validate streaming data batch (1 ms)
    Custom Schema Validation
      ✕ should validate with custom schema
      ✕ should register and use persistent custom schemas
    Data Sanitization
      ✕ should sanitize and transform data (1 ms)
      ✕ should handle SQL injection attempts
    Performance and Scalability
      ✓ should validate large datasets efficiently (9 ms)
      ✕ should cache compiled schemas for performance
    Error Handling and Edge Cases
      ✕ should handle malformed data gracefully (1 ms)
      ✕ should handle circular references
      ✕ should handle very large numbers
    Integration with Database
      ✕ should validate data before database insertion (1 ms)
      ✕ should handle database constraint violations
    Multi-language Support
      ✕ should support localized error messages

  ● Schema Validator Integration Tests › Stock Data Validation › should reject invalid stock data

    expect(received).toContain(expected) // indexOf

    Expected value: "symbol"
    Received array: [undefined, undefined, undefined]

      55 |
      56 |       const errorFields = validation.errors.map((err) => err.field);
    > 57 |       expect(errorFields).toContain("symbol");
         |                           ^
      58 |       expect(errorFields).toContain("price");
      59 |       expect(errorFields).toContain("volume");
      60 |       expect(errorFields).toContain("timestamp");

      at Object.toContain (tests/integration/utils/schemaValidator.test.js:57:27)

  ● Schema Validator Integration Tests › Stock Data Validation › should validate portfolio data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      85 |       const validation = schemaValidator.validate(validPortfolio, "portfolio");
      86 |
    > 87 |       expect(validation.isValid).toBe(true);
         |                                  ^
      88 |       expect(validation.errors).toEqual([]);
      89 |       expect(validation.sanitizedData.holdings.length).toBe(2);
      90 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:87:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should validate buy order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      105 |       const validation = schemaValidator.validate(buyOrder, "tradingOrder");
      106 |
    > 107 |       expect(validation.isValid).toBe(true);
          |                                  ^
      108 |       expect(validation.sanitizedData.side).toBe("buy");
      109 |       expect(validation.sanitizedData.type).toBe("market");
      110 |       expect(validation.sanitizedData.quantity).toBe(100);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:107:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should validate limit order with price

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      125 |       const validation = schemaValidator.validate(limitOrder, "tradingOrder");
      126 |
    > 127 |       expect(validation.isValid).toBe(true);
          |                                  ^
      128 |       expect(validation.sanitizedData.type).toBe("limit");
      129 |       expect(validation.sanitizedData.limitPrice).toBe(155.0);
      130 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:127:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should reject invalid trading orders

    expect(received).toContain(expected) // indexOf

    Expected value: "INVALID_USER_ID"
    Received array: [undefined, undefined, undefined, undefined, undefined]

      146 |
      147 |       const errorCodes = validation.errors.map((err) => err.code);
    > 148 |       expect(errorCodes).toContain("INVALID_USER_ID");
          |                          ^
      149 |       expect(errorCodes).toContain("INVALID_SYMBOL");
      150 |       expect(errorCodes).toContain("INVALID_SIDE");
      151 |       expect(errorCodes).toContain("INVALID_QUANTITY");

      at Object.toContain (tests/integration/utils/schemaValidator.test.js:148:26)

  ● Schema Validator Integration Tests › User Data Validation › should validate user registration data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      168 |       const validation = schemaValidator.validate(userData, "userRegistration");
      169 |
    > 170 |       expect(validation.isValid).toBe(true);
          |                                  ^
      171 |       expect(validation.sanitizedData.email).toBe("test@example.com");
      172 |       expect(validation.sanitizedData.country).toBe("US");
      173 |       // Password should be excluded from sanitized data for security

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:170:34)

  ● Schema Validator Integration Tests › User Data Validation › should validate API key configuration

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      189 |       const validation = schemaValidator.validate(apiKeyConfig, "apiKeyConfig");
      190 |
    > 191 |       expect(validation.isValid).toBe(true);
          |                                  ^
      192 |       expect(validation.sanitizedData.provider).toBe("alpaca");
      193 |       expect(validation.sanitizedData.environment).toBe("paper");
      194 |       expect(Array.isArray(validation.sanitizedData.permissions)).toBe(true);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:191:34)

  ● Schema Validator Integration Tests › Market Data Validation › should validate technical indicators

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      223 |       );
      224 |
    > 225 |       expect(validation.isValid).toBe(true);
          |                                  ^
      226 |       expect(validation.sanitizedData.indicators.rsi).toBe(65.5);
      227 |       expect(validation.sanitizedData.indicators.macd.macd).toBe(1.25);
      228 |       expect(validation.sanitizedData.indicators.bollinger.upper).toBe(155.0);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:225:34)

  ● Schema Validator Integration Tests › Market Data Validation › should validate earnings data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      249 |       const validation = schemaValidator.validate(earningsData, "earningsData");
      250 |
    > 251 |       expect(validation.isValid).toBe(true);
          |                                  ^
      252 |       expect(validation.sanitizedData.quarter).toBe("Q1");
      253 |       expect(validation.sanitizedData.year).toBe(2023);
      254 |       expect(validation.sanitizedData.surprise.epsPercent).toBe(4.83);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:251:34)

  ● Schema Validator Integration Tests › Real-time Data Validation › should validate WebSocket message format

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      276 |       );
      277 |
    > 278 |       expect(validation.isValid).toBe(true);
          |                                  ^
      279 |       expect(validation.sanitizedData.type).toBe("quote");
      280 |       expect(validation.sanitizedData.symbol).toBe("AAPL");
      281 |       expect(validation.sanitizedData.data.price).toBe(150.25);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:278:34)

  ● Schema Validator Integration Tests › Real-time Data Validation › should validate streaming data batch

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      312 |       );
      313 |
    > 314 |       expect(validation.isValid).toBe(true);
          |                                  ^
      315 |       expect(validation.sanitizedData.messages.length).toBe(2);
      316 |       expect(validation.sanitizedData.source).toBe("alpaca");
      317 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:314:34)

  ● Schema Validator Integration Tests › Custom Schema Validation › should validate with custom schema

    TypeError: schemaValidator.validateWithCustomSchema is not a function

      340 |       };
      341 |
    > 342 |       const validation = schemaValidator.validateWithCustomSchema(
          |                                          ^
      343 |         testData,
      344 |         customSchema
      345 |       );

      at Object.validateWithCustomSchema (tests/integration/utils/schemaValidator.test.js:342:42)

  ● Schema Validator Integration Tests › Custom Schema Validation › should register and use persistent custom schemas

    TypeError: schemaValidator.registerSchema is not a function

      362 |
      363 |       // Register schema
    > 364 |       schemaValidator.registerSchema(schemaName, schema);
          |                       ^
      365 |
      366 |       // Use registered schema
      367 |       const testData = { id: "test_123", value: 456 };

      at Object.registerSchema (tests/integration/utils/schemaValidator.test.js:364:23)

  ● Schema Validator Integration Tests › Data Sanitization › should sanitize and transform data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      389 |       });
      390 |
    > 391 |       expect(validation.isValid).toBe(true);
          |                                  ^
      392 |       expect(validation.sanitizedData.symbol).toBe("AAPL");
      393 |       expect(validation.sanitizedData.price).toBe(150.25);
      394 |       expect(validation.sanitizedData.description).not.toContain("<script>");

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:391:34)

  ● Schema Validator Integration Tests › Data Sanitization › should handle SQL injection attempts

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      408 |       });
      409 |
    > 410 |       expect(validation.sanitized).toBe(true);
          |                                    ^
      411 |       expect(validation.sanitizedData.symbol).not.toContain("DROP TABLE");
      412 |       expect(validation.sanitizedData.userId).not.toContain("OR '1'='1");
      413 |       expect(validation.sanitizedData.description).not.toContain("DELETE FROM");

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:410:36)

  ● Schema Validator Integration Tests › Performance and Scalability › should cache compiled schemas for performance

    expect(received).toBeLessThan(expected)

    Expected: < 0
    Received:   0

      452 |       expect(validation1.isValid).toBe(true);
      453 |       expect(validation2.isValid).toBe(true);
    > 454 |       expect(duration2).toBeLessThan(duration1); // Cached should be faster
          |                         ^
      455 |     });
      456 |   });
      457 |

      at Object.toBeLessThan (tests/integration/utils/schemaValidator.test.js:454:25)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle malformed data gracefully

    TypeError: Cannot read properties of null (reading 'symbol')

      732 |     // Check required fields
      733 |     for (const requiredField of schema.required) {
    > 734 |       if (data[requiredField] === undefined || data[requiredField] === null) {
          |               ^
      735 |         errors.push(`Required field "${requiredField}" is missing`);
      736 |       }
      737 |     }

      at SchemaValidator.validate (utils/schemaValidator.js:734:15)
      at Object.validate (utils/schemaValidator.js:1576:51)
      at validate (tests/integration/utils/schemaValidator.test.js:463:44)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/schemaValidator.test.js:462:21)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle circular references

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      477 |       expect(
      478 |         validation.errors.some((err) => err.code === "CIRCULAR_REFERENCE")
    > 479 |       ).toBe(true);
          |         ^
      480 |     });
      481 |
      482 |     test("should handle very large numbers", () => {

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:479:9)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle very large numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      496 |       expect(
      497 |         validation.errors.some((err) => err.code === "INVALID_NUMBER")
    > 498 |       ).toBe(true);
          |         ^
      499 |     });
      500 |   });
      501 |

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:498:9)

  ● Schema Validator Integration Tests › Integration with Database › should validate data before database insertion

    TypeError: schemaValidator.validateForDatabase is not a function

      509 |       };
      510 |
    > 511 |       const validation = await schemaValidator.validateForDatabase(
          |                                                ^
      512 |         stockData,
      513 |         "stock_quotes"
      514 |       );

      at Object.validateForDatabase (tests/integration/utils/schemaValidator.test.js:511:48)

  ● Schema Validator Integration Tests › Integration with Database › should handle database constraint violations

    TypeError: schemaValidator.validateForDatabase is not a function

      527 |       };
      528 |
    > 529 |       const validation = await schemaValidator.validateForDatabase(
          |                                                ^
      530 |         duplicateData,
      531 |         "stock_quotes"
      532 |       );

      at Object.validateForDatabase (tests/integration/utils/schemaValidator.test.js:529:48)

  ● Schema Validator Integration Tests › Multi-language Support › should support localized error messages

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not undefined

      556 |       expect(validationEn.isValid).toBe(false);
      557 |       expect(validationEs.isValid).toBe(false);
    > 558 |       expect(validationEn.errors[0].message).not.toBe(
          |                                                  ^
      559 |         validationEs.errors[0].message
      560 |       );
      561 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:558:50)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.error
    Alpaca account fetch error: API Error

      84 |       };
      85 |     } catch (error) {
    > 86 |       console.error("Alpaca account fetch error:", error.message);
         |               ^
      87 |       throw new Error(`Failed to fetch account information: ${error.message}`);
      88 |     }
      89 |   }

      at AlpacaService.error [as getAccount] (utils/alpacaService.js:86:15)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:149:7)

  console.error
    Error fetching position: Cannot read properties of undefined (reading 'find')

      819 |       };
      820 |     } catch (error) {
    > 821 |       console.error("Error fetching position:", error.message);
          |               ^
      822 |       throw new Error(
      823 |         `Failed to fetch position for ${symbol}: ${error.message}`
      824 |       );

      at AlpacaService.error [as getPosition] (utils/alpacaService.js:821:15)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:218:24)

  console.error
    Alpaca order creation error: Quantity must be a positive number

      738 |       };
      739 |     } catch (error) {
    > 740 |       console.error("Alpaca order creation error:", error.message);
          |               ^
      741 |       throw new Error(`Failed to create order: ${error.message}`);
      742 |     }
      743 |   }

      at AlpacaService.error [as createOrder] (utils/alpacaService.js:740:15)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:238:41)

  console.error
    Alpaca order creation error: Quantity must be a positive number

      738 |       };
      739 |     } catch (error) {
    > 740 |       console.error("Alpaca order creation error:", error.message);
          |               ^
      741 |       throw new Error(`Failed to create order: ${error.message}`);
      742 |     }
      743 |   }

      at AlpacaService.error [as createOrder] (utils/alpacaService.js:740:15)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:267:41)

  console.log
    Fetching orders from Alpaca

      at AlpacaService.log [as getOrders] (utils/alpacaService.js:748:15)

  console.log
    Canceling order order-123 on Alpaca

      at AlpacaService.log [as cancelOrder] (utils/alpacaService.js:776:15)

  console.error
    Alpaca order creation error: Quantity must be a positive number

      738 |       };
      739 |     } catch (error) {
    > 740 |       console.error("Alpaca order creation error:", error.message);
          |               ^
      741 |       throw new Error(`Failed to create order: ${error.message}`);
      742 |     }
      743 |   }

      at AlpacaService.error [as createOrder] (utils/alpacaService.js:740:15)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:311:23)

  console.log
    📊 Fetching bars for AAPL from Alpaca { timeframe: '1Day', start: '2023-01-01', limit: 100 }

      at AlpacaService.log [as getBars] (utils/alpacaService.js:538:15)

  console.log
    ✅ Bars fetched for AAPL: 1 bars

      at AlpacaService.log [as getBars] (utils/alpacaService.js:559:15)

  console.error
    Alpaca account fetch error: Network error

      84 |       };
      85 |     } catch (error) {
    > 86 |       console.error("Alpaca account fetch error:", error.message);
         |               ^
      87 |       throw new Error(`Failed to fetch account information: ${error.message}`);
      88 |     }
      89 |   }

      at AlpacaService.error [as getAccount] (utils/alpacaService.js:86:15)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:466:7)

  console.error
    Alpaca account fetch error: Rate limit exceeded

      84 |       };
      85 |     } catch (error) {
    > 86 |       console.error("Alpaca account fetch error:", error.message);
         |               ^
      87 |       throw new Error(`Failed to fetch account information: ${error.message}`);
      88 |     }
      89 |   }

      at AlpacaService.error [as getAccount] (utils/alpacaService.js:86:15)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:474:7)

  console.error
    Alpaca account fetch error: Invalid API credentials

      84 |       };
      85 |     } catch (error) {
    > 86 |       console.error("Alpaca account fetch error:", error.message);
         |               ^
      87 |       throw new Error(`Failed to fetch account information: ${error.message}`);
      88 |     }
      89 |   }

      at AlpacaService.error [as getAccount] (utils/alpacaService.js:86:15)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:484:7)

  console.error
    Alpaca order creation error: Quantity must be a positive number

      738 |       };
      739 |     } catch (error) {
    > 740 |       console.error("Alpaca order creation error:", error.message);
          |               ^
      741 |       throw new Error(`Failed to create order: ${error.message}`);
      742 |     }
      743 |   }

      at AlpacaService.error [as createOrder] (utils/alpacaService.js:740:15)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:495:23)

  console.error
    Alpaca order creation error: Quantity must be a positive number

      738 |       };
      739 |     } catch (error) {
    > 740 |       console.error("Alpaca order creation error:", error.message);
          |               ^
      741 |       throw new Error(`Failed to create order: ${error.message}`);
      742 |     }
      743 |   }

      at AlpacaService.error [as createOrder] (utils/alpacaService.js:740:15)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:510:23)

  console.log
    Fetching orders from Alpaca

      at AlpacaService.log [as getOrders] (utils/alpacaService.js:748:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/services/alpacaService.test.js
  Alpaca Service Integration Tests
    Service Initialization
      ✓ should initialize with valid API credentials
      ✓ should throw error with missing credentials (16 ms)
      ✓ should configure for live trading when specified
    Rate Limiting
      ✓ should track request times for rate limiting (1 ms)
      ✓ should throw error when rate limit exceeded
      ✓ should clean up old request times
    Account Operations
      ✕ should fetch account information (2 ms)
      ✓ should handle account fetch errors gracefully (6 ms)
      ✕ should fetch portfolio history (1 ms)
    Position Management
      ✓ should fetch current positions (1 ms)
      ✕ should fetch position for specific symbol (1 ms)
    Order Management
      ✕ should place market buy order (1 ms)
      ✕ should place limit sell order (1 ms)
      ✓ should fetch all orders (5 ms)
      ✕ should cancel specific order (2 ms)
      ✕ should validate order parameters (2 ms)
    Market Data Operations
      ✓ should fetch asset information (1 ms)
      ✓ should fetch tradable assets
      ✕ should fetch historical bars data (3 ms)
      ✓ should fetch latest trade data
    Watchlist Management
      ✓ should fetch all watchlists
      ✓ should create new watchlist (1 ms)
    Error Handling and Edge Cases
      ✓ should handle network errors gracefully (1 ms)
      ✓ should handle API rate limiting from Alpaca (1 ms)
      ✓ should handle invalid API credentials (1 ms)
      ✕ should handle market closed scenarios (1 ms)
      ✕ should handle insufficient funds (1 ms)
    Performance and Monitoring
      ✓ should track request metrics (1 ms)
      ✓ should handle concurrent requests properly (1 ms)

  ● Alpaca Service Integration Tests › Account Operations › should fetch account information

    expect(received).toEqual(expected) // deep equality

    - Expected  -  4
    + Received  + 21

      Object {
    -   "buying_power": "20000.00",
    -   "cash": "10000.00",
    -   "id": "test-account-id",
    -   "portfolio_value": "12000.00",
    +   "accountBlocked": undefined,
    +   "accountId": "test-account-id",
    +   "buyingPower": 20000,
    +   "cash": 10000,
    +   "createdAt": undefined,
    +   "currency": undefined,
    +   "dayTradeCount": NaN,
    +   "dayTradingBuyingPower": NaN,
    +   "environment": "paper",
    +   "equity": NaN,
    +   "initialMargin": NaN,
    +   "lastEquity": NaN,
    +   "longMarketValue": NaN,
    +   "maintenanceMargin": NaN,
    +   "multiplier": NaN,
    +   "patternDayTrader": undefined,
    +   "portfolioValue": 12000,
    +   "regtBuyingPower": NaN,
    +   "shortMarketValue": NaN,
        "status": "ACTIVE",
    +   "tradingBlocked": undefined,
    +   "transfersBlocked": undefined,
      }

      141 |
      142 |       expect(mockClient.getAccount).toHaveBeenCalledTimes(1);
    > 143 |       expect(account).toEqual(mockAccount);
          |                       ^
      144 |     });
      145 |
      146 |     test("should handle account fetch errors gracefully", async () => {

      at Object.toEqual (tests/integration/services/alpacaService.test.js:143:23)

  ● Alpaca Service Integration Tests › Account Operations › should fetch portfolio history

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    +   "extended_hours": true,
    +   "period": Object {
          "period": "1D",
          "timeframe": "1Min",
    +   },
    +   "timeframe": "1Day",
      },

    Number of calls: 1

      165 |       });
      166 |
    > 167 |       expect(mockClient.getPortfolioHistory).toHaveBeenCalledWith({
          |                                              ^
      168 |         period: "1D",
      169 |         timeframe: "1Min",
      170 |       });

      at Object.toHaveBeenCalledWith (tests/integration/services/alpacaService.test.js:167:46)

  ● Alpaca Service Integration Tests › Position Management › should fetch position for specific symbol

    Failed to fetch position for AAPL: Cannot read properties of undefined (reading 'find')

      820 |     } catch (error) {
      821 |       console.error("Error fetching position:", error.message);
    > 822 |       throw new Error(
          |             ^
      823 |         `Failed to fetch position for ${symbol}: ${error.message}`
      824 |       );
      825 |     }

      at AlpacaService.getPosition (utils/alpacaService.js:822:13)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:218:24)

  ● Alpaca Service Integration Tests › Order Management › should place market buy order

    Failed to create order: Quantity must be a positive number

      739 |     } catch (error) {
      740 |       console.error("Alpaca order creation error:", error.message);
    > 741 |       throw new Error(`Failed to create order: ${error.message}`);
          |             ^
      742 |     }
      743 |   }
      744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:238:41)

  ● Alpaca Service Integration Tests › Order Management › should place limit sell order

    Failed to create order: Quantity must be a positive number

      739 |     } catch (error) {
      740 |       console.error("Alpaca order creation error:", error.message);
    > 741 |       throw new Error(`Failed to create order: ${error.message}`);
          |             ^
      742 |     }
      743 |   }
      744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:267:41)

  ● Alpaca Service Integration Tests › Order Management › should cancel specific order

    expect(received).toBe(expected) // Object.is equality

    Expected: "order-123"
    Received: undefined

      303 |
      304 |       expect(mockClient.cancelOrder).toHaveBeenCalledWith("order-123");
    > 305 |       expect(result.id).toBe("order-123");
          |                         ^
      306 |     });
      307 |
      308 |     test("should validate order parameters", async () => {

      at Object.toBe (tests/integration/services/alpacaService.test.js:305:25)

  ● Alpaca Service Integration Tests › Order Management › should validate order parameters

    expect(received).rejects.toThrow(expected)

    Expected substring: "Symbol is required"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:311:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:317:17)

  ● Alpaca Service Integration Tests › Market Data Operations › should fetch historical bars data

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      "AAPL",
      Object {
    +   "asof": null,
        "end": "2023-01-02",
    +   "feed": null,
    +   "limit": 100,
    +   "page_token": null,
        "start": "2023-01-01",
        "timeframe": "1Day",
      },

    Number of calls: 1

      396 |       });
      397 |
    > 398 |       expect(mockClient.getBars).toHaveBeenCalledWith("AAPL", {
          |                                  ^
      399 |         start: "2023-01-01",
      400 |         end: "2023-01-02",
      401 |         timeframe: "1Day",

      at Object.toHaveBeenCalledWith (tests/integration/services/alpacaService.test.js:398:34)

  ● Alpaca Service Integration Tests › Error Handling and Edge Cases › should handle market closed scenarios

    expect(received).rejects.toThrow(expected)

    Expected substring: "Market is closed"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:495:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:501:17)

  ● Alpaca Service Integration Tests › Error Handling and Edge Cases › should handle insufficient funds

    expect(received).rejects.toThrow(expected)

    Expected substring: "Insufficient buying power"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:510:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:516:17)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.error
    Database query error: {
      error: 'column "cost_basis" of relation "portfolio_holdings" does not exist',
      query: '\n' +
        '        INSERT INTO portfolio_holdings (user_id, symbol, quantity, average_cost, current_price, mar...',
      params: '7 parameters',
      code: '42703'
    }

      1378 |     return result;
      1379 |   } catch (error) {
    > 1380 |     console.error("Database query error:", {
           |             ^
      1381 |       error: error.message,
      1382 |       query: text.slice(0, 100) + (text.length > 100 ? "..." : ""),
      1383 |       params: params?.length ? `${params.length} parameters` : "no parameters",

      at error (utils/database.js:1380:13)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/riskEngine.test.js
  Risk Engine Integration Tests
    Portfolio Risk Assessment with Database Integration
      ✕ should calculate portfolio-wide risk metrics from database
      ✕ should identify concentration risk
      ✕ should calculate sector allocation risk
    Historical Volatility Analysis
      ✕ should calculate volatility from historical price data
      ✕ should handle insufficient data gracefully
      ✕ should calculate beta relative to market
    Value at Risk (VaR) Calculations
      ✕ should calculate portfolio VaR using historical method
      ✕ should calculate VaR for different confidence levels
      ✕ should calculate parametric VaR
    Position Sizing and Risk Management
      ✕ should recommend optimal position sizes
      ✕ should validate position size against risk limits
    Correlation and Covariance Analysis
      ✕ should calculate correlation matrix for portfolio
      ✕ should identify highly correlated positions
    Stress Testing and Scenario Analysis
      ✕ should perform market crash stress test
      ✕ should perform custom scenario analysis
    Risk Monitoring and Alerts
      ✕ should monitor portfolio risk limits
      ✕ should generate risk alerts for violations
    Performance and Scalability
      ✕ should handle large portfolios efficiently
      ✕ should maintain accuracy with concurrent calculations
    Error Handling and Edge Cases
      ✕ should handle empty portfolio gracefully
      ✕ should handle database connection errors
      ✕ should handle invalid risk parameters

  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should calculate portfolio-wide risk metrics from database

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should identify concentration risk

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should calculate sector allocation risk

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should calculate volatility from historical price data

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should handle insufficient data gracefully

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should calculate beta relative to market

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate portfolio VaR using historical method

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate VaR for different confidence levels

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate parametric VaR

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Position Sizing and Risk Management › should recommend optimal position sizes

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Position Sizing and Risk Management › should validate position size against risk limits

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Correlation and Covariance Analysis › should calculate correlation matrix for portfolio

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Correlation and Covariance Analysis › should identify highly correlated positions

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Stress Testing and Scenario Analysis › should perform market crash stress test

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Stress Testing and Scenario Analysis › should perform custom scenario analysis

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Risk Monitoring and Alerts › should monitor portfolio risk limits

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Risk Monitoring and Alerts › should generate risk alerts for violations

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Performance and Scalability › should handle large portfolios efficiently

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Performance and Scalability › should maintain accuracy with concurrent calculations

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle empty portfolio gracefully

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle database connection errors

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle invalid risk parameters

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:39:46.708Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error message","correlationId":"cf413818","userId":"test123","operation":"test","severity":"ERROR"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.710Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test warning message","correlationId":"f011dad4","severity":"WARN"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.711Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test info message","correlationId":"af6c5bd7","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.712Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database operation: SELECT * FROM company_profile","correlationId":"d217b564","duration":150,"rows":25,"component":"database","operation":"SELECT * FROM company_profile","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.713Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"API call: GET /api/portfolio","correlationId":"9090a6e7","userId":"test123","component":"api-client","method":"GET","url":"/api/portfolio","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.714Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Authentication event: login_success","correlationId":"e3c2fef2","userId":"test123","ip":"127.0.0.1","component":"auth","event":"login_success","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.715Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Performance: portfolio_calculation completed in 250ms","correlationId":"2a84f759","symbols":10,"userId":"test123","component":"performance","operation":"portfolio_calculation","duration_ms":250,"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.717Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Security event: unauthorized_access_attempt","correlationId":"ec397ee1","ip":"192.168.1.100","endpoint":"/admin","component":"security","event":"unauthorized_access_attempt","severity":"WARN"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":1758634786718,"level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"User action: portfolio_view","correlationId":"0b22047f","symbol":"AAPL","component":"user-action","userId":"test_use...","action":"portfolio_view","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.719Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Portfolio calculation completed","correlationId":"04f20759","userId":"test123","portfolioId":"port456","symbols":["AAPL","GOOGL","MSFT"],"metrics":{"total_value":1250000,"gainLoss":5000,"returnPercent":5},"duration":150,"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.720Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database operation failed","correlationId":"089535f3","error":{"name":"Error","message":"Test database connection error","stack":"Error: Test database connection error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/logger.test.js:295:21)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","code":"DB_CONNECTION_FAILED"},"severity":"ERROR"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.735Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Configuration loaded","correlationId":"d6f8dfe6","component":"config","config":{"appName":"test-app","version":"1.0.0","apiKey":"[REDACTED]"},"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.736Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Application starting","correlationId":"308c3b6a","port":3000,"env":"test","component":"startup","nodeVersion":"v20.19.4","pid":934087,"memory":{"rss":1298780160,"heapTotal":1147768832,"heapUsed":931405624,"external":24086989,"arrayBuffers":20622192},"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.737Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Application shutting down","correlationId":"aef37650","reason":"test_shutdown","component":"shutdown","uptime":31.162805559,"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.738Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Child logger test message","correlationId":"8b9ae21a","requestId":"req_789","userId":"user_xyz","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.739Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Performance: slow_database_query completed in 6000ms","correlationId":"1af687fd","query":"SELECT * FROM large_table","component":"performance","operation":"slow_database_query","duration_ms":6000,"slow_operation":true,"severity":"WARN"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.740Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Performance: fast_api_call completed in 100ms","correlationId":"b32df5ec","endpoint":"/api/health","component":"performance","operation":"fast_api_call","duration_ms":100,"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.741Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test message","correlationId":"2ab1e99a","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.741Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test message","correlationId":"522bc0b5","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.742Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test message","correlationId":"745040f9","severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    {"timestamp":"2025-09-23T13:39:46.748Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Large context test","correlationId":"9acdccc5","data":[{"id":0,"value":"item_0"},{"id":1,"value":"item_1"},{"id":2,"value":"item_2"},{"id":3,"value":"item_3"},{"id":4,"value":"item_4"},{"id":5,"value":"item_5"},{"id":6,"value":"item_6"},{"id":7,"value":"item_7"},{"id":8,"value":"item_8"},{"id":9,"value":"item_9"},{"id":10,"value":"item_10"},{"id":11,"value":"item_11"},{"id":12,"value":"item_12"},{"id":13,"value":"item_13"},{"id":14,"value":"item_14"},{"id":15,"value":"item_15"},{"id":16,"value":"item_16"},{"id":17,"value":"item_17"},{"id":18,"value":"item_18"},{"id":19,"value":"item_19"},{"id":20,"value":"item_20"},{"id":21,"value":"item_21"},{"id":22,"value":"item_22"},{"id":23,"value":"item_23"},{"id":24,"value":"item_24"},{"id":25,"value":"item_25"},{"id":26,"value":"item_26"},{"id":27,"value":"item_27"},{"id":28,"value":"item_28"},{"id":29,"value":"item_29"},{"id":30,"value":"item_30"},{"id":31,"value":"item_31"},{"id":32,"value":"item_32"},{"id":33,"value":"item_33"},{"id":34,"value":"item_34"},{"id":35,"value":"item_35"},{"id":36,"value":"item_36"},{"id":37,"value":"item_37"},{"id":38,"value":"item_38"},{"id":39,"value":"item_39"},{"id":40,"value":"item_40"},{"id":41,"value":"item_41"},{"id":42,"value":"item_42"},{"id":43,"value":"item_43"},{"id":44,"value":"item_44"},{"id":45,"value":"item_45"},{"id":46,"value":"item_46"},{"id":47,"value":"item_47"},{"id":48,"value":"item_48"},{"id":49,"value":"item_49"},{"id":50,"value":"item_50"},{"id":51,"value":"item_51"},{"id":52,"value":"item_52"},{"id":53,"value":"item_53"},{"id":54,"value":"item_54"},{"id":55,"value":"item_55"},{"id":56,"value":"item_56"},{"id":57,"value":"item_57"},{"id":58,"value":"item_58"},{"id":59,"value":"item_59"},{"id":60,"value":"item_60"},{"id":61,"value":"item_61"},{"id":62,"value":"item_62"},{"id":63,"value":"item_63"},{"id":64,"value":"item_64"},{"id":65,"value":"item_65"},{"id":66,"value":"item_66"},{"id":67,"value":"item_67"},{"id":68,"value":"item_68"},{"id":69,"value":"item_69"},{"id":70,"value":"item_70"},{"id":71,"value":"item_71"},{"id":72,"value":"item_72"},{"id":73,"value":"item_73"},{"id":74,"value":"item_74"},{"id":75,"value":"item_75"},{"id":76,"value":"item_76"},{"id":77,"value":"item_77"},{"id":78,"value":"item_78"},{"id":79,"value":"item_79"},{"id":80,"value":"item_80"},{"id":81,"value":"item_81"},{"id":82,"value":"item_82"},{"id":83,"value":"item_83"},{"id":84,"value":"item_84"},{"id":85,"value":"item_85"},{"id":86,"value":"item_86"},{"id":87,"value":"item_87"},{"id":88,"value":"item_88"},{"id":89,"value":"item_89"},{"id":90,"value":"item_90"},{"id":91,"value":"item_91"},{"id":92,"value":"item_92"},{"id":93,"value":"item_93"},{"id":94,"value":"item_94"},{"id":95,"value":"item_95"},{"id":96,"value":"item_96"},{"id":97,"value":"item_97"},{"id":98,"value":"item_98"},{"id":99,"value":"item_99"},{"id":100,"value":"item_100"},{"id":101,"value":"item_101"},{"id":102,"value":"item_102"},{"id":103,"value":"item_103"},{"id":104,"value":"item_104"},{"id":105,"value":"item_105"},{"id":106,"value":"item_106"},{"id":107,"value":"item_107"},{"id":108,"value":"item_108"},{"id":109,"value":"item_109"},{"id":110,"value":"item_110"},{"id":111,"value":"item_111"},{"id":112,"value":"item_112"},{"id":113,"value":"item_113"},{"id":114,"value":"item_114"},{"id":115,"value":"item_115"},{"id":116,"value":"item_116"},{"id":117,"value":"item_117"},{"id":118,"value":"item_118"},{"id":119,"value":"item_119"},{"id":120,"value":"item_120"},{"id":121,"value":"item_121"},{"id":122,"value":"item_122"},{"id":123,"value":"item_123"},{"id":124,"value":"item_124"},{"id":125,"value":"item_125"},{"id":126,"value":"item_126"},{"id":127,"value":"item_127"},{"id":128,"value":"item_128"},{"id":129,"value":"item_129"},{"id":130,"value":"item_130"},{"id":131,"value":"item_131"},{"id":132,"value":"item_132"},{"id":133,"value":"item_133"},{"id":134,"value":"item_134"},{"id":135,"value":"item_135"},{"id":136,"value":"item_136"},{"id":137,"value":"item_137"},{"id":138,"value":"item_138"},{"id":139,"value":"item_139"},{"id":140,"value":"item_140"},{"id":141,"value":"item_141"},{"id":142,"value":"item_142"},{"id":143,"value":"item_143"},{"id":144,"value":"item_144"},{"id":145,"value":"item_145"},{"id":146,"value":"item_146"},{"id":147,"value":"item_147"},{"id":148,"value":"item_148"},{"id":149,"value":"item_149"},{"id":150,"value":"item_150"},{"id":151,"value":"item_151"},{"id":152,"value":"item_152"},{"id":153,"value":"item_153"},{"id":154,"value":"item_154"},{"id":155,"value":"item_155"},{"id":156,"value":"item_156"},{"id":157,"value":"item_157"},{"id":158,"value":"item_158"},{"id":159,"value":"item_159"},{"id":160,"value":"item_160"},{"id":161,"value":"item_161"},{"id":162,"value":"item_162"},{"id":163,"value":"item_163"},{"id":164,"value":"item_164"},{"id":165,"value":"item_165"},{"id":166,"value":"item_166"},{"id":167,"value":"item_167"},{"id":168,"value":"item_168"},{"id":169,"value":"item_169"},{"id":170,"value":"item_170"},{"id":171,"value":"item_171"},{"id":172,"value":"item_172"},{"id":173,"value":"item_173"},{"id":174,"value":"item_174"},{"id":175,"value":"item_175"},{"id":176,"value":"item_176"},{"id":177,"value":"item_177"},{"id":178,"value":"item_178"},{"id":179,"value":"item_179"},{"id":180,"value":"item_180"},{"id":181,"value":"item_181"},{"id":182,"value":"item_182"},{"id":183,"value":"item_183"},{"id":184,"value":"item_184"},{"id":185,"value":"item_185"},{"id":186,"value":"item_186"},{"id":187,"value":"item_187"},{"id":188,"value":"item_188"},{"id":189,"value":"item_189"},{"id":190,"value":"item_190"},{"id":191,"value":"item_191"},{"id":192,"value":"item_192"},{"id":193,"value":"item_193"},{"id":194,"value":"item_194"},{"id":195,"value":"item_195"},{"id":196,"value":"item_196"},{"id":197,"value":"item_197"},{"id":198,"value":"item_198"},{"id":199,"value":"item_199"},{"id":200,"value":"item_200"},{"id":201,"value":"item_201"},{"id":202,"value":"item_202"},{"id":203,"value":"item_203"},{"id":204,"value":"item_204"},{"id":205,"value":"item_205"},{"id":206,"value":"item_206"},{"id":207,"value":"item_207"},{"id":208,"value":"item_208"},{"id":209,"value":"item_209"},{"id":210,"value":"item_210"},{"id":211,"value":"item_211"},{"id":212,"value":"item_212"},{"id":213,"value":"item_213"},{"id":214,"value":"item_214"},{"id":215,"value":"item_215"},{"id":216,"value":"item_216"},{"id":217,"value":"item_217"},{"id":218,"value":"item_218"},{"id":219,"value":"item_219"},{"id":220,"value":"item_220"},{"id":221,"value":"item_221"},{"id":222,"value":"item_222"},{"id":223,"value":"item_223"},{"id":224,"value":"item_224"},{"id":225,"value":"item_225"},{"id":226,"value":"item_226"},{"id":227,"value":"item_227"},{"id":228,"value":"item_228"},{"id":229,"value":"item_229"},{"id":230,"value":"item_230"},{"id":231,"value":"item_231"},{"id":232,"value":"item_232"},{"id":233,"value":"item_233"},{"id":234,"value":"item_234"},{"id":235,"value":"item_235"},{"id":236,"value":"item_236"},{"id":237,"value":"item_237"},{"id":238,"value":"item_238"},{"id":239,"value":"item_239"},{"id":240,"value":"item_240"},{"id":241,"value":"item_241"},{"id":242,"value":"item_242"},{"id":243,"value":"item_243"},{"id":244,"value":"item_244"},{"id":245,"value":"item_245"},{"id":246,"value":"item_246"},{"id":247,"value":"item_247"},{"id":248,"value":"item_248"},{"id":249,"value":"item_249"},{"id":250,"value":"item_250"},{"id":251,"value":"item_251"},{"id":252,"value":"item_252"},{"id":253,"value":"item_253"},{"id":254,"value":"item_254"},{"id":255,"value":"item_255"},{"id":256,"value":"item_256"},{"id":257,"value":"item_257"},{"id":258,"value":"item_258"},{"id":259,"value":"item_259"},{"id":260,"value":"item_260"},{"id":261,"value":"item_261"},{"id":262,"value":"item_262"},{"id":263,"value":"item_263"},{"id":264,"value":"item_264"},{"id":265,"value":"item_265"},{"id":266,"value":"item_266"},{"id":267,"value":"item_267"},{"id":268,"value":"item_268"},{"id":269,"value":"item_269"},{"id":270,"value":"item_270"},{"id":271,"value":"item_271"},{"id":272,"value":"item_272"},{"id":273,"value":"item_273"},{"id":274,"value":"item_274"},{"id":275,"value":"item_275"},{"id":276,"value":"item_276"},{"id":277,"value":"item_277"},{"id":278,"value":"item_278"},{"id":279,"value":"item_279"},{"id":280,"value":"item_280"},{"id":281,"value":"item_281"},{"id":282,"value":"item_282"},{"id":283,"value":"item_283"},{"id":284,"value":"item_284"},{"id":285,"value":"item_285"},{"id":286,"value":"item_286"},{"id":287,"value":"item_287"},{"id":288,"value":"item_288"},{"id":289,"value":"item_289"},{"id":290,"value":"item_290"},{"id":291,"value":"item_291"},{"id":292,"value":"item_292"},{"id":293,"value":"item_293"},{"id":294,"value":"item_294"},{"id":295,"value":"item_295"},{"id":296,"value":"item_296"},{"id":297,"value":"item_297"},{"id":298,"value":"item_298"},{"id":299,"value":"item_299"},{"id":300,"value":"item_300"},{"id":301,"value":"item_301"},{"id":302,"value":"item_302"},{"id":303,"value":"item_303"},{"id":304,"value":"item_304"},{"id":305,"value":"item_305"},{"id":306,"value":"item_306"},{"id":307,"value":"item_307"},{"id":308,"value":"item_308"},{"id":309,"value":"item_309"},{"id":310,"value":"item_310"},{"id":311,"value":"item_311"},{"id":312,"value":"item_312"},{"id":313,"value":"item_313"},{"id":314,"value":"item_314"},{"id":315,"value":"item_315"},{"id":316,"value":"item_316"},{"id":317,"value":"item_317"},{"id":318,"value":"item_318"},{"id":319,"value":"item_319"},{"id":320,"value":"item_320"},{"id":321,"value":"item_321"},{"id":322,"value":"item_322"},{"id":323,"value":"item_323"},{"id":324,"value":"item_324"},{"id":325,"value":"item_325"},{"id":326,"value":"item_326"},{"id":327,"value":"item_327"},{"id":328,"value":"item_328"},{"id":329,"value":"item_329"},{"id":330,"value":"item_330"},{"id":331,"value":"item_331"},{"id":332,"value":"item_332"},{"id":333,"value":"item_333"},{"id":334,"value":"item_334"},{"id":335,"value":"item_335"},{"id":336,"value":"item_336"},{"id":337,"value":"item_337"},{"id":338,"value":"item_338"},{"id":339,"value":"item_339"},{"id":340,"value":"item_340"},{"id":341,"value":"item_341"},{"id":342,"value":"item_342"},{"id":343,"value":"item_343"},{"id":344,"value":"item_344"},{"id":345,"value":"item_345"},{"id":346,"value":"item_346"},{"id":347,"value":"item_347"},{"id":348,"value":"item_348"},{"id":349,"value":"item_349"},{"id":350,"value":"item_350"},{"id":351,"value":"item_351"},{"id":352,"value":"item_352"},{"id":353,"value":"item_353"},{"id":354,"value":"item_354"},{"id":355,"value":"item_355"},{"id":356,"value":"item_356"},{"id":357,"value":"item_357"},{"id":358,"value":"item_358"},{"id":359,"value":"item_359"},{"id":360,"value":"item_360"},{"id":361,"value":"item_361"},{"id":362,"value":"item_362"},{"id":363,"value":"item_363"},{"id":364,"value":"item_364"},{"id":365,"value":"item_365"},{"id":366,"value":"item_366"},{"id":367,"value":"item_367"},{"id":368,"value":"item_368"},{"id":369,"value":"item_369"},{"id":370,"value":"item_370"},{"id":371,"value":"item_371"},{"id":372,"value":"item_372"},{"id":373,"value":"item_373"},{"id":374,"value":"item_374"},{"id":375,"value":"item_375"},{"id":376,"value":"item_376"},{"id":377,"value":"item_377"},{"id":378,"value":"item_378"},{"id":379,"value":"item_379"},{"id":380,"value":"item_380"},{"id":381,"value":"item_381"},{"id":382,"value":"item_382"},{"id":383,"value":"item_383"},{"id":384,"value":"item_384"},{"id":385,"value":"item_385"},{"id":386,"value":"item_386"},{"id":387,"value":"item_387"},{"id":388,"value":"item_388"},{"id":389,"value":"item_389"},{"id":390,"value":"item_390"},{"id":391,"value":"item_391"},{"id":392,"value":"item_392"},{"id":393,"value":"item_393"},{"id":394,"value":"item_394"},{"id":395,"value":"item_395"},{"id":396,"value":"item_396"},{"id":397,"value":"item_397"},{"id":398,"value":"item_398"},{"id":399,"value":"item_399"},{"id":400,"value":"item_400"},{"id":401,"value":"item_401"},{"id":402,"value":"item_402"},{"id":403,"value":"item_403"},{"id":404,"value":"item_404"},{"id":405,"value":"item_405"},{"id":406,"value":"item_406"},{"id":407,"value":"item_407"},{"id":408,"value":"item_408"},{"id":409,"value":"item_409"},{"id":410,"value":"item_410"},{"id":411,"value":"item_411"},{"id":412,"value":"item_412"},{"id":413,"value":"item_413"},{"id":414,"value":"item_414"},{"id":415,"value":"item_415"},{"id":416,"value":"item_416"},{"id":417,"value":"item_417"},{"id":418,"value":"item_418"},{"id":419,"value":"item_419"},{"id":420,"value":"item_420"},{"id":421,"value":"item_421"},{"id":422,"value":"item_422"},{"id":423,"value":"item_423"},{"id":424,"value":"item_424"},{"id":425,"value":"item_425"},{"id":426,"value":"item_426"},{"id":427,"value":"item_427"},{"id":428,"value":"item_428"},{"id":429,"value":"item_429"},{"id":430,"value":"item_430"},{"id":431,"value":"item_431"},{"id":432,"value":"item_432"},{"id":433,"value":"item_433"},{"id":434,"value":"item_434"},{"id":435,"value":"item_435"},{"id":436,"value":"item_436"},{"id":437,"value":"item_437"},{"id":438,"value":"item_438"},{"id":439,"value":"item_439"},{"id":440,"value":"item_440"},{"id":441,"value":"item_441"},{"id":442,"value":"item_442"},{"id":443,"value":"item_443"},{"id":444,"value":"item_444"},{"id":445,"value":"item_445"},{"id":446,"value":"item_446"},{"id":447,"value":"item_447"},{"id":448,"value":"item_448"},{"id":449,"value":"item_449"},{"id":450,"value":"item_450"},{"id":451,"value":"item_451"},{"id":452,"value":"item_452"},{"id":453,"value":"item_453"},{"id":454,"value":"item_454"},{"id":455,"value":"item_455"},{"id":456,"value":"item_456"},{"id":457,"value":"item_457"},{"id":458,"value":"item_458"},{"id":459,"value":"item_459"},{"id":460,"value":"item_460"},{"id":461,"value":"item_461"},{"id":462,"value":"item_462"},{"id":463,"value":"item_463"},{"id":464,"value":"item_464"},{"id":465,"value":"item_465"},{"id":466,"value":"item_466"},{"id":467,"value":"item_467"},{"id":468,"value":"item_468"},{"id":469,"value":"item_469"},{"id":470,"value":"item_470"},{"id":471,"value":"item_471"},{"id":472,"value":"item_472"},{"id":473,"value":"item_473"},{"id":474,"value":"item_474"},{"id":475,"value":"item_475"},{"id":476,"value":"item_476"},{"id":477,"value":"item_477"},{"id":478,"value":"item_478"},{"id":479,"value":"item_479"},{"id":480,"value":"item_480"},{"id":481,"value":"item_481"},{"id":482,"value":"item_482"},{"id":483,"value":"item_483"},{"id":484,"value":"item_484"},{"id":485,"value":"item_485"},{"id":486,"value":"item_486"},{"id":487,"value":"item_487"},{"id":488,"value":"item_488"},{"id":489,"value":"item_489"},{"id":490,"value":"item_490"},{"id":491,"value":"item_491"},{"id":492,"value":"item_492"},{"id":493,"value":"item_493"},{"id":494,"value":"item_494"},{"id":495,"value":"item_495"},{"id":496,"value":"item_496"},{"id":497,"value":"item_497"},{"id":498,"value":"item_498"},{"id":499,"value":"item_499"},{"id":500,"value":"item_500"},{"id":501,"value":"item_501"},{"id":502,"value":"item_502"},{"id":503,"value":"item_503"},{"id":504,"value":"item_504"},{"id":505,"value":"item_505"},{"id":506,"value":"item_506"},{"id":507,"value":"item_507"},{"id":508,"value":"item_508"},{"id":509,"value":"item_509"},{"id":510,"value":"item_510"},{"id":511,"value":"item_511"},{"id":512,"value":"item_512"},{"id":513,"value":"item_513"},{"id":514,"value":"item_514"},{"id":515,"value":"item_515"},{"id":516,"value":"item_516"},{"id":517,"value":"item_517"},{"id":518,"value":"item_518"},{"id":519,"value":"item_519"},{"id":520,"value":"item_520"},{"id":521,"value":"item_521"},{"id":522,"value":"item_522"},{"id":523,"value":"item_523"},{"id":524,"value":"item_524"},{"id":525,"value":"item_525"},{"id":526,"value":"item_526"},{"id":527,"value":"item_527"},{"id":528,"value":"item_528"},{"id":529,"value":"item_529"},{"id":530,"value":"item_530"},{"id":531,"value":"item_531"},{"id":532,"value":"item_532"},{"id":533,"value":"item_533"},{"id":534,"value":"item_534"},{"id":535,"value":"item_535"},{"id":536,"value":"item_536"},{"id":537,"value":"item_537"},{"id":538,"value":"item_538"},{"id":539,"value":"item_539"},{"id":540,"value":"item_540"},{"id":541,"value":"item_541"},{"id":542,"value":"item_542"},{"id":543,"value":"item_543"},{"id":544,"value":"item_544"},{"id":545,"value":"item_545"},{"id":546,"value":"item_546"},{"id":547,"value":"item_547"},{"id":548,"value":"item_548"},{"id":549,"value":"item_549"},{"id":550,"value":"item_550"},{"id":551,"value":"item_551"},{"id":552,"value":"item_552"},{"id":553,"value":"item_553"},{"id":554,"value":"item_554"},{"id":555,"value":"item_555"},{"id":556,"value":"item_556"},{"id":557,"value":"item_557"},{"id":558,"value":"item_558"},{"id":559,"value":"item_559"},{"id":560,"value":"item_560"},{"id":561,"value":"item_561"},{"id":562,"value":"item_562"},{"id":563,"value":"item_563"},{"id":564,"value":"item_564"},{"id":565,"value":"item_565"},{"id":566,"value":"item_566"},{"id":567,"value":"item_567"},{"id":568,"value":"item_568"},{"id":569,"value":"item_569"},{"id":570,"value":"item_570"},{"id":571,"value":"item_571"},{"id":572,"value":"item_572"},{"id":573,"value":"item_573"},{"id":574,"value":"item_574"},{"id":575,"value":"item_575"},{"id":576,"value":"item_576"},{"id":577,"value":"item_577"},{"id":578,"value":"item_578"},{"id":579,"value":"item_579"},{"id":580,"value":"item_580"},{"id":581,"value":"item_581"},{"id":582,"value":"item_582"},{"id":583,"value":"item_583"},{"id":584,"value":"item_584"},{"id":585,"value":"item_585"},{"id":586,"value":"item_586"},{"id":587,"value":"item_587"},{"id":588,"value":"item_588"},{"id":589,"value":"item_589"},{"id":590,"value":"item_590"},{"id":591,"value":"item_591"},{"id":592,"value":"item_592"},{"id":593,"value":"item_593"},{"id":594,"value":"item_594"},{"id":595,"value":"item_595"},{"id":596,"value":"item_596"},{"id":597,"value":"item_597"},{"id":598,"value":"item_598"},{"id":599,"value":"item_599"},{"id":600,"value":"item_600"},{"id":601,"value":"item_601"},{"id":602,"value":"item_602"},{"id":603,"value":"item_603"},{"id":604,"value":"item_604"},{"id":605,"value":"item_605"},{"id":606,"value":"item_606"},{"id":607,"value":"item_607"},{"id":608,"value":"item_608"},{"id":609,"value":"item_609"},{"id":610,"value":"item_610"},{"id":611,"value":"item_611"},{"id":612,"value":"item_612"},{"id":613,"value":"item_613"},{"id":614,"value":"item_614"},{"id":615,"value":"item_615"},{"id":616,"value":"item_616"},{"id":617,"value":"item_617"},{"id":618,"value":"item_618"},{"id":619,"value":"item_619"},{"id":620,"value":"item_620"},{"id":621,"value":"item_621"},{"id":622,"value":"item_622"},{"id":623,"value":"item_623"},{"id":624,"value":"item_624"},{"id":625,"value":"item_625"},{"id":626,"value":"item_626"},{"id":627,"value":"item_627"},{"id":628,"value":"item_628"},{"id":629,"value":"item_629"},{"id":630,"value":"item_630"},{"id":631,"value":"item_631"},{"id":632,"value":"item_632"},{"id":633,"value":"item_633"},{"id":634,"value":"item_634"},{"id":635,"value":"item_635"},{"id":636,"value":"item_636"},{"id":637,"value":"item_637"},{"id":638,"value":"item_638"},{"id":639,"value":"item_639"},{"id":640,"value":"item_640"},{"id":641,"value":"item_641"},{"id":642,"value":"item_642"},{"id":643,"value":"item_643"},{"id":644,"value":"item_644"},{"id":645,"value":"item_645"},{"id":646,"value":"item_646"},{"id":647,"value":"item_647"},{"id":648,"value":"item_648"},{"id":649,"value":"item_649"},{"id":650,"value":"item_650"},{"id":651,"value":"item_651"},{"id":652,"value":"item_652"},{"id":653,"value":"item_653"},{"id":654,"value":"item_654"},{"id":655,"value":"item_655"},{"id":656,"value":"item_656"},{"id":657,"value":"item_657"},{"id":658,"value":"item_658"},{"id":659,"value":"item_659"},{"id":660,"value":"item_660"},{"id":661,"value":"item_661"},{"id":662,"value":"item_662"},{"id":663,"value":"item_663"},{"id":664,"value":"item_664"},{"id":665,"value":"item_665"},{"id":666,"value":"item_666"},{"id":667,"value":"item_667"},{"id":668,"value":"item_668"},{"id":669,"value":"item_669"},{"id":670,"value":"item_670"},{"id":671,"value":"item_671"},{"id":672,"value":"item_672"},{"id":673,"value":"item_673"},{"id":674,"value":"item_674"},{"id":675,"value":"item_675"},{"id":676,"value":"item_676"},{"id":677,"value":"item_677"},{"id":678,"value":"item_678"},{"id":679,"value":"item_679"},{"id":680,"value":"item_680"},{"id":681,"value":"item_681"},{"id":682,"value":"item_682"},{"id":683,"value":"item_683"},{"id":684,"value":"item_684"},{"id":685,"value":"item_685"},{"id":686,"value":"item_686"},{"id":687,"value":"item_687"},{"id":688,"value":"item_688"},{"id":689,"value":"item_689"},{"id":690,"value":"item_690"},{"id":691,"value":"item_691"},{"id":692,"value":"item_692"},{"id":693,"value":"item_693"},{"id":694,"value":"item_694"},{"id":695,"value":"item_695"},{"id":696,"value":"item_696"},{"id":697,"value":"item_697"},{"id":698,"value":"item_698"},{"id":699,"value":"item_699"},{"id":700,"value":"item_700"},{"id":701,"value":"item_701"},{"id":702,"value":"item_702"},{"id":703,"value":"item_703"},{"id":704,"value":"item_704"},{"id":705,"value":"item_705"},{"id":706,"value":"item_706"},{"id":707,"value":"item_707"},{"id":708,"value":"item_708"},{"id":709,"value":"item_709"},{"id":710,"value":"item_710"},{"id":711,"value":"item_711"},{"id":712,"value":"item_712"},{"id":713,"value":"item_713"},{"id":714,"value":"item_714"},{"id":715,"value":"item_715"},{"id":716,"value":"item_716"},{"id":717,"value":"item_717"},{"id":718,"value":"item_718"},{"id":719,"value":"item_719"},{"id":720,"value":"item_720"},{"id":721,"value":"item_721"},{"id":722,"value":"item_722"},{"id":723,"value":"item_723"},{"id":724,"value":"item_724"},{"id":725,"value":"item_725"},{"id":726,"value":"item_726"},{"id":727,"value":"item_727"},{"id":728,"value":"item_728"},{"id":729,"value":"item_729"},{"id":730,"value":"item_730"},{"id":731,"value":"item_731"},{"id":732,"value":"item_732"},{"id":733,"value":"item_733"},{"id":734,"value":"item_734"},{"id":735,"value":"item_735"},{"id":736,"value":"item_736"},{"id":737,"value":"item_737"},{"id":738,"value":"item_738"},{"id":739,"value":"item_739"},{"id":740,"value":"item_740"},{"id":741,"value":"item_741"},{"id":742,"value":"item_742"},{"id":743,"value":"item_743"},{"id":744,"value":"item_744"},{"id":745,"value":"item_745"},{"id":746,"value":"item_746"},{"id":747,"value":"item_747"},{"id":748,"value":"item_748"},{"id":749,"value":"item_749"},{"id":750,"value":"item_750"},{"id":751,"value":"item_751"},{"id":752,"value":"item_752"},{"id":753,"value":"item_753"},{"id":754,"value":"item_754"},{"id":755,"value":"item_755"},{"id":756,"value":"item_756"},{"id":757,"value":"item_757"},{"id":758,"value":"item_758"},{"id":759,"value":"item_759"},{"id":760,"value":"item_760"},{"id":761,"value":"item_761"},{"id":762,"value":"item_762"},{"id":763,"value":"item_763"},{"id":764,"value":"item_764"},{"id":765,"value":"item_765"},{"id":766,"value":"item_766"},{"id":767,"value":"item_767"},{"id":768,"value":"item_768"},{"id":769,"value":"item_769"},{"id":770,"value":"item_770"},{"id":771,"value":"item_771"},{"id":772,"value":"item_772"},{"id":773,"value":"item_773"},{"id":774,"value":"item_774"},{"id":775,"value":"item_775"},{"id":776,"value":"item_776"},{"id":777,"value":"item_777"},{"id":778,"value":"item_778"},{"id":779,"value":"item_779"},{"id":780,"value":"item_780"},{"id":781,"value":"item_781"},{"id":782,"value":"item_782"},{"id":783,"value":"item_783"},{"id":784,"value":"item_784"},{"id":785,"value":"item_785"},{"id":786,"value":"item_786"},{"id":787,"value":"item_787"},{"id":788,"value":"item_788"},{"id":789,"value":"item_789"},{"id":790,"value":"item_790"},{"id":791,"value":"item_791"},{"id":792,"value":"item_792"},{"id":793,"value":"item_793"},{"id":794,"value":"item_794"},{"id":795,"value":"item_795"},{"id":796,"value":"item_796"},{"id":797,"value":"item_797"},{"id":798,"value":"item_798"},{"id":799,"value":"item_799"},{"id":800,"value":"item_800"},{"id":801,"value":"item_801"},{"id":802,"value":"item_802"},{"id":803,"value":"item_803"},{"id":804,"value":"item_804"},{"id":805,"value":"item_805"},{"id":806,"value":"item_806"},{"id":807,"value":"item_807"},{"id":808,"value":"item_808"},{"id":809,"value":"item_809"},{"id":810,"value":"item_810"},{"id":811,"value":"item_811"},{"id":812,"value":"item_812"},{"id":813,"value":"item_813"},{"id":814,"value":"item_814"},{"id":815,"value":"item_815"},{"id":816,"value":"item_816"},{"id":817,"value":"item_817"},{"id":818,"value":"item_818"},{"id":819,"value":"item_819"},{"id":820,"value":"item_820"},{"id":821,"value":"item_821"},{"id":822,"value":"item_822"},{"id":823,"value":"item_823"},{"id":824,"value":"item_824"},{"id":825,"value":"item_825"},{"id":826,"value":"item_826"},{"id":827,"value":"item_827"},{"id":828,"value":"item_828"},{"id":829,"value":"item_829"},{"id":830,"value":"item_830"},{"id":831,"value":"item_831"},{"id":832,"value":"item_832"},{"id":833,"value":"item_833"},{"id":834,"value":"item_834"},{"id":835,"value":"item_835"},{"id":836,"value":"item_836"},{"id":837,"value":"item_837"},{"id":838,"value":"item_838"},{"id":839,"value":"item_839"},{"id":840,"value":"item_840"},{"id":841,"value":"item_841"},{"id":842,"value":"item_842"},{"id":843,"value":"item_843"},{"id":844,"value":"item_844"},{"id":845,"value":"item_845"},{"id":846,"value":"item_846"},{"id":847,"value":"item_847"},{"id":848,"value":"item_848"},{"id":849,"value":"item_849"},{"id":850,"value":"item_850"},{"id":851,"value":"item_851"},{"id":852,"value":"item_852"},{"id":853,"value":"item_853"},{"id":854,"value":"item_854"},{"id":855,"value":"item_855"},{"id":856,"value":"item_856"},{"id":857,"value":"item_857"},{"id":858,"value":"item_858"},{"id":859,"value":"item_859"},{"id":860,"value":"item_860"},{"id":861,"value":"item_861"},{"id":862,"value":"item_862"},{"id":863,"value":"item_863"},{"id":864,"value":"item_864"},{"id":865,"value":"item_865"},{"id":866,"value":"item_866"},{"id":867,"value":"item_867"},{"id":868,"value":"item_868"},{"id":869,"value":"item_869"},{"id":870,"value":"item_870"},{"id":871,"value":"item_871"},{"id":872,"value":"item_872"},{"id":873,"value":"item_873"},{"id":874,"value":"item_874"},{"id":875,"value":"item_875"},{"id":876,"value":"item_876"},{"id":877,"value":"item_877"},{"id":878,"value":"item_878"},{"id":879,"value":"item_879"},{"id":880,"value":"item_880"},{"id":881,"value":"item_881"},{"id":882,"value":"item_882"},{"id":883,"value":"item_883"},{"id":884,"value":"item_884"},{"id":885,"value":"item_885"},{"id":886,"value":"item_886"},{"id":887,"value":"item_887"},{"id":888,"value":"item_888"},{"id":889,"value":"item_889"},{"id":890,"value":"item_890"},{"id":891,"value":"item_891"},{"id":892,"value":"item_892"},{"id":893,"value":"item_893"},{"id":894,"value":"item_894"},{"id":895,"value":"item_895"},{"id":896,"value":"item_896"},{"id":897,"value":"item_897"},{"id":898,"value":"item_898"},{"id":899,"value":"item_899"},{"id":900,"value":"item_900"},{"id":901,"value":"item_901"},{"id":902,"value":"item_902"},{"id":903,"value":"item_903"},{"id":904,"value":"item_904"},{"id":905,"value":"item_905"},{"id":906,"value":"item_906"},{"id":907,"value":"item_907"},{"id":908,"value":"item_908"},{"id":909,"value":"item_909"},{"id":910,"value":"item_910"},{"id":911,"value":"item_911"},{"id":912,"value":"item_912"},{"id":913,"value":"item_913"},{"id":914,"value":"item_914"},{"id":915,"value":"item_915"},{"id":916,"value":"item_916"},{"id":917,"value":"item_917"},{"id":918,"value":"item_918"},{"id":919,"value":"item_919"},{"id":920,"value":"item_920"},{"id":921,"value":"item_921"},{"id":922,"value":"item_922"},{"id":923,"value":"item_923"},{"id":924,"value":"item_924"},{"id":925,"value":"item_925"},{"id":926,"value":"item_926"},{"id":927,"value":"item_927"},{"id":928,"value":"item_928"},{"id":929,"value":"item_929"},{"id":930,"value":"item_930"},{"id":931,"value":"item_931"},{"id":932,"value":"item_932"},{"id":933,"value":"item_933"},{"id":934,"value":"item_934"},{"id":935,"value":"item_935"},{"id":936,"value":"item_936"},{"id":937,"value":"item_937"},{"id":938,"value":"item_938"},{"id":939,"value":"item_939"},{"id":940,"value":"item_940"},{"id":941,"value":"item_941"},{"id":942,"value":"item_942"},{"id":943,"value":"item_943"},{"id":944,"value":"item_944"},{"id":945,"value":"item_945"},{"id":946,"value":"item_946"},{"id":947,"value":"item_947"},{"id":948,"value":"item_948"},{"id":949,"value":"item_949"},{"id":950,"value":"item_950"},{"id":951,"value":"item_951"},{"id":952,"value":"item_952"},{"id":953,"value":"item_953"},{"id":954,"value":"item_954"},{"id":955,"value":"item_955"},{"id":956,"value":"item_956"},{"id":957,"value":"item_957"},{"id":958,"value":"item_958"},{"id":959,"value":"item_959"},{"id":960,"value":"item_960"},{"id":961,"value":"item_961"},{"id":962,"value":"item_962"},{"id":963,"value":"item_963"},{"id":964,"value":"item_964"},{"id":965,"value":"item_965"},{"id":966,"value":"item_966"},{"id":967,"value":"item_967"},{"id":968,"value":"item_968"},{"id":969,"value":"item_969"},{"id":970,"value":"item_970"},{"id":971,"value":"item_971"},{"id":972,"value":"item_972"},{"id":973,"value":"item_973"},{"id":974,"value":"item_974"},{"id":975,"value":"item_975"},{"id":976,"value":"item_976"},{"id":977,"value":"item_977"},{"id":978,"value":"item_978"},{"id":979,"value":"item_979"},{"id":980,"value":"item_980"},{"id":981,"value":"item_981"},{"id":982,"value":"item_982"},{"id":983,"value":"item_983"},{"id":984,"value":"item_984"},{"id":985,"value":"item_985"},{"id":986,"value":"item_986"},{"id":987,"value":"item_987"},{"id":988,"value":"item_988"},{"id":989,"value":"item_989"},{"id":990,"value":"item_990"},{"id":991,"value":"item_991"},{"id":992,"value":"item_992"},{"id":993,"value":"item_993"},{"id":994,"value":"item_994"},{"id":995,"value":"item_995"},{"id":996,"value":"item_996"},{"id":997,"value":"item_997"},{"id":998,"value":"item_998"},{"id":999,"value":"item_999"}],"severity":"INFO"}

      at console.apply [as log] (tests/integration/utils/logger.test.js:28:26)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/logger.test.js
  Logger Integration Tests
    Basic Logging Methods
      ✓ should have all required logging methods
      ✓ should log error messages with context (3 ms)
      ✓ should log warn messages (1 ms)
      ✓ should log info messages (1 ms)
      ✓ should log debug messages
    Specialized Logging Methods
      ✓ should log database operations (1 ms)
      ✓ should log API calls (1 ms)
      ✓ should log authentication events (1 ms)
      ✓ should log performance metrics (1 ms)
      ✓ should log security events (1 ms)
      ✓ should log user actions with anonymized user ID (2 ms)
    Structured Logging
      ✓ should handle structured data in context (1 ms)
      ✓ should handle error objects with stack traces (9 ms)
    Logger Configuration
      ✓ should respect log levels
      ✓ should have service metadata (3 ms)
      ✓ should generate correlation IDs (1 ms)
    Log Entry Structure
      ✓ should create proper log entry structure
      ✓ should check log level filtering
    Middleware Functions
      ✓ should provide request middleware (1 ms)
      ✓ should provide error middleware
    Configuration Utilities
      ✓ should sanitize configuration data
      ✓ should log configuration loaded event (1 ms)
    Application Lifecycle Logging
      ✓ should log application startup (1 ms)
      ✓ should log application shutdown
    Child Logger Functionality
      ✓ should create child logger with additional context
      ✓ should use child logger with inherited context (1 ms)
    Performance Logging Edge Cases
      ✓ should warn on slow operations (1 ms)
      ✓ should log normal operations as info
    Error Handling
      ✓ should handle null or undefined context gracefully (2 ms)
      ✕ should handle circular references in context (4 ms)
      ✓ should handle very large context objects (1 ms)

  ● Logger Integration Tests › Error Handling › should handle circular references in context

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "Converting circular structure to JSON
        --> starting at object with constructor 'Object'
        --- property 'self' closes the circle"

          89 |     } else {
          90 |       // JSON format for production (structured logging)
        > 91 |       console.log(JSON.stringify(logEntry));
             |                        ^
          92 |     }
          93 |   }
          94 |

      at Logger.stringify [as output] (utils/logger.js:91:24)
      at Logger.output [as info] (utils/logger.js:144:10)
      at info (tests/integration/utils/logger.test.js:584:16)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/logger.test.js:585:14)
      at Object.toThrow (tests/integration/utils/logger.test.js:585:14)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/apiKeyService.test.js
  API Key Service Integration Tests
    API Key Encryption
      ✕ should encrypt and decrypt API keys
      ✕ should handle encryption with different salts
      ✕ should handle decryption with wrong salt gracefully
    API Key Storage and Retrieval
      ✓ should store and retrieve API keys (2 ms)
      ✓ should handle non-existent API keys (1 ms)
      ✓ should validate API keys (1 ms)
    JWT Token Validation
      ✕ should handle JWT token validation
      ✕ should check JWT circuit breaker
      ✕ should record JWT success and failure (2 ms)
    Circuit Breaker Functionality
      ✕ should check circuit breaker status
      ✕ should record success and failure (1 ms)
    Audit Logging
      ✕ should log audit events
      ✕ should handle audit logging failures gracefully
    Encryption Key Management
      ✕ should get encryption key
    Error Handling
      ✓ should handle encryption errors gracefully (1 ms)
      ✓ should handle decryption errors gracefully
      ✓ should handle database errors gracefully (5 ms)

  ● API Key Service Integration Tests › API Key Encryption › should encrypt and decrypt API keys

    TypeError: apiKeyService.encryptApiKey is not a function

      24 |       const userSalt = "user-salt-456";
      25 |
    > 26 |       const encrypted = await apiKeyService.encryptApiKey(testKey, userSalt);
         |                                             ^
      27 |       expect(encrypted).toBeDefined();
      28 |       expect(encrypted).not.toBe(testKey);
      29 |

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:26:45)

  ● API Key Service Integration Tests › API Key Encryption › should handle encryption with different salts

    TypeError: apiKeyService.encryptApiKey is not a function

      37 |       const salt2 = "salt2";
      38 |
    > 39 |       const encrypted1 = await apiKeyService.encryptApiKey(testKey, salt1);
         |                                              ^
      40 |       const encrypted2 = await apiKeyService.encryptApiKey(testKey, salt2);
      41 |
      42 |       // Same key with different salts should produce different encrypted results

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:39:46)

  ● API Key Service Integration Tests › API Key Encryption › should handle decryption with wrong salt gracefully

    TypeError: apiKeyService.encryptApiKey is not a function

      57 |       const wrongSalt = "wrong-salt";
      58 |
    > 59 |       const encrypted = await apiKeyService.encryptApiKey(testKey, correctSalt);
         |                                             ^
      60 |
      61 |       // Should not decrypt correctly with wrong salt
      62 |       try {

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:59:45)

  ● API Key Service Integration Tests › JWT Token Validation › should handle JWT token validation

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      134 |       expect(result).toBeDefined();
      135 |       // Invalid token should return null or false
    > 136 |       expect(result === null || result === false).toBe(true);
          |                                                   ^
      137 |     });
      138 |
      139 |     test("should check JWT circuit breaker", () => {

      at Object.toBe (tests/integration/utils/apiKeyService.test.js:136:51)

  ● API Key Service Integration Tests › JWT Token Validation › should check JWT circuit breaker

    TypeError: apiKeyService.checkJwtCircuitBreaker is not a function

      138 |
      139 |     test("should check JWT circuit breaker", () => {
    > 140 |       const circuitBreakerStatus = apiKeyService.checkJwtCircuitBreaker();
          |                                                  ^
      141 |       expect(typeof circuitBreakerStatus).toBe("boolean");
      142 |     });
      143 |

      at Object.checkJwtCircuitBreaker (tests/integration/utils/apiKeyService.test.js:140:50)

  ● API Key Service Integration Tests › JWT Token Validation › should record JWT success and failure

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "apiKeyService.recordJwtSuccess is not a function"

          145 |       // These methods should not throw errors
          146 |       expect(() => {
        > 147 |         apiKeyService.recordJwtSuccess();
              |                       ^
          148 |         apiKeyService.recordJwtFailure(new Error("test error"));
          149 |       }).not.toThrow();
          150 |     });

      at recordJwtSuccess (tests/integration/utils/apiKeyService.test.js:147:23)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:149:14)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:149:14)

  ● API Key Service Integration Tests › Circuit Breaker Functionality › should check circuit breaker status

    TypeError: apiKeyService.checkCircuitBreaker is not a function

      153 |   describe("Circuit Breaker Functionality", () => {
      154 |     test("should check circuit breaker status", () => {
    > 155 |       const status = apiKeyService.checkCircuitBreaker();
          |                                    ^
      156 |       expect(typeof status).toBe("boolean");
      157 |     });
      158 |

      at Object.checkCircuitBreaker (tests/integration/utils/apiKeyService.test.js:155:36)

  ● API Key Service Integration Tests › Circuit Breaker Functionality › should record success and failure

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "apiKeyService.recordSuccess is not a function"

          160 |       // These methods should not throw errors
          161 |       expect(() => {
        > 162 |         apiKeyService.recordSuccess();
              |                       ^
          163 |         apiKeyService.recordFailure(new Error("test error"));
          164 |       }).not.toThrow();
          165 |     });

      at recordSuccess (tests/integration/utils/apiKeyService.test.js:162:23)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:164:14)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:164:14)

  ● API Key Service Integration Tests › Audit Logging › should log audit events

    TypeError: apiKeyService.logAuditEvent is not a function

      175 |       // Should not throw error
      176 |       await expect(
    > 177 |         apiKeyService.logAuditEvent(userId, action, provider, sessionId)
          |                       ^
      178 |       ).resolves.not.toThrow();
      179 |     });
      180 |

      at Object.logAuditEvent (tests/integration/utils/apiKeyService.test.js:177:23)

  ● API Key Service Integration Tests › Audit Logging › should handle audit logging failures gracefully

    TypeError: apiKeyService.logAuditEvent is not a function

      182 |       // Should not throw even with invalid data
      183 |       await expect(
    > 184 |         apiKeyService.logAuditEvent(null, null, null, null)
          |                       ^
      185 |       ).resolves.not.toThrow();
      186 |     });
      187 |   });

      at Object.logAuditEvent (tests/integration/utils/apiKeyService.test.js:184:23)

  ● API Key Service Integration Tests › Encryption Key Management › should get encryption key

    TypeError: apiKeyService.getEncryptionKey is not a function

      189 |   describe("Encryption Key Management", () => {
      190 |     test("should get encryption key", async () => {
    > 191 |       const encryptionKey = await apiKeyService.getEncryptionKey();
          |                                                 ^
      192 |       expect(encryptionKey).toBeDefined();
      193 |       expect(typeof encryptionKey).toBe("string");
      194 |     });

      at Object.getEncryptionKey (tests/integration/utils/apiKeyService.test.js:191:49)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/alertSystem.test.js
  ● Alert System Integration Tests › Alert Processing and Database Integration › should create and store alerts in database

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should handle multiple alert types

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should process provider performance alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should handle cost monitoring alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Subscription and Filtering › should manage alert subscriptions

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Subscription and Filtering › should handle multiple subscriptions

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Deduplication and Rate Limiting › should deduplicate similar alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Deduplication and Rate Limiting › should respect rate limiting

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Metrics and Analytics › should calculate alert statistics

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Metrics and Analytics › should track alert trends

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should handle invalid alert data gracefully

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should recover from subscription callback errors

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should handle database connectivity issues

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Configuration and Customization › should allow threshold customization

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Configuration and Customization › should support custom alert processors

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Performance and Scalability › should handle high volume of alerts efficiently

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Performance and Scalability › should maintain memory usage under control

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Integration with Real-Time Services › should integrate with live data monitoring

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)


  ● Test suite failed to run

    TypeError: alertSystem.stop is not a function

      19 |   afterAll(async () => {
      20 |     if (alertSystem) {
    > 21 |       alertSystem.stop();
         |                   ^
      22 |     }
      23 |     await closeDatabase();
      24 |   });

      at Object.stop (tests/integration/utils/alertSystem.test.js:21:19)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:39:47.077Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Sentiment analysis failed:","correlationId":"30b26743","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:47.078Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Sentiment analysis failed:","correlationId":"0083b5e8","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:47.079Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Sentiment analysis failed:","correlationId":"d15d53f3","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:39:47.079Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Sentiment analysis failed:","correlationId":"d824d1b3","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/sentimentEngine.test.js
  Sentiment Engine Integration Tests
    Basic Sentiment Analysis
      ✓ should analyze sentiment with basic functionality (2 ms)
      ✓ should handle symbol-specific sentiment analysis
      ✓ should handle empty or invalid text (4 ms)
    Market Sentiment Calculation
      ✓ should calculate overall market sentiment
      ✓ should handle empty market data
      ✓ should handle invalid market data gracefully (1 ms)
    Score to Label Conversion
      ✓ should convert numeric scores to text labels
      ✕ should handle invalid scores gracefully (4 ms)
      ✓ should handle edge cases

  ● Sentiment Engine Integration Tests › Score to Label Conversion › should handle invalid scores gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: "neutral"
    Received: "positive"

      141 |       invalidScores.forEach((score) => {
      142 |         const label = sentimentEngine.scoreToLabel(score);
    > 143 |         expect(label).toBe("neutral");
          |                       ^
      144 |       });
      145 |     });
      146 |

      at toBe (tests/integration/utils/sentimentEngine.test.js:143:23)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/sentimentEngine.test.js:141:21)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/utils/newsAnalyzer.test.js
  News Analyzer Integration Tests
    News Data Processing
      ✕ should analyze news sentiment
      ✕ should extract key topics from news
    Real-time News Processing
      ✕ should process news feed (1 ms)
      ✕ should handle high-volume news processing
    Symbol-Specific Analysis
      ✕ should analyze news for specific symbols
      ✕ should calculate symbol sentiment score
    Trend Analysis
      ✕ should identify trending topics
      ✕ should analyze sentiment trends over time
    News Source Quality
      ✕ should evaluate news source credibility
      ✕ should weight analysis by source quality
    Language Processing
      ✕ should handle multiple languages
      ✕ should detect article language automatically
    Market Impact Analysis
      ✕ should predict market impact from news
      ✕ should correlate news with price movements
    Alert Integration
      ✕ should trigger news-based alerts
      ✕ should process real-time news alerts
    Performance and Scalability
      ✕ should process news articles efficiently
      ✕ should handle memory efficiently with large datasets (1 ms)

  ● News Analyzer Integration Tests › News Data Processing › should analyze news sentiment

    expect(received).toBeDefined()

    Received: undefined

      34 |       expect(sentiment).toBeDefined();
      35 |       expect(sentiment.score).toBeDefined();
    > 36 |       expect(sentiment.magnitude).toBeDefined();
         |                                   ^
      37 |       expect(sentiment.label).toBeDefined();
      38 |
      39 |       expect(typeof sentiment.score).toBe("number");

      at Object.toBeDefined (tests/integration/utils/newsAnalyzer.test.js:36:35)

  ● News Analyzer Integration Tests › News Data Processing › should extract key topics from news

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      54 |
      55 |       expect(Array.isArray(topics)).toBe(true);
    > 56 |       expect(topics.length).toBeGreaterThan(0);
         |                             ^
      57 |
      58 |       topics.forEach((topic) => {
      59 |         expect(topic.keyword).toBeDefined();

      at Object.toBeGreaterThan (tests/integration/utils/newsAnalyzer.test.js:56:29)

  ● News Analyzer Integration Tests › Real-time News Processing › should process news feed

    TypeError: newsAnalyzer.processNewsFeed is not a function

      83 |       ];
      84 |
    > 85 |       const processedFeed = await newsAnalyzer.processNewsFeed(newsFeed);
         |                                                ^
      86 |
      87 |       expect(Array.isArray(processedFeed)).toBe(true);
      88 |       expect(processedFeed.length).toBe(newsFeed.length);

      at Object.processNewsFeed (tests/integration/utils/newsAnalyzer.test.js:85:48)

  ● News Analyzer Integration Tests › Real-time News Processing › should handle high-volume news processing

    TypeError: newsAnalyzer.processBulkNews is not a function

      103 |
      104 |       const startTime = Date.now();
    > 105 |       const processed = await newsAnalyzer.processBulkNews(largeNewsFeed);
          |                                            ^
      106 |       const duration = Date.now() - startTime;
      107 |
      108 |       expect(processed.length).toBe(100);

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:105:44)

  ● News Analyzer Integration Tests › Symbol-Specific Analysis › should analyze news for specific symbols

    TypeError: newsAnalyzer.getSymbolNews is not a function

      119 |     test("should analyze news for specific symbols", async () => {
      120 |       const symbol = "AAPL";
    > 121 |       const symbolNews = await newsAnalyzer.getSymbolNews(symbol, {
          |                                             ^
      122 |         limit: 10,
      123 |       });
      124 |

      at Object.getSymbolNews (tests/integration/utils/newsAnalyzer.test.js:121:45)

  ● News Analyzer Integration Tests › Symbol-Specific Analysis › should calculate symbol sentiment score

    TypeError: newsAnalyzer.getSymbolSentimentScore is not a function

      133 |     test("should calculate symbol sentiment score", async () => {
      134 |       const symbol = "AAPL";
    > 135 |       const sentimentScore = await newsAnalyzer.getSymbolSentimentScore(symbol);
          |                                                 ^
      136 |
      137 |       expect(sentimentScore).toBeDefined();
      138 |       expect(sentimentScore.composite).toBeDefined();

      at Object.getSymbolSentimentScore (tests/integration/utils/newsAnalyzer.test.js:135:49)

  ● News Analyzer Integration Tests › Trend Analysis › should identify trending topics

    TypeError: newsAnalyzer.getTrendingTopics is not a function

      149 |   describe("Trend Analysis", () => {
      150 |     test("should identify trending topics", async () => {
    > 151 |       const trendingTopics = await newsAnalyzer.getTrendingTopics({
          |                                                 ^
      152 |         period: "24h",
      153 |       });
      154 |

      at Object.getTrendingTopics (tests/integration/utils/newsAnalyzer.test.js:151:49)

  ● News Analyzer Integration Tests › Trend Analysis › should analyze sentiment trends over time

    TypeError: newsAnalyzer.analyzeSentimentTrends is not a function

      167 |     test("should analyze sentiment trends over time", async () => {
      168 |       const symbol = "AAPL";
    > 169 |       const trendAnalysis = await newsAnalyzer.analyzeSentimentTrends(symbol, {
          |                                                ^
      170 |         period: "7days",
      171 |         granularity: "1hour",
      172 |       });

      at Object.analyzeSentimentTrends (tests/integration/utils/newsAnalyzer.test.js:169:48)

  ● News Analyzer Integration Tests › News Source Quality › should evaluate news source credibility

    TypeError: newsAnalyzer.evaluateSourceCredibility is not a function

      191 |       for (const source of sources) {
      192 |         const credibility =
    > 193 |           await newsAnalyzer.evaluateSourceCredibility(source);
          |                              ^
      194 |
      195 |         expect(credibility).toBeDefined();
      196 |         expect(credibility.score).toBeDefined();

      at Object.evaluateSourceCredibility (tests/integration/utils/newsAnalyzer.test.js:193:30)

  ● News Analyzer Integration Tests › News Source Quality › should weight analysis by source quality

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      224 |         await newsAnalyzer.analyzeSentiment(lowQualityArticle);
      225 |
    > 226 |       expect(highQualitySentiment.confidence).toBeGreaterThan(
          |                                               ^
      227 |         lowQualitySentiment.confidence
      228 |       );
      229 |       expect(highQualitySentiment.weight).toBeGreaterThan(

      at Object.toBeGreaterThan (tests/integration/utils/newsAnalyzer.test.js:226:47)

  ● News Analyzer Integration Tests › Language Processing › should handle multiple languages

    expect(received).toBe(expected) // Object.is equality

    Expected: "en"
    Received: undefined

      252 |
      253 |         expect(analysis).toBeDefined();
    > 254 |         expect(analysis.language).toBe(article.language);
          |                                   ^
      255 |         expect(analysis.sentiment).toBeDefined();
      256 |       }
      257 |     });

      at Object.toBe (tests/integration/utils/newsAnalyzer.test.js:254:35)

  ● News Analyzer Integration Tests › Language Processing › should detect article language automatically

    TypeError: newsAnalyzer.detectLanguageAndAnalyze is not a function

      264 |       };
      265 |
    > 266 |       const analysis = await newsAnalyzer.detectLanguageAndAnalyze(article);
          |                                           ^
      267 |
      268 |       expect(analysis).toBeDefined();
      269 |       expect(analysis.detectedLanguage).toBe("fr");

      at Object.detectLanguageAndAnalyze (tests/integration/utils/newsAnalyzer.test.js:266:43)

  ● News Analyzer Integration Tests › Market Impact Analysis › should predict market impact from news

    TypeError: newsAnalyzer.predictMarketImpact is not a function

      282 |       };
      283 |
    > 284 |       const marketImpact = await newsAnalyzer.predictMarketImpact(breakingNews);
          |                                               ^
      285 |
      286 |       expect(marketImpact).toBeDefined();
      287 |       expect(marketImpact.impactScore).toBeDefined();

      at Object.predictMarketImpact (tests/integration/utils/newsAnalyzer.test.js:284:47)

  ● News Analyzer Integration Tests › Market Impact Analysis › should correlate news with price movements

    TypeError: newsAnalyzer.correlateSentimentWithPrice is not a function

      298 |     test("should correlate news with price movements", async () => {
      299 |       const symbol = "AAPL";
    > 300 |       const correlation = await newsAnalyzer.correlateSentimentWithPrice(
          |                                              ^
      301 |         symbol,
      302 |         {
      303 |           period: "30days",

      at Object.correlateSentimentWithPrice (tests/integration/utils/newsAnalyzer.test.js:300:46)

  ● News Analyzer Integration Tests › Alert Integration › should trigger news-based alerts

    TypeError: newsAnalyzer.setupNewsAlert is not a function

      326 |       };
      327 |
    > 328 |       const newsAlert = await newsAnalyzer.setupNewsAlert(alertConfig);
          |                                            ^
      329 |
      330 |       expect(newsAlert).toBeDefined();
      331 |       expect(newsAlert.alertId).toBeDefined();

      at Object.setupNewsAlert (tests/integration/utils/newsAnalyzer.test.js:328:44)

  ● News Analyzer Integration Tests › Alert Integration › should process real-time news alerts

    TypeError: newsAnalyzer.processNewsAlert is not a function

      344 |       };
      345 |
    > 346 |       const alertTriggered = await newsAnalyzer.processNewsAlert(urgentNews);
          |                                                 ^
      347 |
      348 |       expect(alertTriggered).toBeDefined();
      349 |       expect(typeof alertTriggered.triggered).toBe("boolean");

      at Object.processNewsAlert (tests/integration/utils/newsAnalyzer.test.js:346:49)

  ● News Analyzer Integration Tests › Performance and Scalability › should process news articles efficiently

    TypeError: newsAnalyzer.processBulkNews is not a function

      364 |
      365 |       const startTime = Date.now();
    > 366 |       const results = await newsAnalyzer.processBulkNews(testArticles);
          |                                          ^
      367 |       const duration = Date.now() - startTime;
      368 |
      369 |       expect(results.length).toBe(50);

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:366:42)

  ● News Analyzer Integration Tests › Performance and Scalability › should handle memory efficiently with large datasets

    TypeError: newsAnalyzer.processBulkNews is not a function

      387 |       }));
      388 |
    > 389 |       await newsAnalyzer.processBulkNews(largeDataset);
          |                          ^
      390 |
      391 |       const finalMemory = process.memoryUsage().heapUsed;
      392 |       const memoryIncrease = finalMemory - initialMemory;

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:389:26)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 6ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:47 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 8ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 7ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:48 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 9ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 503 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 503 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 502 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:49 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 34ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 38ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 29ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 41ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 36ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 32ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 30ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 26ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 29ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 37ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 26ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 20ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 30ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 25ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 25ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:50 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 349 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 350 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 347 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 350 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 349 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 350 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 349 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 347 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 349 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 348 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:51 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 350 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:52 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 78ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 57ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 79ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 74ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 83ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 78ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 64ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 78ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 68ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 65ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 62ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 54ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 75ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 52ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 62ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 61ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 47ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 52ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 55ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 44ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 37ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 53ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 70ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 44ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 36ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 39ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 43ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 45ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 38ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 51ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 48ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 62ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 54ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 59ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 57ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 55ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 63ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 52ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 49ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 56ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 41ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 35ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 51ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 47ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 31ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 39ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 47ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 57ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 45ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 30ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 34ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 38ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 46ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 34ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 42ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:54 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:57 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:58 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:58 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:58 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:58 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:58 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:59 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:59 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:59 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:59 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:39:59 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:00 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:00 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:00 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:00 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:00 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 101ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 110ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 107ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 100ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 89ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 111ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 104ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 109ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 102ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 97ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 102ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 90ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 84ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 89ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 93ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 81ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 104ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 97ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 91ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 86ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 59ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 81ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 81ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 84ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 61ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 81ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 79ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 70ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 69ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 74ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 62ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 85ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 55ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 67ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 66ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 56ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 61ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 56ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 65ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 56ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio/nonexistent HTTP/1.1" 401 529 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 529 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 401 521 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:01 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/errors/rate-limiting.integration.test.js (14.582 s)
  Rate Limiting Integration
    Basic Rate Limiting Scenarios
      ✓ should handle rapid requests without blocking normal usage (2071 ms)
      ✓ should return 429 for excessive rapid requests (137 ms)
    Per-Endpoint Rate Limiting
      ✓ should apply different rate limits to different endpoint types (3125 ms)
      ✓ should handle authenticated vs unauthenticated rate limits (2072 ms)
    Rate Limit Response Format
      ✓ should return proper 429 error response format (109 ms)
      ✓ should include helpful rate limit information in responses (6 ms)
    Rate Limit Recovery
      ✓ should allow requests after rate limit reset period (2091 ms)
      ✓ should handle gradual recovery from rate limiting (4000 ms)
    Rate Limiting Security
      ✓ should not expose internal rate limiting configuration (148 ms)
      ✓ should handle distributed rate limiting consistently (550 ms)
    Rate Limiting Integration with Error Handling
      ✓ should maintain rate limiting during other error scenarios (52 ms)
      ✓ should handle rate limiting with authentication errors (45 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/unit/services/aiStrategyGeneratorStreaming.test.js
  AIStrategyGeneratorStreaming Service
    Constructor and Initialization
      ○ skipped should extend AIStrategyGenerator
      ○ skipped should initialize with empty active streams
    generateStreamId
      ○ skipped should generate unique stream IDs
    generateWithStreaming
      ○ skipped should generate strategy with streaming progress
      ○ skipped should handle concurrent stream limit
      ○ skipped should handle streaming without progress callback
      ○ skipped should handle empty symbols in streaming
      ○ skipped should clean up stream after completion
      ○ skipped should handle streaming errors gracefully
      ○ skipped should handle stream timeout
    processStreamingChunk
      ○ skipped should process chunks and call progress callback
      ○ skipped should handle null progress callback
      ○ skipped should handle empty chunks
      ○ skipped should handle very large chunks
    simulateStreamingResponse
      ○ skipped should simulate streaming for template fallback
      ○ skipped should handle strategy without all fields
      ○ skipped should simulate with appropriate delays
    stopStream
      ○ skipped should stop active stream
      ○ skipped should handle stopping non-existent stream
      ○ skipped should handle null stream ID
    stopAllStreams
      ○ skipped should stop all active streams
      ○ skipped should handle when no streams are active
    getActiveStreams
      ○ skipped should return active stream information
      ○ skipped should return empty array when no streams are active
      ○ skipped should calculate stream durations correctly
    getStreamingMetrics
      ○ skipped should return streaming metrics
      ○ skipped should handle zero active streams
    calculateAverageStreamDuration
      ○ skipped should calculate average duration correctly
      ○ skipped should return 0 when no streams are active
      ○ skipped should handle single stream
    Stream Configuration
      ○ skipped should allow updating streaming configuration
      ○ skipped should respect chunk size configuration
    Error Handling and Edge Cases
      ○ skipped should handle concurrent stream generation attempts
      ○ skipped should handle progress callback errors
      ○ skipped should handle very rapid stream start/stop cycles
      ○ skipped should handle invalid stream data
      ○ skipped should handle memory pressure with many streams
      ○ skipped should clean up properly on errors
    Integration with Base Class
      ✓ should inherit all base class functionality (1 ms)
      ✓ should use base class template generation (1307 ms)
      ✓ should maintain correlation ID from base class

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at log (utils/database.js:177:15)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at log (utils/database.js:215:15)

  console.log
    ✅ Database connection pool initialized successfully

      at log (utils/database.js:266:15)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata HTTP/1.1" 200 465 "-" "-"
  console.log
    {"timestamp":"2025-09-23T13:40:03.660Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data status request","correlationId":"livedata-status-1758634803660","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.662Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data status request completed","correlationId":"livedata-status-1758634803660","duration":2,"cacheEntries":0,"totalConnections":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/status HTTP/1.1" 200 3286 "-" "-"
  console.log
    {"timestamp":"2025-09-23T13:40:03.668Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data status request","correlationId":"test-correlation-1758634803668","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.672Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data status request completed","correlationId":"test-correlation-1758634803668","duration":4,"cacheEntries":0,"totalConnections":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/status HTTP/1.1" 200 3289 "-" "-"
  console.log
    {"timestamp":"2025-09-23T13:40:03.675Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data status request","correlationId":"livedata-status-1758634803675","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.677Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data status request completed","correlationId":"livedata-status-1758634803675","duration":2,"cacheEntries":0,"totalConnections":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/status HTTP/1.1" 200 3290 "-" "-"
  console.log
    {"timestamp":"2025-09-23T13:40:03.680Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data status request","correlationId":"livedata-status-1758634803680","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.682Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data status request completed","correlationId":"livedata-status-1758634803680","duration":2,"cacheEntries":0,"totalConnections":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/status HTTP/1.1" 200 3290 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/symbols?category=stocks HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/symbols?limit=50 HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/symbols?search=AAPL HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/providers HTTP/1.1" 200 744 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/providers HTTP/1.1" 200 744 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/providers?status=active HTTP/1.1" 200 744 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/connections HTTP/1.1" 200 178 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/connections HTTP/1.1" 200 178 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/market HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.703Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live market data request","correlationId":"livedata-market-1758634803703","userId":"dev-user-bypass","query":{},"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.704Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live market data request completed","correlationId":"livedata-market-1758634803703","duration":1,"hasIndices":true,"hasWatchlist":true,"errors":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/market HTTP/1.1" 200 332 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.709Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live market data request","correlationId":"livedata-market-1758634803709","userId":"dev-user-bypass","query":{"status":"true"},"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.710Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live market data request completed","correlationId":"livedata-market-1758634803709","duration":1,"hasIndices":true,"hasWatchlist":true,"errors":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/market?status=true HTTP/1.1" 200 332 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.715Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live market data request","correlationId":"livedata-market-1758634803715","userId":"dev-user-bypass","query":{"sector":"technology"},"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:03.717Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live market data request completed","correlationId":"livedata-market-1758634803715","duration":2,"hasIndices":true,"hasWatchlist":true,"errors":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/market?sector=technology HTTP/1.1" 200 332 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/AAPL,MSFT,GOOGL HTTP/1.1" 200 176 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/AAPL?interval=1m HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/INVALID@SYMBOL HTTP/1.1" 400 65 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/stream/SYM0,SYM1,SYM2,SYM3,SYM4,SYM5,SYM6,SYM7,SYM8,SYM9,SYM10,SYM11,SYM12,SYM13,SYM14,SYM15,SYM16,SYM17,SYM18,SYM19,SYM20,SYM21,SYM22,SYM23,SYM24,SYM25,SYM26,SYM27,SYM28,SYM29,SYM30,SYM31,SYM32,SYM33,SYM34,SYM35,SYM36,SYM37,SYM38,SYM39,SYM40,SYM41,SYM42,SYM43,SYM44,SYM45,SYM46,SYM47,SYM48,SYM49 HTTP/1.1" 400 389 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/latest/AAPL HTTP/1.1" 404 210 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/latest/AAPL HTTP/1.1" 404 210 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL, MSFT

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/latest/AAPL,MSFT HTTP/1.1" 404 223 "-" "-"
  console.log
    📊 Latest data requested for symbols: AAPL

      at log (routes/liveData.js:1210:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "GET /api/livedata/latest/AAPL?fields=price,volume,change HTTP/1.1" 404 210 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:03 +0000] "POST /api/livedata/admin/restart HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔄 Live data service restart requested { force: false, maintenance_window: false }

      at log (routes/liveData.js:291:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:05 +0000] "POST /api/livedata/admin/restart HTTP/1.1" 200 612 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    🔄 Live data service restart requested { force: false, maintenance_window: false }

      at log (routes/liveData.js:291:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:07 +0000] "POST /api/livedata/admin/restart HTTP/1.1" 200 612 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:07 +0000] "POST /api/livedata/admin/optimize HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚡ Live data optimization requested { target_latency: 50, cost_limit: 1000 }

      at log (routes/liveData.js:352:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "POST /api/livedata/admin/optimize HTTP/1.1" 200 1873 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/health HTTP/1.1" 200 211 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/health HTTP/1.1" 200 211 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/health?detailed=true HTTP/1.1" 200 399 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/metrics HTTP/1.1" 200 304 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/metrics?timeRange=1h HTTP/1.1" 200 321 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/metrics?category=performance HTTP/1.1" 200 337 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/websocket/info HTTP/1.1" 200 213 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "POST /api/livedata/subscriptions HTTP/1.1" 200 161 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL HTTP/1.1" 200 166 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/ HTTP/1.1" 400 70 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL%40%23%24 HTTP/1.1" 400 58 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/123 HTTP/1.1" 400 54 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/aaaaaaaaaaaaaaaaaaaa HTTP/1.1" 400 71 "-" "-"
  console.log
    {"timestamp":"2025-09-23T13:40:10.823Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Processing live data status request","correlationId":"livedata-status-1758634810823","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:10.825Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Live data status request completed","correlationId":"livedata-status-1758634810823","duration":2,"cacheEntries":0,"totalConnections":0,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/status HTTP/1.1" 200 3294 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/market HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/market HTTP/1.1" 401 521 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/market HTTP/1.1" 401 528 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/symbols HTTP/1.1" 200 804 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:10 +0000] "GET /api/livedata/stream/AAPL,MSFT,GOOGL,TSLA,NVDA,AMZN,META,NFLX,CRM,ORCL HTTP/1.1" 200 258 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/liveData.integration.test.js (7.385 s)
  Live Data Routes Integration Tests
    GET /api/livedata (Root endpoint)
      ✓ should return live data API information (3 ms)
      ✓ should include timestamp in response (2 ms)
      ✓ should handle concurrent requests to root endpoint (4 ms)
    GET /api/livedata/status
      ✓ should return comprehensive service status (13 ms)
      ✓ should include correlation ID from header (6 ms)
      ✓ should include component status information (5 ms)
      ✓ should include service metrics (8 ms)
    GET /api/livedata/symbols
      ✓ should return available symbols (2 ms)
      ✓ should handle category filter (2 ms)
      ✓ should handle limit parameter (1 ms)
      ✓ should handle search parameter (1 ms)
    GET /api/livedata/providers
      ✓ should return data provider information (1 ms)
      ✓ should include provider status and metrics (2 ms)
      ✓ should handle provider filtering by status (1 ms)
    GET /api/livedata/connections
      ✓ should return connection status information (1 ms)
      ✓ should include connection health metrics (1 ms)
    GET /api/livedata/market (Authenticated)
      ✓ should require authentication for market data (1 ms)
      ✓ should return market data with authentication (6 ms)
      ✓ should handle market status requests (6 ms)
      ✓ should handle sector parameter (8 ms)
    GET /api/livedata/stream/:symbols (Authenticated)
      ✓ should require authentication for streaming data (2 ms)
      ✓ should handle single symbol streaming request (3 ms)
      ✓ should handle multiple symbols streaming request (3 ms)
      ✓ should handle streaming with interval parameter (2 ms)
      ✓ should validate symbol format (3 ms)
      ✓ should handle too many symbols request (3 ms)
    GET /api/livedata/latest/:symbols (Authenticated)
      ✕ should require authentication for latest data (6 ms)
      ✕ should return latest data for single symbol (4 ms)
      ✕ should return latest data for multiple symbols (4 ms)
      ✕ should handle fields parameter for latest data (3 ms)
    POST /api/livedata/admin/restart (Admin)
      ✓ should require authentication for admin operations (1 ms)
      ✓ should handle restart request with authentication (2007 ms)
      ✓ should handle restart with component parameter (2005 ms)
    POST /api/livedata/admin/optimize (Admin)
      ✓ should require authentication for optimization (2 ms)
      ✓ should handle optimization request (3005 ms)
    GET /api/livedata/health
      ✓ should return health status without authentication (2 ms)
      ✓ should include uptime information (1 ms)
      ✓ should handle detailed health check (1 ms)
    GET /api/livedata/metrics
      ✓ should return performance metrics (2 ms)
      ✓ should handle metrics time range parameter (2 ms)
      ✓ should handle metrics category filter (2 ms)
    WebSocket and Real-time Features
      ✓ should handle WebSocket connection info (1 ms)
      ✓ should handle subscription management (1 ms)
    Performance and Edge Cases
      ✓ should handle concurrent streaming requests (17 ms)
      ✓ should handle malformed symbol parameters (11 ms)
      ✓ should maintain response time consistency (4 ms)
      ✓ should handle service overload gracefully (12 ms)
      ✓ should validate authentication edge cases (11 ms)
      ✓ should handle database connection failures gracefully (1 ms)
      ✓ should handle memory pressure scenarios (3 ms)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should require authentication for latest data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      329 |       const response = await request(app).get("/api/livedata/latest/AAPL");
      330 |
    > 331 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      332 |     });
      333 |
      334 |     test("should return latest data for single symbol", async () => {

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:331:52)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should return latest data for single symbol

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      337 |         .set("Authorization", `Bearer ${authToken}`);
      338 |
    > 339 |       expect(response.status).toBe(200);
          |                               ^
      340 |
      341 |       if (response.status === 200) {
      342 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:339:31)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should return latest data for multiple symbols

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      353 |         .set("Authorization", `Bearer ${authToken}`);
      354 |
    > 355 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      356 |
      357 |       if (response.status === 200) {
      358 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:355:52)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should handle fields parameter for latest data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      366 |         .set("Authorization", `Bearer ${authToken}`);
      367 |
    > 368 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      369 |     });
      370 |   });
      371 |

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:368:52)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at getDbConfig (utils/database.js:156:43)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at reapIntervalMillis (utils/database.js:202:9)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:250:20)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/performance/connection-pool-stress.performance.test.js (8.005 s)
  Connection Pool Stress Integration
    Pool Limit Testing
      ✓ should handle requests up to pool limit (2011 ms)
      ✓ should handle pool exhaustion gracefully (858 ms)
      ✓ should queue requests when pool is full (1109 ms)
    Connection Recovery and Resilience
      ✓ should recover from connection failures (1811 ms)
      ✓ should handle idle connection cleanup (2016 ms)
    Transaction Stress Testing
      ✓ should handle many concurrent transactions (15 ms)
      ✓ should maintain transaction isolation under stress (36 ms)
    Resource Management and Monitoring
      ✓ should provide pool status information (1 ms)
      ✓ should handle pool shutdown gracefully (18 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at getDbConfig (utils/database.js:156:43)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at reapIntervalMillis (utils/database.js:202:9)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:250:20)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:40:19.202Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634819202-dmfvm2pz7","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634819202-5s7c5g18b","prompt":"Create a momentum strategy using moving averages","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:20.009Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation completed","correlationId":"ai-strategy-1758634819202-dmfvm2pz7","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634819202-5s7c5g18b","strategyName":"AI Momentum Strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:20.011Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634820011-ndd9u8mc4","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634820011-1v71q21q3","prompt":"Create a simple trading strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:20.815Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation completed","correlationId":"ai-strategy-1758634820011-ndd9u8mc4","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634820011-1v71q21q3","strategyName":"AI Momentum Strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:20.817Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634820817-y0yhgw6z4","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634820817-9tg9mjv7r","prompt":"Create a strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:21.621Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation completed","correlationId":"ai-strategy-1758634820817-y0yhgw6z4","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634820817-9tg9mjv7r","strategyName":"AI Momentum Strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:21.622Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634821621-puhhx5jca","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634821622-cfx1v8lkh","prompt":"Strategy 1","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:21.622Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634821621-puhhx5jca","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634821622-pnnxtffos","prompt":"Strategy 2","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:21.623Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Stream rejected due to concurrent limit","correlationId":"def80ae4","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634821622-pnnxtffos","activeStreams":1,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:21.623Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation failed","correlationId":"ai-strategy-1758634821621-puhhx5jca","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634821622-pnnxtffos","error":"Maximum concurrent streams reached","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:22.822Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation completed","correlationId":"ai-strategy-1758634821621-puhhx5jca","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634821622-cfx1v8lkh","strategyName":"AI Momentum Strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:22.824Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Stream cancelled","correlationId":"95d9d98e","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634822823-bycirsode","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:22.835Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634822835-ahwz7ac9m","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634822835-vay6b381z","prompt":"Create a strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.036Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming failed, attempting template fallback","correlationId":"680bcd67","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634822835-vay6b381z","error":"Streaming connection failed","severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.037Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Generating AI-powered strategy from natural language","correlationId":"ai-strategy-1758634822835-ahwz7ac9m","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","prompt":"Create a strategy","symbolCount":4,"aiEnabled":true,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.044Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Generating AI strategy using advanced NLP engine","correlationId":"ai-strategy-1758634822835-ahwz7ac9m","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.046Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"AI strategy generation successful","correlationId":"ai-strategy-1758634822835-ahwz7ac9m","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","strategyType":"momentum","confidence":0.85,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.046Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"AI strategy generation successful","correlationId":"ai-strategy-1758634822835-ahwz7ac9m","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","strategyName":"AI Momentum Strategy","strategyType":"ai_generated","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.498Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634823498-113fv2uqs","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634823498-bdl5niu4c","prompt":"Create a strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.699Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming failed, attempting template fallback","correlationId":"5f17ab1b","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634823498-bdl5niu4c","error":"Test error","severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.700Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Generating AI-powered strategy from natural language","correlationId":"ai-strategy-1758634823498-113fv2uqs","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","prompt":"Create a strategy","symbolCount":4,"aiEnabled":true,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.700Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Generating AI strategy using advanced NLP engine","correlationId":"ai-strategy-1758634823498-113fv2uqs","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.701Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"AI strategy generation successful","correlationId":"ai-strategy-1758634823498-113fv2uqs","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","strategyType":"momentum","confidence":0.85,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.701Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"AI strategy generation successful","correlationId":"ai-strategy-1758634823498-113fv2uqs","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","strategyName":"AI Momentum Strategy","strategyType":"ai_generated","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:23.703Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting streaming strategy generation","correlationId":"ai-strategy-1758634823703-u5hw3e3bk","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634823703-5mdz1p1ba","prompt":"Create a strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:24.506Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Streaming strategy generation completed","correlationId":"ai-strategy-1758634823703-u5hw3e3bk","serviceName":"financial-platform","component":"ai-strategy-generator-streaming","streamId":"stream-1758634823703-5mdz1p1ba","strategyName":"AI Momentum Strategy","severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/services/aiStrategyGeneratorStreaming.test.js (5.35 s)
  AI Strategy Generator Streaming Integration Tests
    Core Streaming Functionality
      ✓ should generate strategy with streaming progress updates (810 ms)
      ✓ should handle streaming without progress callback (805 ms)
      ✓ should generate unique stream IDs
    Stream Management
      ✓ should track active streams (805 ms)
      ✓ should enforce maximum concurrent streams (1202 ms)
      ✓ should get stream status
      ✓ should cancel streams (1 ms)
    Progress Analysis
      ✓ should analyze streaming progress correctly (7 ms)
      ✓ should determine generation stages correctly (1 ms)
      ✓ should estimate time remaining correctly (1 ms)
    Error Handling
      ✓ should handle streaming errors gracefully (663 ms)
      ✓ should clean up streams on error (204 ms)
    Configuration and Metrics
      ✓ should provide streaming metrics
      ✓ should calculate average stream duration
      ✓ should have correct streaming configuration
    Integration with Base Class
      ✓ should inherit from AIStrategyGenerator
      ✓ should use inherited methods for strategy parsing (804 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/portfolio HTTP/1.1" 200 577 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/backtest/strategies HTTP/1.1" 200 235 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/portfolio/complex-analysis HTTP/1.1" 404 136 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/detailed-analysis HTTP/1.1" 404 134 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    📊 Backtest results requested - ID: all, limit: 50

      at log (routes/backtest.js:855:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/backtest/results HTTP/1.1" 200 934 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 28ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 21ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 24ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 21ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 17ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 15ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 31ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 29ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 23ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 21ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 1083 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "POST /api/backtest/run HTTP/1.1" 400 48 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 4ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 10ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 9ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 6ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 8ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview completed in 5ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:24 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    Market overview endpoint called - REAL LOADER TABLES

      at log (routes/market.js:514:11)

  console.log
    Market overview completed in 3ms using real loader tables

      at log (routes/market.js:732:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/market/overview HTTP/1.1" 200 1114 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
  console.log
    Starting health check with database...

      at log (routes/health.js:36:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/health HTTP/1.1" 200 504 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:26 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:27 +0000] "POST /api/portfolio/analyze HTTP/1.1" 200 347 "-" "-"
  console.log
    📅 Earnings calendar requested - symbol: all, days_ahead: 30

      at log (routes/calendar.js:80:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:27 +0000] "GET /api/calendar/earnings HTTP/1.1" 200 259 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    📋 Portfolio positions requested for user: dev-user-bypass

      at log (routes/portfolio.js:258:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:27 +0000] "GET /api/portfolio/positions HTTP/1.1" 200 99 "-" "-"
  console.log
    Calendar events endpoint called with params: {}

      at log (routes/calendar.js:371:13)

  console.log
    Calendar events: returning empty data - tables not configured in database

      at log (routes/calendar.js:379:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:27 +0000] "GET /api/calendar/events HTTP/1.1" 200 306 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/errors/timeout-handling.integration.test.js
  Timeout Handling Integration
    Request Timeout Scenarios
      ✓ should handle client-side request timeouts gracefully (16 ms)
      ✓ should return 408 or 504 for server-side timeouts (4 ms)
    Database Query Timeout Scenarios
      ✓ should handle slow database queries gracefully (18 ms)
      ✓ should handle connection pool timeout scenarios (74 ms)
    External Service Timeout Scenarios
      ✓ should handle external API timeouts properly (12 ms)
      ✓ should implement circuit breaker patterns for repeated timeouts (40 ms)
    Streaming and Long-Running Operation Timeouts
      ✓ should handle long-running analysis timeouts (5 ms)
      ✓ should provide timeout warnings for slow operations (1 ms)
    Timeout Recovery and Resilience
      ✓ should recover gracefully after timeout scenarios (2032 ms)
      ✓ should maintain system health during timeout scenarios (21 ms)
      ✓ should provide appropriate timeout configuration (11 ms)
    Timeout Error Response Consistency
      ✓ should return consistent timeout error responses (8 ms)
      ✓ should not expose internal timeout configurations (10 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.error
    Database query error: {
      error: 'syntax error at or near "INVALID"',
      query: 'INVALID SQL SYNTAX HERE',
      params: 'no parameters',
      code: '42601'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at Object.<anonymous> (tests/integration/utils/database-connection.integration.test.js:208:7)

  console.warn
    ⏱️ Slow query (1113ms): {
      query: '\n        SELECT pg_sleep(0.1), generate_series(1, 10) as num\n      ',
      rows: 10,
      duration: '1113ms'
    }

      1356 |       console.error(`⚠️ VERY SLOW QUERY detected (${duration}ms):`, {
      1357 |         query: text.slice(0, 150) + (text.length > 150 ? "..." : ""),
    > 1358 |         rows: result.rowCount,
           |     ^
      1359 |         duration: `${duration}ms`,
      1360 |       });
      1361 |     } else if (duration > 1000) {

      at query (utils/database.js:1358:5)
      at Object.<anonymous> (tests/integration/utils/database-connection.integration.test.js:217:22)

  console.error
    Database query error: {
      error: 'invalid input syntax for type integer: "not_a_number"',
      query: 'SELECT $1::int as value',
      params: '1 parameters',
      code: '22P02'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at Object.<anonymous> (tests/integration/utils/database-connection.integration.test.js:222:7)

  console.error
    Database query error: {
      error: 'duplicate key value violates unique constraint "company_profile_pkey"',
      query: '\n' +
        '          INSERT INTO company_profile (ticker, short_name, sector)\n' +
        "          VALUES ('DUPTEST', 'Di...",
      params: 'no parameters',
      code: '23505'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at Object.<anonymous> (tests/integration/utils/database-connection.integration.test.js:236:9)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/utils/database-connection.integration.test.js
  Database Comprehensive Integration Tests
    Connection Management
      ✓ should establish database connection successfully (1 ms)
      ✓ should handle connection testing
      ✓ should manage connection pool efficiently (1 ms)
      ✓ should handle concurrent connections (6 ms)
    Query Operations
      ✓ should execute basic SELECT queries
      ✓ should handle parameterized queries (1 ms)
      ✓ should handle queries with no results (1 ms)
      ✓ should handle complex queries with JOINs (1 ms)
    Transaction Management
      ✓ should execute successful transactions (2 ms)
      ✓ should rollback failed transactions (2 ms)
      ✓ should handle nested transaction operations (2 ms)
    Error Handling
      ✓ should handle SQL syntax errors gracefully (15 ms)
      ✓ should handle connection timeout scenarios (1114 ms)
      ✓ should handle invalid parameter types (2 ms)
      ✓ should handle database constraint violations (7 ms)
    Performance and Load Testing
      ✓ should handle bulk insert operations (25 ms)
      ✓ should handle high concurrency scenarios (10 ms)
    Data Integrity and Validation
      ✓ should maintain data consistency across operations (5 ms)
      ✓ should handle foreign key relationships properly (4 ms)
      ✓ should handle NULL values correctly (2 ms)
    Schema and Metadata Operations
      ✓ should query table schema information (3 ms)
      ✓ should check database statistics (2 ms)
      ✓ should verify database version and features
    Cleanup and Maintenance
      ✓ should clean up test data (6 ms)
      ✓ should verify cleanup completed

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/performance/concurrent-transaction.performance.test.js
  Concurrent Database Transaction Integration
    Concurrent Read Operations
      ✓ should handle multiple simultaneous read transactions (7 ms)
      ✓ should maintain read consistency across concurrent transactions (101 ms)
    Concurrent Write Operations
      ✓ should handle concurrent inserts without conflicts (17 ms)
      ✓ should handle concurrent updates with proper isolation (129 ms)
    Transaction Isolation Levels
      ✓ should maintain READ COMMITTED isolation (110 ms)
      ✓ should prevent dirty reads (109 ms)
    Deadlock Prevention and Recovery
      ✓ should handle potential deadlock scenarios gracefully (67 ms)
    Connection Pool Stress Testing
      ✓ should handle connection pool exhaustion gracefully (489 ms)
      ✓ should recover from temporary connection issues (18 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.819Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"3259c4a8","stockCount":4,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.825Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"f4fc5acc","scoredStocks":4,"topScore":0.54,"averageScore":0.4525,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.827Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"13cff885","stockCount":4,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.828Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"4625afe9","scoredStocks":4,"topScore":0.57,"averageScore":0.48,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.839Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"36cb5b40","stockCount":4,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.840Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"795f6fea","scoredStocks":4,"topScore":0.57,"averageScore":0.48,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.841Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"fb503c26","stockCount":4,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.842Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"2069c966","scoredStocks":4,"topScore":0.57,"averageScore":0.48,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.848Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"8425eceb","stockCount":4,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.849Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"7c574095","scoredStocks":4,"topScore":0.57,"averageScore":0.48,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.855Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Starting universe scoring","correlationId":"3873e21c","stockCount":100,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.866Z","level":"INFO","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Universe scoring completed","correlationId":"670cf3ca","scoredStocks":100,"topScore":0.72,"averageScore":0.516,"severity":"INFO"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.868Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Composite score calculation error","correlationId":"95b9601d","error":{"name":"TypeError","message":"Cannot read properties of null (reading 'pe_ratio')","stack":"TypeError: Cannot read properties of null (reading 'pe_ratio')\n    at FactorScoringEngine.calculateCategoryScore (/home/stocks/algo/webapp/lambda/utils/factorScoring.js:148:33)\n    at FactorScoringEngine.calculateCategoryScore [as calculateCompositeScore] (/home/stocks/algo/webapp/lambda/utils/factorScoring.js:108:36)\n    at Object.calculateCompositeScore (/home/stocks/algo/webapp/lambda/utils/factorScoring.js:775:25)\n    at calculateCompositeScore (/home/stocks/algo/webapp/lambda/tests/integration/utils/factorScoring.test.js:498:34)\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/node_modules/expect/build/toThrowMatchers.js:74:11)\n    at Object.throwingMatcher [as toThrow] (/home/stocks/algo/webapp/lambda/node_modules/expect/build/index.js:320:21)\n    at Object.toThrow (/home/stocks/algo/webapp/lambda/tests/integration/utils/factorScoring.test.js:498:69)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)"},"symbol":"unknown","severity":"ERROR"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/utils/factorScoring.test.js
  Factor Scoring Integration Tests
    Composite Score Calculation
      ✓ should calculate composite score for individual stock (1 ms)
      ✓ should handle stock data without universe comparison (1 ms)
      ✓ should handle missing factor data gracefully
    Universe Scoring
      ✓ should score entire universe of stocks (8 ms)
      ✓ should handle custom factor weights (2 ms)
      ✓ should handle empty universe gracefully (8 ms)
    Factor Explanations
      ✓ should provide detailed factor explanations (1 ms)
      ✓ should handle stocks with limited factor data
    Factor Definitions
      ✓ should return factor definitions (1 ms)
    Custom Profile Creation
      ✓ should create custom scoring profile
    Stock Screening
      ✓ should screen stocks by factor criteria (2 ms)
      ✓ should handle restrictive screening criteria (2 ms)
    FactorScoringEngine Class
      ✓ should create new engine with custom factors
      ✓ should analyze factors across universe (4 ms)
      ✓ should identify top performing factors (1 ms)
      ✓ should rank universe correctly (6 ms)
      ✓ should normalize factors correctly
      ✓ should handle edge cases in normalization
    Performance and Error Handling
      ✓ should handle large datasets efficiently (13 ms)
      ✓ should handle null and undefined values gracefully
      ✓ should handle invalid input gracefully (14 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.934Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error for tracking","correlationId":"test-123","stack":"Error: Test error for tracking\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:30:25)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","userId":"test_user","route":"/api/test","method":"GET","category":"general","severity":"ERROR","context":{"userId":"test_user","route":"/api/test","method":"GET","correlationId":"test-123"}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.944Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Error with stack trace","stack":"Error: Error with stack trace\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:46:21)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","route":"/test-service","method":"POST","category":"general","severity":"ERROR","context":{"route":"/test-service","method":"POST"}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.946Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database connection failed","stack":"Error: Database connection failed\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:59:29)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.946Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Unauthorized access","stack":"Error: Unauthorized access\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:60:25)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.947Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Validation failed","stack":"Error: Validation failed\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:61:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"validation","severity":"ERROR","context":{"statusCode":400}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.948Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database connection timeout","stack":"Error: Database connection timeout\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:83:29)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.949Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Unauthorized","stack":"Error: Unauthorized\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:84:25)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.949Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Invalid input","stack":"Error: Invalid input\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:85:27)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"validation","severity":"ERROR","context":{"statusCode":400}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.954Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Minor issue","stack":"Error: Minor issue\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:86:24)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.955Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database error","stack":"Error: Database error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:112:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.956Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Auth error","stack":"Error: Auth error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:113:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.957Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Validation error","stack":"Error: Validation error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:114:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"validation","severity":"ERROR","context":{"statusCode":400}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.957Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"API error","stack":"Error: API error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:117:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"api","severity":"ERROR","context":{"statusCode":500}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.959Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 0","stack":"Error: Test error 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.960Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 1","stack":"Error: Test error 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.960Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 2","stack":"Error: Test error 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.961Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 3","stack":"Error: Test error 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.962Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 4","stack":"Error: Test error 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.962Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 5","stack":"Error: Test error 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.963Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 6","stack":"Error: Test error 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.963Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 7","stack":"Error: Test error 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.964Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 8","stack":"Error: Test error 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.964Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test error 9","stack":"Error: Test error 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:138:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.965Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Connection failed","stack":"Error: Connection failed\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:161:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.966Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Connection failed","stack":"Error: Connection failed\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:161:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.967Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Connection failed","stack":"Error: Connection failed\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:161:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.967Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Unauthorized","stack":"Error: Unauthorized\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:166:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.968Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Unauthorized","stack":"Error: Unauthorized\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:166:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.969Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 0","stack":"Error: Concurrent error 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.969Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 1","stack":"Error: Concurrent error 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.970Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 2","stack":"Error: Concurrent error 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.971Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 3","stack":"Error: Concurrent error 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.971Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 4","stack":"Error: Concurrent error 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.972Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 5","stack":"Error: Concurrent error 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.972Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 6","stack":"Error: Concurrent error 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.979Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 7","stack":"Error: Concurrent error 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.980Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 8","stack":"Error: Concurrent error 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.980Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 9","stack":"Error: Concurrent error 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.981Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 10","stack":"Error: Concurrent error 10\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.981Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 11","stack":"Error: Concurrent error 11\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.982Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 12","stack":"Error: Concurrent error 12\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.982Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 13","stack":"Error: Concurrent error 13\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.983Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 14","stack":"Error: Concurrent error 14\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.984Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 15 general errors in the last minute (threshold: 15)","correlationId":"c6a94f82","category":"general","currentCount":15,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 15 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.985Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 15","stack":"Error: Concurrent error 15\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.986Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 16 general errors in the last minute (threshold: 15)","correlationId":"a754b3c5","category":"general","currentCount":16,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 16 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.986Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 16","stack":"Error: Concurrent error 16\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.987Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 17 general errors in the last minute (threshold: 15)","correlationId":"c468686f","category":"general","currentCount":17,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 17 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.988Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 17","stack":"Error: Concurrent error 17\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.988Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 18 general errors in the last minute (threshold: 15)","correlationId":"a0f85294","category":"general","currentCount":18,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 18 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.989Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 18","stack":"Error: Concurrent error 18\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.990Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 19 general errors in the last minute (threshold: 15)","correlationId":"9f65649c","category":"general","currentCount":19,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 19 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.991Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Concurrent error 19","stack":"Error: Concurrent error 19\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:183:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.991Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 20 general errors in the last minute (threshold: 15)","correlationId":"cea6bbf8","category":"general","currentCount":20,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 20 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:29.993Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database connection issue","stack":"Error: Database connection issue\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:201:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.994Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database timeout","stack":"Error: Database timeout\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:202:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.994Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Database connection failed 1758634829994","stack":"Error: Database connection failed 1758634829994\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:217:9)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"database","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.995Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Unauthorized access 1758634829994","stack":"Error: Unauthorized access 1758634829994\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:219:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"auth","severity":"ERROR","context":{"statusCode":401}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.996Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"API request failed 1758634829994","stack":"Error: API request failed 1758634829994\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:222:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"api","severity":"ERROR","context":{"statusCode":500}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.996Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Validation failed 1758634829994","stack":"Error: Validation failed 1758634829994\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:225:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"validation","severity":"ERROR","context":{"statusCode":400}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.997Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Context test error","correlationId":"req-456","stack":"Error: Context test error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:254:31)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","userId":"user123","route":"/api/portfolio","method":"POST","userAgent":"test-agent","ip":"127.0.0.1","category":"general","severity":"ERROR","context":{"userId":"user123","correlationId":"req-456","route":"/api/portfolio","method":"POST","userAgent":"test-agent","ip":"127.0.0.1"}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.998Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test 1","stack":"Error: Test 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:269:46)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:29.999Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Test 2","stack":"Error: Test 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:270:46)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.000Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 0","stack":"Error: History test 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.001Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 1","stack":"Error: History test 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.001Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 2","stack":"Error: History test 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.002Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 3","stack":"Error: History test 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.002Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 4","stack":"Error: History test 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.003Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 5","stack":"Error: History test 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.007Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 6","stack":"Error: History test 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.007Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 7","stack":"Error: History test 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.008Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 8","stack":"Error: History test 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.009Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 9","stack":"Error: History test 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.009Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 10","stack":"Error: History test 10\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.010Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 11","stack":"Error: History test 11\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.010Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 12","stack":"Error: History test 12\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.011Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 13","stack":"Error: History test 13\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.011Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 14","stack":"Error: History test 14\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.012Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 15 general errors in the last minute (threshold: 15)","correlationId":"a4328ce8","category":"general","currentCount":15,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 15 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.013Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 15","stack":"Error: History test 15\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.014Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 16 general errors in the last minute (threshold: 15)","correlationId":"3b076ed2","category":"general","currentCount":16,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 16 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.015Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 16","stack":"Error: History test 16\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.015Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 17 general errors in the last minute (threshold: 15)","correlationId":"6ccecf69","category":"general","currentCount":17,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 17 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.016Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 17","stack":"Error: History test 17\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.017Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 18 general errors in the last minute (threshold: 15)","correlationId":"30905b31","category":"general","currentCount":18,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 18 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.018Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 18","stack":"Error: History test 18\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.018Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 19 general errors in the last minute (threshold: 15)","correlationId":"800cd079","category":"general","currentCount":19,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 19 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.019Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 19","stack":"Error: History test 19\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.020Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 20 general errors in the last minute (threshold: 15)","correlationId":"664a48a6","category":"general","currentCount":20,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 20 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.021Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 20","stack":"Error: History test 20\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.022Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 21 general errors in the last minute (threshold: 15)","correlationId":"04de58c3","category":"general","currentCount":21,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 21 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.022Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 21","stack":"Error: History test 21\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.023Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 22 general errors in the last minute (threshold: 15)","correlationId":"bb4dbdca","category":"general","currentCount":22,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 22 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.024Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 22","stack":"Error: History test 22\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.024Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 23 general errors in the last minute (threshold: 15)","correlationId":"348c69a2","category":"general","currentCount":23,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 23 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.025Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 23","stack":"Error: History test 23\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.026Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 24 general errors in the last minute (threshold: 15)","correlationId":"7bdb3cb3","category":"general","currentCount":24,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 24 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.027Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 24","stack":"Error: History test 24\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.027Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 25 general errors in the last minute (threshold: 15)","correlationId":"b85a8e92","category":"general","currentCount":25,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 25 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.028Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 25","stack":"Error: History test 25\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.028Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 26 general errors in the last minute (threshold: 15)","correlationId":"88fa7d30","category":"general","currentCount":26,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 26 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.029Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 26","stack":"Error: History test 26\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.030Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 27 general errors in the last minute (threshold: 15)","correlationId":"d6dc2459","category":"general","currentCount":27,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 27 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.031Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 27","stack":"Error: History test 27\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.031Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 28 general errors in the last minute (threshold: 15)","correlationId":"bdb6a779","category":"general","currentCount":28,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 28 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.032Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 28","stack":"Error: History test 28\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.036Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 29 general errors in the last minute (threshold: 15)","correlationId":"1f59cd8a","category":"general","currentCount":29,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 29 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.037Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 29","stack":"Error: History test 29\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.038Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 30 general errors in the last minute (threshold: 15)","correlationId":"a4afe2dd","category":"general","currentCount":30,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 30 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.038Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 30","stack":"Error: History test 30\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.039Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 31 general errors in the last minute (threshold: 15)","correlationId":"46941910","category":"general","currentCount":31,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 31 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.040Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 31","stack":"Error: History test 31\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.040Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 32 general errors in the last minute (threshold: 15)","correlationId":"260c65b6","category":"general","currentCount":32,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 32 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.041Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 32","stack":"Error: History test 32\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.042Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 33 general errors in the last minute (threshold: 15)","correlationId":"0f2c9028","category":"general","currentCount":33,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 33 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.043Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 33","stack":"Error: History test 33\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.043Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 34 general errors in the last minute (threshold: 15)","correlationId":"57244cbb","category":"general","currentCount":34,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 34 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.044Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 34","stack":"Error: History test 34\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.045Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 35 general errors in the last minute (threshold: 15)","correlationId":"20b450fa","category":"general","currentCount":35,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 35 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.045Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 35","stack":"Error: History test 35\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.046Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 36 general errors in the last minute (threshold: 15)","correlationId":"4e3aa2bd","category":"general","currentCount":36,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 36 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.047Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 36","stack":"Error: History test 36\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.047Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 37 general errors in the last minute (threshold: 15)","correlationId":"aa5aabfb","category":"general","currentCount":37,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 37 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.048Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 37","stack":"Error: History test 37\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.049Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 38 general errors in the last minute (threshold: 15)","correlationId":"a5802ba1","category":"general","currentCount":38,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 38 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.050Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 38","stack":"Error: History test 38\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.050Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 39 general errors in the last minute (threshold: 15)","correlationId":"cd95181e","category":"general","currentCount":39,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 39 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.051Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 39","stack":"Error: History test 39\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.052Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 40 general errors in the last minute (threshold: 15)","correlationId":"0c572171","category":"general","currentCount":40,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 40 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.053Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 40","stack":"Error: History test 40\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.053Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 41 general errors in the last minute (threshold: 15)","correlationId":"47633847","category":"general","currentCount":41,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 41 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.054Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 41","stack":"Error: History test 41\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.055Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 42 general errors in the last minute (threshold: 15)","correlationId":"34857fc6","category":"general","currentCount":42,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 42 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.055Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 42","stack":"Error: History test 42\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.056Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 43 general errors in the last minute (threshold: 15)","correlationId":"d158120d","category":"general","currentCount":43,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 43 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.057Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 43","stack":"Error: History test 43\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.058Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 44 general errors in the last minute (threshold: 15)","correlationId":"65cabbf6","category":"general","currentCount":44,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 44 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.058Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 44","stack":"Error: History test 44\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.059Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 45 general errors in the last minute (threshold: 15)","correlationId":"56d0eac3","category":"general","currentCount":45,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 45 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.060Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 45","stack":"Error: History test 45\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.060Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 46 general errors in the last minute (threshold: 15)","correlationId":"62e6497b","category":"general","currentCount":46,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 46 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.061Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 46","stack":"Error: History test 46\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.068Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 47 general errors in the last minute (threshold: 15)","correlationId":"c688cc56","category":"general","currentCount":47,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 47 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.069Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 47","stack":"Error: History test 47\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.070Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 48 general errors in the last minute (threshold: 15)","correlationId":"801d519c","category":"general","currentCount":48,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 48 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.071Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 48","stack":"Error: History test 48\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.071Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 49 general errors in the last minute (threshold: 15)","correlationId":"4a654966","category":"general","currentCount":49,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 49 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.072Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"History test 49","stack":"Error: History test 49\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:286:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.073Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 50 general errors in the last minute (threshold: 15)","correlationId":"81942ad2","category":"general","currentCount":50,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 50 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.074Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 0","stack":"Error: Additional error 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.074Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 51 general errors in the last minute (threshold: 15)","correlationId":"740bdea0","category":"general","currentCount":51,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 51 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.075Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 1","stack":"Error: Additional error 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.076Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 52 general errors in the last minute (threshold: 15)","correlationId":"78e3a75f","category":"general","currentCount":52,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 52 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.077Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 2","stack":"Error: Additional error 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.077Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 53 general errors in the last minute (threshold: 15)","correlationId":"ce41ef03","category":"general","currentCount":53,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 53 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.078Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 3","stack":"Error: Additional error 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.078Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 54 general errors in the last minute (threshold: 15)","correlationId":"c3dfbd05","category":"general","currentCount":54,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 54 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.079Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 4","stack":"Error: Additional error 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.080Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 55 general errors in the last minute (threshold: 15)","correlationId":"e5df4fe8","category":"general","currentCount":55,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 55 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.080Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 5","stack":"Error: Additional error 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.081Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 56 general errors in the last minute (threshold: 15)","correlationId":"5b4fb95e","category":"general","currentCount":56,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 56 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.082Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 6","stack":"Error: Additional error 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.082Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 57 general errors in the last minute (threshold: 15)","correlationId":"1e5f278a","category":"general","currentCount":57,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 57 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.083Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 7","stack":"Error: Additional error 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.084Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 58 general errors in the last minute (threshold: 15)","correlationId":"ec99f139","category":"general","currentCount":58,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 58 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.084Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 8","stack":"Error: Additional error 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.085Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 59 general errors in the last minute (threshold: 15)","correlationId":"46b891b3","category":"general","currentCount":59,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 59 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.086Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Additional error 9","stack":"Error: Additional error 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:294:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.086Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 60 general errors in the last minute (threshold: 15)","correlationId":"f4356c8e","category":"general","currentCount":60,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 60 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.088Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Clear test 0","stack":"Error: Clear test 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:307:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.089Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Clear test 1","stack":"Error: Clear test 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:307:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.089Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Clear test 2","stack":"Error: Clear test 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:307:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.090Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Clear test 3","stack":"Error: Clear test 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:307:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.091Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Clear test 4","stack":"Error: Clear test 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:307:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.091Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 0","stack":"Error: Volume test 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.092Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 1","stack":"Error: Volume test 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.093Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 2","stack":"Error: Volume test 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.093Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 3","stack":"Error: Volume test 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.094Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 4","stack":"Error: Volume test 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.100Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 5","stack":"Error: Volume test 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.101Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 6","stack":"Error: Volume test 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.101Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 7","stack":"Error: Volume test 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.102Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 8","stack":"Error: Volume test 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.102Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 9","stack":"Error: Volume test 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.103Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 10","stack":"Error: Volume test 10\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.103Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 11","stack":"Error: Volume test 11\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.104Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 12","stack":"Error: Volume test 12\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.105Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 13","stack":"Error: Volume test 13\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.105Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 14","stack":"Error: Volume test 14\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.106Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 15 general errors in the last minute (threshold: 15)","correlationId":"708f623a","category":"general","currentCount":15,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 15 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.107Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 15","stack":"Error: Volume test 15\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.107Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 16 general errors in the last minute (threshold: 15)","correlationId":"284eafab","category":"general","currentCount":16,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 16 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.108Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 16","stack":"Error: Volume test 16\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.109Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 17 general errors in the last minute (threshold: 15)","correlationId":"413ed76a","category":"general","currentCount":17,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 17 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.110Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 17","stack":"Error: Volume test 17\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.110Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 18 general errors in the last minute (threshold: 15)","correlationId":"dd6cd2a3","category":"general","currentCount":18,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 18 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.111Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 18","stack":"Error: Volume test 18\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.112Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 19 general errors in the last minute (threshold: 15)","correlationId":"7d8d3b7c","category":"general","currentCount":19,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 19 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.113Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 19","stack":"Error: Volume test 19\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.113Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 20 general errors in the last minute (threshold: 15)","correlationId":"a880154a","category":"general","currentCount":20,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 20 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.114Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 20","stack":"Error: Volume test 20\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.115Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 21 general errors in the last minute (threshold: 15)","correlationId":"3a592bb9","category":"general","currentCount":21,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 21 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.115Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 21","stack":"Error: Volume test 21\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.116Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 22 general errors in the last minute (threshold: 15)","correlationId":"792b8c37","category":"general","currentCount":22,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 22 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.117Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 22","stack":"Error: Volume test 22\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.118Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 23 general errors in the last minute (threshold: 15)","correlationId":"fb12a611","category":"general","currentCount":23,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 23 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.118Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 23","stack":"Error: Volume test 23\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.119Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 24 general errors in the last minute (threshold: 15)","correlationId":"bd666be8","category":"general","currentCount":24,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 24 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.120Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 24","stack":"Error: Volume test 24\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.120Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 25 general errors in the last minute (threshold: 15)","correlationId":"5ac9cd32","category":"general","currentCount":25,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 25 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.121Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 25","stack":"Error: Volume test 25\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.122Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 26 general errors in the last minute (threshold: 15)","correlationId":"2b7c63d4","category":"general","currentCount":26,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 26 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.123Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 26","stack":"Error: Volume test 26\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.123Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 27 general errors in the last minute (threshold: 15)","correlationId":"71a8888a","category":"general","currentCount":27,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 27 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.124Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 27","stack":"Error: Volume test 27\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.125Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 28 general errors in the last minute (threshold: 15)","correlationId":"eb58d9ea","category":"general","currentCount":28,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 28 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.126Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 28","stack":"Error: Volume test 28\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.130Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 29 general errors in the last minute (threshold: 15)","correlationId":"cb5f41aa","category":"general","currentCount":29,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 29 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.131Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 29","stack":"Error: Volume test 29\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.131Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 30 general errors in the last minute (threshold: 15)","correlationId":"4ebd1a96","category":"general","currentCount":30,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 30 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.132Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 30","stack":"Error: Volume test 30\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.133Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 31 general errors in the last minute (threshold: 15)","correlationId":"70d95ae2","category":"general","currentCount":31,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 31 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.134Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 31","stack":"Error: Volume test 31\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.134Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 32 general errors in the last minute (threshold: 15)","correlationId":"6899b48c","category":"general","currentCount":32,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 32 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.135Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 32","stack":"Error: Volume test 32\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.136Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 33 general errors in the last minute (threshold: 15)","correlationId":"7ec366c5","category":"general","currentCount":33,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 33 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.136Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 33","stack":"Error: Volume test 33\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.137Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 34 general errors in the last minute (threshold: 15)","correlationId":"39cc793a","category":"general","currentCount":34,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 34 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.138Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 34","stack":"Error: Volume test 34\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.138Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 35 general errors in the last minute (threshold: 15)","correlationId":"f78ea2a1","category":"general","currentCount":35,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 35 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.139Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 35","stack":"Error: Volume test 35\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.140Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 36 general errors in the last minute (threshold: 15)","correlationId":"f519deac","category":"general","currentCount":36,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 36 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.141Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 36","stack":"Error: Volume test 36\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.142Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 37 general errors in the last minute (threshold: 15)","correlationId":"84871446","category":"general","currentCount":37,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 37 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.142Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 37","stack":"Error: Volume test 37\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.143Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 38 general errors in the last minute (threshold: 15)","correlationId":"f289bf95","category":"general","currentCount":38,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 38 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.144Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 38","stack":"Error: Volume test 38\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.144Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 39 general errors in the last minute (threshold: 15)","correlationId":"06fd08b0","category":"general","currentCount":39,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 39 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.145Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 39","stack":"Error: Volume test 39\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.146Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 40 general errors in the last minute (threshold: 15)","correlationId":"156653a7","category":"general","currentCount":40,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 40 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.147Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 40","stack":"Error: Volume test 40\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.147Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 41 general errors in the last minute (threshold: 15)","correlationId":"99d4c8c7","category":"general","currentCount":41,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 41 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.148Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 41","stack":"Error: Volume test 41\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.149Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 42 general errors in the last minute (threshold: 15)","correlationId":"1e110bd6","category":"general","currentCount":42,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 42 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.149Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 42","stack":"Error: Volume test 42\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.150Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 43 general errors in the last minute (threshold: 15)","correlationId":"dc1fc4bd","category":"general","currentCount":43,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 43 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.151Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 43","stack":"Error: Volume test 43\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.151Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 44 general errors in the last minute (threshold: 15)","correlationId":"56701ed3","category":"general","currentCount":44,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 44 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.152Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 44","stack":"Error: Volume test 44\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.153Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 45 general errors in the last minute (threshold: 15)","correlationId":"854a0d55","category":"general","currentCount":45,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 45 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.153Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 45","stack":"Error: Volume test 45\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.154Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 46 general errors in the last minute (threshold: 15)","correlationId":"bedcfeed","category":"general","currentCount":46,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 46 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.155Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 46","stack":"Error: Volume test 46\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.156Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 47 general errors in the last minute (threshold: 15)","correlationId":"3cca2caa","category":"general","currentCount":47,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 47 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.157Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 47","stack":"Error: Volume test 47\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.157Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 48 general errors in the last minute (threshold: 15)","correlationId":"fa37b84e","category":"general","currentCount":48,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 48 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.161Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 48","stack":"Error: Volume test 48\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.162Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 49 general errors in the last minute (threshold: 15)","correlationId":"3ee3ce53","category":"general","currentCount":49,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 49 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.162Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 49","stack":"Error: Volume test 49\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.163Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 50 general errors in the last minute (threshold: 15)","correlationId":"bd5ec9cc","category":"general","currentCount":50,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 50 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.164Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 50","stack":"Error: Volume test 50\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.165Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 51 general errors in the last minute (threshold: 15)","correlationId":"6b13abc1","category":"general","currentCount":51,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 51 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.165Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 51","stack":"Error: Volume test 51\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.166Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 52 general errors in the last minute (threshold: 15)","correlationId":"7cde4da8","category":"general","currentCount":52,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 52 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.167Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 52","stack":"Error: Volume test 52\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.168Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 53 general errors in the last minute (threshold: 15)","correlationId":"d99a5918","category":"general","currentCount":53,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 53 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.168Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 53","stack":"Error: Volume test 53\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.169Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 54 general errors in the last minute (threshold: 15)","correlationId":"2c16006d","category":"general","currentCount":54,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 54 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.170Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 54","stack":"Error: Volume test 54\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.170Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 55 general errors in the last minute (threshold: 15)","correlationId":"0115bc95","category":"general","currentCount":55,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 55 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.171Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 55","stack":"Error: Volume test 55\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.171Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 56 general errors in the last minute (threshold: 15)","correlationId":"ba9e80aa","category":"general","currentCount":56,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 56 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.172Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 56","stack":"Error: Volume test 56\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.173Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 57 general errors in the last minute (threshold: 15)","correlationId":"c7b4f7f1","category":"general","currentCount":57,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 57 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.174Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 57","stack":"Error: Volume test 57\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.174Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 58 general errors in the last minute (threshold: 15)","correlationId":"d704257d","category":"general","currentCount":58,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 58 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.175Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 58","stack":"Error: Volume test 58\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.175Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 59 general errors in the last minute (threshold: 15)","correlationId":"268f30cc","category":"general","currentCount":59,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 59 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.176Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 59","stack":"Error: Volume test 59\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.177Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 60 general errors in the last minute (threshold: 15)","correlationId":"839d3803","category":"general","currentCount":60,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 60 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.178Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 60","stack":"Error: Volume test 60\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.178Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 61 general errors in the last minute (threshold: 15)","correlationId":"3a9aa5ff","category":"general","currentCount":61,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 61 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.179Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 61","stack":"Error: Volume test 61\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.180Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 62 general errors in the last minute (threshold: 15)","correlationId":"da46cd01","category":"general","currentCount":62,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 62 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.181Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 62","stack":"Error: Volume test 62\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.181Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 63 general errors in the last minute (threshold: 15)","correlationId":"80835eca","category":"general","currentCount":63,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 63 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.182Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 63","stack":"Error: Volume test 63\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.183Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 64 general errors in the last minute (threshold: 15)","correlationId":"d971c91e","category":"general","currentCount":64,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 64 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.184Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 64","stack":"Error: Volume test 64\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.185Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 65 general errors in the last minute (threshold: 15)","correlationId":"be9f3775","category":"general","currentCount":65,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 65 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.185Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 65","stack":"Error: Volume test 65\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.186Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 66 general errors in the last minute (threshold: 15)","correlationId":"c47676c0","category":"general","currentCount":66,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 66 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.187Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 66","stack":"Error: Volume test 66\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.187Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 67 general errors in the last minute (threshold: 15)","correlationId":"31d1522d","category":"general","currentCount":67,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 67 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.188Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 67","stack":"Error: Volume test 67\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.191Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 68 general errors in the last minute (threshold: 15)","correlationId":"da6ea0b5","category":"general","currentCount":68,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 68 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.192Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 68","stack":"Error: Volume test 68\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.193Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 69 general errors in the last minute (threshold: 15)","correlationId":"f276e28c","category":"general","currentCount":69,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 69 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.194Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 69","stack":"Error: Volume test 69\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.194Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 70 general errors in the last minute (threshold: 15)","correlationId":"395f763c","category":"general","currentCount":70,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 70 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.195Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 70","stack":"Error: Volume test 70\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.196Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 71 general errors in the last minute (threshold: 15)","correlationId":"984e4903","category":"general","currentCount":71,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 71 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.196Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 71","stack":"Error: Volume test 71\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.197Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 72 general errors in the last minute (threshold: 15)","correlationId":"1f4cd549","category":"general","currentCount":72,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 72 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.198Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 72","stack":"Error: Volume test 72\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.198Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 73 general errors in the last minute (threshold: 15)","correlationId":"93d59883","category":"general","currentCount":73,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 73 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.199Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 73","stack":"Error: Volume test 73\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.200Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 74 general errors in the last minute (threshold: 15)","correlationId":"0bac1fc5","category":"general","currentCount":74,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 74 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.201Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 74","stack":"Error: Volume test 74\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.201Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 75 general errors in the last minute (threshold: 15)","correlationId":"b9f642af","category":"general","currentCount":75,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 75 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.202Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 75","stack":"Error: Volume test 75\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.203Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 76 general errors in the last minute (threshold: 15)","correlationId":"302cd7b0","category":"general","currentCount":76,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 76 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.204Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 76","stack":"Error: Volume test 76\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.204Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 77 general errors in the last minute (threshold: 15)","correlationId":"38e95af3","category":"general","currentCount":77,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 77 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.205Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 77","stack":"Error: Volume test 77\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.205Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 78 general errors in the last minute (threshold: 15)","correlationId":"45676f76","category":"general","currentCount":78,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 78 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.206Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 78","stack":"Error: Volume test 78\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.207Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 79 general errors in the last minute (threshold: 15)","correlationId":"6ff5bb01","category":"general","currentCount":79,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 79 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.208Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 79","stack":"Error: Volume test 79\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.208Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 80 general errors in the last minute (threshold: 15)","correlationId":"7daf10e9","category":"general","currentCount":80,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 80 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.209Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 80","stack":"Error: Volume test 80\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.210Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 81 general errors in the last minute (threshold: 15)","correlationId":"053d9754","category":"general","currentCount":81,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 81 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.211Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 81","stack":"Error: Volume test 81\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.211Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 82 general errors in the last minute (threshold: 15)","correlationId":"16e285ce","category":"general","currentCount":82,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 82 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.212Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 82","stack":"Error: Volume test 82\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.212Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 83 general errors in the last minute (threshold: 15)","correlationId":"298609e8","category":"general","currentCount":83,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 83 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.213Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 83","stack":"Error: Volume test 83\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.214Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 84 general errors in the last minute (threshold: 15)","correlationId":"8eb6c605","category":"general","currentCount":84,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 84 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.215Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 84","stack":"Error: Volume test 84\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.215Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 85 general errors in the last minute (threshold: 15)","correlationId":"33c59932","category":"general","currentCount":85,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 85 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.216Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 85","stack":"Error: Volume test 85\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.217Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 86 general errors in the last minute (threshold: 15)","correlationId":"6b40cdc1","category":"general","currentCount":86,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 86 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.218Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 86","stack":"Error: Volume test 86\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.218Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 87 general errors in the last minute (threshold: 15)","correlationId":"ee5864aa","category":"general","currentCount":87,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 87 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.222Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 87","stack":"Error: Volume test 87\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.222Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 88 general errors in the last minute (threshold: 15)","correlationId":"a6d61355","category":"general","currentCount":88,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 88 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.223Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 88","stack":"Error: Volume test 88\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.224Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 89 general errors in the last minute (threshold: 15)","correlationId":"51799308","category":"general","currentCount":89,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 89 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.225Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 89","stack":"Error: Volume test 89\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.225Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 90 general errors in the last minute (threshold: 15)","correlationId":"487a2d30","category":"general","currentCount":90,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 90 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.226Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 90","stack":"Error: Volume test 90\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.227Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 91 general errors in the last minute (threshold: 15)","correlationId":"e44cabbc","category":"general","currentCount":91,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 91 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.227Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 91","stack":"Error: Volume test 91\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.228Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 92 general errors in the last minute (threshold: 15)","correlationId":"ae052970","category":"general","currentCount":92,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 92 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.229Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 92","stack":"Error: Volume test 92\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.230Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 93 general errors in the last minute (threshold: 15)","correlationId":"08e402bc","category":"general","currentCount":93,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 93 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.230Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 93","stack":"Error: Volume test 93\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.231Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 94 general errors in the last minute (threshold: 15)","correlationId":"352bd452","category":"general","currentCount":94,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 94 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.232Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 94","stack":"Error: Volume test 94\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.232Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 95 general errors in the last minute (threshold: 15)","correlationId":"324fec16","category":"general","currentCount":95,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 95 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.233Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 95","stack":"Error: Volume test 95\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.233Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 96 general errors in the last minute (threshold: 15)","correlationId":"245dfeb4","category":"general","currentCount":96,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 96 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.234Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 96","stack":"Error: Volume test 96\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.235Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 97 general errors in the last minute (threshold: 15)","correlationId":"20648182","category":"general","currentCount":97,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 97 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.235Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 97","stack":"Error: Volume test 97\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.236Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 98 general errors in the last minute (threshold: 15)","correlationId":"d878e211","category":"general","currentCount":98,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 98 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.237Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 98","stack":"Error: Volume test 98\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.237Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 99 general errors in the last minute (threshold: 15)","correlationId":"4a6869ab","category":"general","currentCount":99,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 99 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.238Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Volume test 99","stack":"Error: Volume test 99\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:331:37)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.238Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 100 general errors in the last minute (threshold: 15)","correlationId":"7223d595","category":"general","currentCount":100,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 100 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.240Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 0","stack":"Error: Perf test 0\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.240Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 1","stack":"Error: Perf test 1\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.241Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 2","stack":"Error: Perf test 2\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.241Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 3","stack":"Error: Perf test 3\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.242Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 4","stack":"Error: Perf test 4\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.242Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 5","stack":"Error: Perf test 5\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.243Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 6","stack":"Error: Perf test 6\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.243Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 7","stack":"Error: Perf test 7\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.244Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 8","stack":"Error: Perf test 8\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.244Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 9","stack":"Error: Perf test 9\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.245Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 10","stack":"Error: Perf test 10\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.245Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 11","stack":"Error: Perf test 11\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.246Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 12","stack":"Error: Perf test 12\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.246Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 13","stack":"Error: Perf test 13\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.247Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 14","stack":"Error: Perf test 14\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.251Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 15 general errors in the last minute (threshold: 15)","correlationId":"ce24aa5a","category":"general","currentCount":15,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 15 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.252Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 15","stack":"Error: Perf test 15\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.252Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 16 general errors in the last minute (threshold: 15)","correlationId":"31023db0","category":"general","currentCount":16,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 16 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.253Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 16","stack":"Error: Perf test 16\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.254Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 17 general errors in the last minute (threshold: 15)","correlationId":"01ffdab0","category":"general","currentCount":17,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 17 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.255Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 17","stack":"Error: Perf test 17\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.255Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 18 general errors in the last minute (threshold: 15)","correlationId":"bd576e72","category":"general","currentCount":18,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 18 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.256Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 18","stack":"Error: Perf test 18\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.257Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 19 general errors in the last minute (threshold: 15)","correlationId":"e208fd3a","category":"general","currentCount":19,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 19 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.257Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 19","stack":"Error: Perf test 19\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.258Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 20 general errors in the last minute (threshold: 15)","correlationId":"6f65ec88","category":"general","currentCount":20,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 20 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.259Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 20","stack":"Error: Perf test 20\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.259Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 21 general errors in the last minute (threshold: 15)","correlationId":"59da977d","category":"general","currentCount":21,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 21 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.261Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 21","stack":"Error: Perf test 21\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.261Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 22 general errors in the last minute (threshold: 15)","correlationId":"03f5ecae","category":"general","currentCount":22,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 22 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.262Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 22","stack":"Error: Perf test 22\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.263Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 23 general errors in the last minute (threshold: 15)","correlationId":"d75e0edc","category":"general","currentCount":23,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 23 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.264Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 23","stack":"Error: Perf test 23\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.264Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 24 general errors in the last minute (threshold: 15)","correlationId":"cceb3a6b","category":"general","currentCount":24,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 24 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.265Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 24","stack":"Error: Perf test 24\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.266Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 25 general errors in the last minute (threshold: 15)","correlationId":"3b15d3ad","category":"general","currentCount":25,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 25 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.270Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 25","stack":"Error: Perf test 25\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.271Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 26 general errors in the last minute (threshold: 15)","correlationId":"b6547d4f","category":"general","currentCount":26,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 26 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.271Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 26","stack":"Error: Perf test 26\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.272Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 27 general errors in the last minute (threshold: 15)","correlationId":"70118873","category":"general","currentCount":27,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 27 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.273Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 27","stack":"Error: Perf test 27\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.273Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 28 general errors in the last minute (threshold: 15)","correlationId":"c6165deb","category":"general","currentCount":28,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 28 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.274Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 28","stack":"Error: Perf test 28\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.275Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 29 general errors in the last minute (threshold: 15)","correlationId":"685be529","category":"general","currentCount":29,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 29 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.276Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 29","stack":"Error: Perf test 29\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.276Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 30 general errors in the last minute (threshold: 15)","correlationId":"7cbd6041","category":"general","currentCount":30,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 30 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.277Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 30","stack":"Error: Perf test 30\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.278Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 31 general errors in the last minute (threshold: 15)","correlationId":"1a5a74e9","category":"general","currentCount":31,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 31 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.279Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 31","stack":"Error: Perf test 31\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.279Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 32 general errors in the last minute (threshold: 15)","correlationId":"c5168995","category":"general","currentCount":32,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 32 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.280Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 32","stack":"Error: Perf test 32\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.281Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 33 general errors in the last minute (threshold: 15)","correlationId":"1503716a","category":"general","currentCount":33,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 33 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.281Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 33","stack":"Error: Perf test 33\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.282Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 34 general errors in the last minute (threshold: 15)","correlationId":"ba06d8f3","category":"general","currentCount":34,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 34 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.286Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 34","stack":"Error: Perf test 34\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.287Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 35 general errors in the last minute (threshold: 15)","correlationId":"b85e8584","category":"general","currentCount":35,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 35 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.287Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 35","stack":"Error: Perf test 35\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.288Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 36 general errors in the last minute (threshold: 15)","correlationId":"f22f3717","category":"general","currentCount":36,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 36 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.289Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 36","stack":"Error: Perf test 36\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.289Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 37 general errors in the last minute (threshold: 15)","correlationId":"34050b8c","category":"general","currentCount":37,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 37 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.290Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 37","stack":"Error: Perf test 37\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.291Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 38 general errors in the last minute (threshold: 15)","correlationId":"4f70d679","category":"general","currentCount":38,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 38 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.292Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 38","stack":"Error: Perf test 38\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.292Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 39 general errors in the last minute (threshold: 15)","correlationId":"30044824","category":"general","currentCount":39,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 39 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.293Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 39","stack":"Error: Perf test 39\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.293Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 40 general errors in the last minute (threshold: 15)","correlationId":"71b63754","category":"general","currentCount":40,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 40 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.294Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 40","stack":"Error: Perf test 40\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.295Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 41 general errors in the last minute (threshold: 15)","correlationId":"381c3229","category":"general","currentCount":41,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 41 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.296Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 41","stack":"Error: Perf test 41\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.296Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 42 general errors in the last minute (threshold: 15)","correlationId":"18732de5","category":"general","currentCount":42,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 42 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.297Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 42","stack":"Error: Perf test 42\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.298Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 43 general errors in the last minute (threshold: 15)","correlationId":"bbae450d","category":"general","currentCount":43,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 43 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.299Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 43","stack":"Error: Perf test 43\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.299Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 44 general errors in the last minute (threshold: 15)","correlationId":"cb00b590","category":"general","currentCount":44,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 44 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.300Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 44","stack":"Error: Perf test 44\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.301Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 45 general errors in the last minute (threshold: 15)","correlationId":"a869a9bc","category":"general","currentCount":45,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 45 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.302Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 45","stack":"Error: Perf test 45\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.302Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 46 general errors in the last minute (threshold: 15)","correlationId":"4179434a","category":"general","currentCount":46,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 46 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.303Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 46","stack":"Error: Perf test 46\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.304Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 47 general errors in the last minute (threshold: 15)","correlationId":"445d3164","category":"general","currentCount":47,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 47 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.305Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 47","stack":"Error: Perf test 47\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.305Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 48 general errors in the last minute (threshold: 15)","correlationId":"6c745768","category":"general","currentCount":48,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 48 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.306Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 48","stack":"Error: Perf test 48\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.307Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 49 general errors in the last minute (threshold: 15)","correlationId":"fa37b68c","category":"general","currentCount":49,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 49 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.307Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Perf test 49","stack":"Error: Perf test 49\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:349:33)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","category":"general","severity":"ERROR","context":{}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    {"timestamp":"2025-09-23T13:40:30.308Z","level":"WARN","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"High error rate detected: 50 general errors in the last minute (threshold: 15)","correlationId":"e9cdfd56","category":"general","currentCount":50,"threshold":15,"severity":"WARN"}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    🚨 ALERT: High error rate detected: 50 general errors in the last minute (threshold: 15)

      at ErrorTracker.log [as sendAlert] (utils/errorTracker.js:240:13)

  console.log
    {"timestamp":"2025-09-23T13:40:30.310Z","level":"ERROR","service":"financial-platform-api","environment":"test","version":"1.0.0","message":"Middleware test error","correlationId":"test-123","stack":"Error: Middleware test error\n    at Object.<anonymous> (/home/stocks/algo/webapp/lambda/tests/integration/utils/errorTracker.test.js:391:25)\n    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)","name":"Error","route":"/test","method":"GET","userAgent":"test-user-agent","ip":"127.0.0.1","category":"general","severity":"ERROR","context":{"correlationId":"test-123","route":"/test","method":"GET","userAgent":"test-user-agent","ip":"127.0.0.1","body":{},"query":{},"params":{}}}

      at Logger.log [as output] (utils/logger.js:91:15)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/utils/errorTracker.test.js
  Error Tracker Integration Tests
    Error Tracking
      ✓ should track errors with context (10 ms)
      ✓ should track errors with stack traces (1 ms)
      ✓ should categorize errors correctly (3 ms)
      ✓ should calculate severity levels (7 ms)
    Error Statistics
      ✓ should provide error statistics (4 ms)
      ✓ should track recent errors with limit (6 ms)
    Error Frequency Tracking
      ✓ should track error counts by category and time (3 ms)
      ✓ should handle concurrent error tracking (24 ms)
    Alert System
      ✓ should track errors without triggering alerts for low volume (1 ms)
      ✓ should handle different error categories simultaneously (3 ms)
    Error Context Tracking
      ✓ should preserve error context information (1 ms)
      ✓ should generate unique error IDs (2 ms)
    Error History Management
      ✓ should maintain error history with size limit (88 ms)
      ✓ should clear history when requested (3 ms)
    Performance
      ✓ should handle high volume error logging efficiently (148 ms)
      ✓ should maintain performance for statistics retrieval (69 ms)
    Integration Features
      ✓ should provide middleware integration capability
      ✓ should handle middleware error processing (2 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search HTTP/1.1" 200 129 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q= HTTP/1.1" 200 129 "-" "-"
  console.log
    🔍 Stock search requested for: A

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=A&limit=10 HTTP/1.1" 200 711 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
  console.log
    FIXED stock endpoint called for: AAPL

      at log (routes/stocks.js:2511:13)

  console.log
    FIXED stock endpoint - executing query for AAPL

      at log (routes/stocks.js:2539:13)

  console.log
    FIXED stock endpoint - query result: 1 rows

      at log (routes/stocks.js:2544:15)

  console.log
    FIXED stock endpoint - first row data: {
      symbol: 'AAPL',
      company_name: 'AAPL',
      sector: null,
      exchange: null,
      market_category: null,
      market_cap: '3500000000000',
      current_price: null,
      open: null,
      high: null,
      low: null,
      volume: null,
      price_date: null
    }

      at log (routes/stocks.js:2560:15)

  console.log
    ✅ FIXED: Successfully returned data for AAPL with price: null

      at log (routes/stocks.js:2625:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL HTTP/1.1" 200 378 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/INVALID HTTP/1.1" 400 130 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/VERYLONGSYMBOLNAME123456 HTTP/1.1" 400 147 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/@ HTTP/1.1" 400 124 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'missing FROM-clause entry for table "ss"',
      query: '\n' +
        '      SELECT\n' +
        '        pd.symbol,\n' +
        '        NULL as name,\n' +
        '        pd.close as current_price,\n' +
        '        pd...',
      params: '1 parameters',
      code: '42P01'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/stocks.js:1765:20

  console.error
    Trending stocks error: missing FROM-clause entry for table "ss"

      1774 |     });
      1775 |   } catch (error) {
    > 1776 |     console.error("Trending stocks error:", error.message);
           |             ^
      1777 |     res.status(500).json({
      1778 |       success: false,
      1779 |       error: "Failed to fetch trending stocks",

      at error (routes/stocks.js:1776:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/trending HTTP/1.1" 500 114 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'missing FROM-clause entry for table "ss"',
      query: '\n' +
        '      SELECT\n' +
        '        pd.symbol,\n' +
        '        NULL as name,\n' +
        '        pd.close as current_price,\n' +
        '        pd...',
      params: '1 parameters',
      code: '42P01'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/stocks.js:1765:20

  console.error
    Trending stocks error: missing FROM-clause entry for table "ss"

      1774 |     });
      1775 |   } catch (error) {
    > 1776 |     console.error("Trending stocks error:", error.message);
           |             ^
      1777 |     res.status(500).json({
      1778 |       success: false,
      1779 |       error: "Failed to fetch trending stocks",

      at error (routes/stocks.js:1776:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/trending?timeframe=1d HTTP/1.1" 500 114 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/trending HTTP/1.1" 401 529 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/screener HTTP/1.1" 200 489 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/screener?market_cap_min=1000000&pe_ratio_max=20 HTTP/1.1" 200 489 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/watchlist HTTP/1.1" 301 164 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "POST /api/stocks/watchlist/add HTTP/1.1" 200 140 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "POST /api/stocks/watchlist/add HTTP/1.1" 400 58 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "DELETE /api/stocks/watchlist/remove HTTP/1.1" 200 147 "-" "-"
  console.log
    Alternative stock quote request for AAPL

      at log (routes/stocks.js:3534:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/quote HTTP/1.1" 200 258 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/technicals HTTP/1.1" 200 124 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/options HTTP/1.1" 200 113 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/insider HTTP/1.1" 200 128 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/analysts HTTP/1.1" 200 124 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/earnings HTTP/1.1" 200 115 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/dividends HTTP/1.1" 200 116 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/sentiment HTTP/1.1" 200 121 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/AAPL/social HTTP/1.1" 200 122 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:30 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

  console.log
    🔍 Stock search requested for: A

      at log (routes/stocks.js:1244:13)

  console.log
    FIXED stock endpoint called for: AAPL

      at log (routes/stocks.js:2511:13)

  console.log
    FIXED stock endpoint - executing query for AAPL

      at log (routes/stocks.js:2539:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    FIXED stock endpoint - query result: 1 rows

      at log (routes/stocks.js:2544:15)

  console.log
    FIXED stock endpoint - first row data: {
      symbol: 'AAPL',
      company_name: 'AAPL',
      sector: null,
      exchange: null,
      market_category: null,
      market_cap: '3500000000000',
      current_price: null,
      open: null,
      high: null,
      low: null,
      volume: null,
      price_date: null
    }

      at log (routes/stocks.js:2560:15)

  console.log
    ✅ FIXED: Successfully returned data for AAPL with price: null

      at log (routes/stocks.js:2625:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/AAPL HTTP/1.1" 200 378 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/search?q=A HTTP/1.1" 200 711 "-" "-"
  console.error
    Database query error: {
      error: 'missing FROM-clause entry for table "ss"',
      query: '\n' +
        '      SELECT\n' +
        '        pd.symbol,\n' +
        '        NULL as name,\n' +
        '        pd.close as current_price,\n' +
        '        pd...',
      params: '1 parameters',
      code: '42P01'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/stocks.js:1765:20

  console.error
    Trending stocks error: missing FROM-clause entry for table "ss"

      1774 |     });
      1775 |   } catch (error) {
    > 1776 |     console.error("Trending stocks error:", error.message);
           |             ^
      1777 |     res.status(500).json({
      1778 |       success: false,
      1779 |       error: "Failed to fetch trending stocks",

      at error (routes/stocks.js:1776:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/trending HTTP/1.1" 500 114 "-" "-"
  console.log
    🔍 Stock search requested for: A

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/search?q=A&limit=abc HTTP/1.1" 200 711 "-" "-"
  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.error
    Database query error: {
      error: 'missing FROM-clause entry for table "ss"',
      query: '\n' +
        '      SELECT\n' +
        '        pd.symbol,\n' +
        '        NULL as name,\n' +
        '        pd.close as current_price,\n' +
        '        pd...',
      params: '1 parameters',
      code: '42P01'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/stocks.js:1765:20

  console.error
    Trending stocks error: missing FROM-clause entry for table "ss"

      1774 |     });
      1775 |   } catch (error) {
    > 1776 |     console.error("Trending stocks error:", error.message);
           |             ^
      1777 |     res.status(500).json({
      1778 |       success: false,
      1779 |       error: "Failed to fetch trending stocks",

      at error (routes/stocks.js:1776:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/trending?timeframe=INVALID HTTP/1.1" 500 114 "-" "-"
  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
  console.log
    🔍 Stock search requested for: AAPL

      at log (routes/stocks.js:1244:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/search?q=AAPL HTTP/1.1" 200 263 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/%27%3B%20DROP%20TABLE%20stocks%3B%20-- HTTP/1.1" 400 147 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/1%27%20OR%20%271%27%3D%271 HTTP/1.1" 400 135 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/UNION%20SELECT%20*%20FROM%20users HTTP/1.1" 400 148 "-" "-"
  console.log
    Sectors endpoint called (public)

      at log (routes/stocks.js:15:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/sectors HTTP/1.1" 200 69 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/stocks/search?q=%E6%B5%8B%E8%AF%95 HTTP/1.1" 200 172 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/stocks.integration.test.js
  Stocks Routes Integration Tests
    GET /api/stocks/sectors
      ✓ should return sectors data (27 ms)
      ✓ should handle concurrent requests to sectors endpoint (25 ms)
    GET /api/stocks/search
      ✓ should handle search with valid query (15 ms)
      ✓ should require query parameter (1 ms)
      ✓ should handle empty search query (1 ms)
      ✓ should handle search with limit parameter (14 ms)
      ✓ should require authentication for search (13 ms)
    GET /api/stocks/:symbol
      ✓ should handle valid stock symbol (7 ms)
      ✓ should handle invalid stock symbols (1 ms)
      ✓ should handle very long symbol names (1 ms)
      ✓ should handle special characters in symbols (2 ms)
    GET /api/stocks/trending
      ✕ should return trending stocks (9 ms)
      ✕ should handle timeframe parameters (6 ms)
      ✓ should require authentication for trending (2 ms)
    GET /api/stocks/screener
      ✓ should return screener results (17 ms)
      ✓ should handle screener filters (14 ms)
    Watchlist Operations
      ✕ should handle watchlist requests (3 ms)
      ✓ should handle adding to watchlist (4 ms)
      ✓ should validate symbol parameter for watchlist add (2 ms)
      ✓ should handle removing from watchlist (2 ms)
    Stock Data Endpoints
      ✓ should handle stock quote requests (4 ms)
      ✓ should handle stock technicals requests (3 ms)
      ✓ should handle stock options requests (8 ms)
      ✓ should handle stock insider trading requests (3 ms)
      ✓ should handle stock analysts requests (3 ms)
      ✓ should handle stock earnings requests (3 ms)
      ✓ should handle stock dividends requests (3 ms)
      ✓ should handle stock sentiment requests (2 ms)
      ✓ should handle stock social requests (3 ms)
    Authentication Tests
      ✓ should handle requests without authentication (14 ms)
      ✓ should handle malformed authorization headers (15 ms)
      ✓ should handle empty authorization headers (14 ms)
      ✓ should handle missing bearer token (13 ms)
    Error Handling and Edge Cases
      ✕ should handle concurrent requests (22 ms)
      ✕ should handle invalid parameters gracefully (19 ms)
      ✓ should validate response content types (17 ms)
      ✓ should handle SQL injection attempts safely (7 ms)
      ✓ should handle database connection issues gracefully (4 ms)
      ✓ should handle international characters in search (2 ms)

  ● Stocks Routes Integration Tests › GET /api/stocks/trending › should return trending stocks

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      128 |         .set("Authorization", "Bearer dev-bypass-token");
      129 |
    > 130 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      131 |     });
      132 |
      133 |     test("should handle timeframe parameters", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:130:52)

  ● Stocks Routes Integration Tests › GET /api/stocks/trending › should handle timeframe parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      136 |         .set("Authorization", "Bearer dev-bypass-token");
      137 |
    > 138 |       expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                         ^
      139 |     });
      140 |
      141 |     test("should require authentication for trending", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:138:57)

  ● Stocks Routes Integration Tests › Watchlist Operations › should handle watchlist requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      178 |         .set("Authorization", "Bearer dev-bypass-token");
      179 |
    > 180 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      181 |     });
      182 |
      183 |     test("should handle adding to watchlist", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:180:52)

  ● Stocks Routes Integration Tests › Error Handling and Edge Cases › should handle concurrent requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      333 |
      334 |       responses.forEach((response) => {
    > 335 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      336 |       });
      337 |     });
      338 |

      at toBe (tests/integration/routes/stocks.integration.test.js:335:59)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/stocks.integration.test.js:334:17)

  ● Stocks Routes Integration Tests › Error Handling and Edge Cases › should handle invalid parameters gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      352 |       for (const req of invalidRequests) {
      353 |         const response = await req;
    > 354 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      355 |       }
      356 |     });
      357 |

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:354:59)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for QQQ

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/QQQ/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for IWM

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/IWM/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for VTI

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/VTI/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for VOO

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/VOO/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for INVALID

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/INVALID/holdings HTTP/1.1" 404 132 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=5 HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=25 HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=50 HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=100 HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=invalid HTTP/1.1" 200 446 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf//holdings HTTP/1.1" 404 123 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY@ HTTP/1.1" 404 118 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for QQQ, timeframe: 1y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/QQQ/performance HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1D

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=1D HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1W

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=1W HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1M

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=1M HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 3M

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=3M HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 6M

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=6M HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1Y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=1Y HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 3Y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=3Y HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 5Y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?timeframe=5Y HTTP/1.1" 200 560 "-" "-"
  console.log
    📈 ETF performance requested for SPY, timeframe: 1y

      at log (routes/etf.js:167:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/performance?benchmark=SPX HTTP/1.1" 200 560 "-" "-"
  console.log
    📊 ETF analytics requested for SPY, period: 1y

      at log (routes/etf.js:269:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/analytics HTTP/1.1" 200 1091 "-" "-"
  console.log
    📊 ETF analytics requested for VTI, period: 1y

      at log (routes/etf.js:269:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/VTI/analytics HTTP/1.1" 200 1091 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { max_expense_ratio: '0.5' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?max_expense_ratio=0.5 HTTP/1.1" 200 1456 "-" "-"
  console.log
    ETF screener with filters: { min_assets: '1000000000' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?min_assets=1000000000 HTTP/1.1" 200 1510 "-" "-"
  console.log
    ETF screener with filters: { category: 'equity' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?category=equity HTTP/1.1" 200 332 "-" "-"
  console.log
    ETF screener with filters: { category: 'fixed_income' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?category=fixed_income HTTP/1.1" 200 344 "-" "-"
  console.log
    ETF screener with filters: { category: 'commodity' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?category=commodity HTTP/1.1" 200 338 "-" "-"
  console.log
    ETF screener with filters: { category: 'mixed' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?category=mixed HTTP/1.1" 200 330 "-" "-"
  console.log
    ETF screener with filters: { sector: 'Technology' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?sector=Technology HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { min_dividend_yield: '2.0' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?min_dividend_yield=2.0 HTTP/1.1" 200 1028 "-" "-"
  console.log
    ETF screener with filters: {
      category: 'equity',
      max_expense_ratio: '0.5',
      min_assets: '500000000'
    }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?category=equity&max_expense_ratio=0.5&min_assets=500000000 HTTP/1.1" 200 380 "-" "-"
  console.log
    ETF screener with filters: { sort: 'assets', order: 'desc' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?sort=assets&order=desc HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { sort: 'expense_ratio', order: 'desc' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?sort=expense_ratio&order=desc HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { sort: 'dividend_yield', order: 'desc' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?sort=dividend_yield&order=desc HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { sort: 'performance', order: 'desc' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?sort=performance&order=desc HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { page: '1', limit: '25' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?page=1&limit=25 HTTP/1.1" 200 1458 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/compare?symbols=SPY,QQQ,VTI HTTP/1.1" 200 1497 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/compare?symbols=SPY,INVALID,QQQ HTTP/1.1" 200 1513 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/compare?symbols=SPY HTTP/1.1" 200 925 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/compare?symbols=SPY,QQQ&metrics=performance,risk,dividend HTTP/1.1" 200 1255 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/trending HTTP/1.1" 200 407 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/trending?timeframe=1D HTTP/1.1" 200 407 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/trending?timeframe=1W HTTP/1.1" 200 407 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/trending?timeframe=1M HTTP/1.1" 200 407 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/trending?category=equity HTTP/1.1" 200 410 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=1D HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=1W HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=1M HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=3M HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=6M HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?period=1Y HTTP/1.1" 200 396 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/flows?type=equity HTTP/1.1" 200 396 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

  console.log
    📈 ETF holdings requested for QQQ

      at log (routes/etf.js:20:13)

  console.log
    📈 ETF holdings requested for VTI

      at log (routes/etf.js:20:13)

  console.log
    📈 ETF holdings requested for IWM

      at log (routes/etf.js:20:13)

  console.log
    📈 ETF holdings requested for VOO

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/QQQ/holdings HTTP/1.1" 200 446 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/VOO/holdings HTTP/1.1" 200 446 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/IWM/holdings HTTP/1.1" 200 446 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/VTI/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=500 HTTP/1.1" 200 446 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings HTTP/1.1" 200 446 "-" "-"
  console.log
    ETF screener with filters: { max_expense_ratio: 'invalid' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?max_expense_ratio=invalid HTTP/1.1" 200 292 "-" "-"
  console.log
    ETF screener with filters: { page: '-1' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?page=-1 HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: { limit: 'abc' }

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener?limit=abc HTTP/1.1" 200 301 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/compare?symbols= HTTP/1.1" 400 130 "-" "-"
  console.log
    📈 ETF holdings requested for SPY

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/holdings?limit=999999 HTTP/1.1" 200 446 "-" "-"
  console.log
    📈 ETF holdings requested for SPY'; DROP TABLE etf_holdings; --

      at log (routes/etf.js:20:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY%27%3B%20DROP%20TABLE%20etf_holdings%3B%20--/holdings HTTP/1.1" 200 626 "-" "-"
::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/SPY/premium-analytics HTTP/1.1" 404 135 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ETF screener with filters: {}

      at log (routes/etf.js:593:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:31 +0000] "GET /api/etf/screener HTTP/1.1" 200 1458 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/etf.integration.test.js
  ETF Routes Integration Tests
    GET /api/etf/:symbol/holdings
      ✓ should return ETF holdings data for major ETFs (33 ms)
      ✓ should include fund information in holdings response (4 ms)
      ✓ should include sector allocation in holdings response (4 ms)
      ✓ should handle invalid ETF symbol (3 ms)
      ✓ should handle limit parameter validation (14 ms)
      ✓ should handle invalid limit parameter (4 ms)
      ✓ should handle missing symbol parameter (1 ms)
      ✓ should handle special characters in ETF symbol (2 ms)
    GET /api/etf/:symbol/performance
      ✓ should return ETF performance data (4 ms)
      ✓ should include historical performance metrics (6 ms)
      ✓ should handle timeframe parameter (31 ms)
      ✓ should compare performance against benchmark (4 ms)
    GET /api/etf/:symbol/analytics
      ✓ should return comprehensive ETF analytics (6 ms)
      ✓ should include risk analysis metrics (4 ms)
    GET /api/etf/screener
      ✓ should return ETF screener results (4 ms)
      ✓ should handle expense ratio filter (3 ms)
      ✓ should handle asset size filter (3 ms)
      ✓ should handle category filter (10 ms)
      ✓ should handle sector filter (2 ms)
      ✓ should handle dividend yield filter (6 ms)
      ✓ should handle multiple filters combined (5 ms)
      ✓ should handle sorting options (13 ms)
      ✓ should handle pagination parameters (7 ms)
    GET /api/etf/compare
      ✓ should compare multiple ETFs (2 ms)
      ✓ should handle invalid symbol in comparison (1 ms)
      ✓ should handle single ETF comparison (1 ms)
      ✓ should handle comparison metrics parameter (1 ms)
    GET /api/etf/trending
      ✓ should return trending ETFs (1 ms)
      ✓ should handle timeframe for trending (4 ms)
      ✓ should handle category filter for trending (2 ms)
    GET /api/etf/flows
      ✓ should return ETF flow data (2 ms)
      ✓ should handle period parameter for flows (6 ms)
      ✓ should handle fund type filter for flows (1 ms)
    Performance and Edge Cases
      ✓ should handle concurrent ETF holdings requests (25 ms)
      ✓ should handle large holdings requests gracefully (3 ms)
      ✓ should maintain response time consistency (3 ms)
      ✓ should validate data structure consistency (4 ms)
      ✓ should handle database connection failures gracefully (4 ms)
      ✓ should handle malformed query parameters (18 ms)
      ✓ should handle SQL injection attempts (4 ms)
      ✕ should handle authentication edge cases for protected endpoints (1 ms)
      ✓ should handle stress testing with multiple concurrent requests (24 ms)

  ● ETF Routes Integration Tests › Performance and Edge Cases › should handle authentication edge cases for protected endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      496 |         .set("Authorization", "Bearer invalid-token");
      497 |
    > 498 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      499 |     });
      500 |
      501 |     test("should handle stress testing with multiple concurrent requests", async () => {

      at Object.toBe (tests/integration/routes/etf.integration.test.js:498:52)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/database/rollback-scenarios.integration.test.js
  Database Rollback Scenarios Integration
    Automatic Rollback on Error
      ✓ should automatically rollback on SQL errors (19 ms)
      ✓ should rollback on application errors within transaction (3 ms)
    Explicit Rollback Scenarios
      ✓ should handle manual rollback calls (10 ms)
      ✓ should handle nested transaction scenarios (12 ms)
    Rollback with Complex Data Modifications
      ✓ should rollback complex multi-table operations (8 ms)
      ✓ should handle rollback with data type conversions and constraints (6 ms)
    Rollback Recovery and Cleanup
      ✓ should properly clean up resources after rollback (4 ms)
      ✓ should maintain database connection health after rollbacks (9 ms)
    Rollback with Real-World Scenarios
      ✓ should handle portfolio transaction rollback (7 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/unit/middleware/responseFormatter.test.js
  Response Formatter Middleware
    Middleware Setup
      ○ skipped should add API version header
      ○ skipped should add all response methods to res object
    res.success method
      ○ skipped should call responseFormatter.success with correct parameters
      ○ skipped should use default status code 200
      ○ skipped should use default empty meta object
    res.error method
      ○ skipped should call responseFormatter.error with correct parameters
      ○ skipped should use default status code 400
    res.paginated method
      ○ skipped should call responseFormatter.paginated with correct parameters
      ○ skipped should use default empty meta object
    res.validationError method
      ○ skipped should call responseFormatter.validationError with correct parameters
    res.notFound method
      ○ skipped should call responseFormatter.notFound with custom resource
      ○ skipped should use default resource name
    res.unauthorized method
      ○ skipped should call responseFormatter.unauthorized with custom message
      ○ skipped should use default message
    res.forbidden method
      ○ skipped should call responseFormatter.forbidden with custom message
      ○ skipped should use default message
    res.serverError method
      ○ skipped should call responseFormatter.serverError with custom message and details
      ○ skipped should use default message and empty details
    Integration Tests
      ✓ should work with multiple methods in sequence (3 ms)
      ✓ should maintain API version header across all responses (4 ms)
      ✓ should handle chained method calls (2 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/database/cross-service-transaction.integration.test.js
  Cross-Service Transaction Integration
    Service Coordination Patterns
      ✓ should coordinate portfolio and order service transactions (9 ms)
      ✓ should handle cross-service transaction failure and rollback (19 ms)
    Service Dependency Management
      ✓ should handle service dependency chain transactions (8 ms)
      ✓ should handle circular dependency resolution (9 ms)
    Distributed Transaction Patterns
      ✓ should implement saga pattern for long-running transactions (9 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/utils/backtestStore.test.js
  Backtest Store Integration Tests
    Strategy Management Operations
      ✓ should add strategy and return strategy with ID (1 ms)
      ✓ should get strategy by ID (1 ms)
      ✓ should load all stored strategies
      ✓ should delete strategy by ID (1 ms)
      ✓ should return undefined for non-existent strategy
      ✓ should handle empty store gracefully (1 ms)
    File System Integration
      ✓ should persist data to file system
      ✓ should create file if it doesn't exist (1 ms)
      ✓ should save strategies to file system
      ✓ should verify file persistence (1 ms)
    Error Handling
      ✓ should handle concurrent access safely (1 ms)
      ✓ should handle malformed strategy data gracefully (9 ms)
      ✓ should generate unique IDs for strategies (3 ms)
      ✓ should handle large datasets (2 ms)
    Strategy Data Validation
      ✓ should store and retrieve complex strategy data (1 ms)
      ✓ should maintain data integrity across operations (20 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/unit/utils/backtestStore.test.js
  BacktestStore
    loadStrategies
      ○ skipped should return empty array when store file does not exist
      ○ skipped should load and parse strategies from file when it exists
      ○ skipped should handle JSON parse errors gracefully
      ○ skipped should handle file read errors
    saveStrategies
      ○ skipped should write strategies to file as formatted JSON
      ○ skipped should handle empty strategies array
      ○ skipped should handle file write errors
      ○ skipped should handle undefined strategies
      ○ skipped should handle null strategies
    addStrategy
      ○ skipped should add new strategy with generated ID
      ○ skipped should add strategy to empty store
      ○ skipped should preserve existing strategy properties
      ○ skipped should generate unique IDs for multiple strategies
      ○ skipped should handle strategy without name
    getStrategy
      ○ skipped should return strategy with matching ID
      ○ skipped should return undefined for non-existent ID
      ○ skipped should return undefined when store is empty
      ○ skipped should handle null ID
      ○ skipped should handle undefined ID
      ○ skipped should perform string comparison for ID
    deleteStrategy
      ○ skipped should remove strategy with matching ID
      ○ skipped should not modify store when ID does not exist
      ○ skipped should handle empty store
      ○ skipped should remove all strategies with matching ID
      ○ skipped should handle null ID
      ○ skipped should handle undefined ID
      ○ skipped should perform string comparison for ID
    integration scenarios
      ✓ should support full CRUD operations lifecycle (1 ms)
      ✓ should handle concurrent access scenarios
      ✓ should maintain data consistency after multiple operations

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/unit/utils/responseFormatter.test.js
  ResponseFormatter
    success
      ○ skipped should format basic success response with default status code
      ○ skipped should format success response with custom status code
      ○ skipped should include metadata in response
      ○ skipped should handle null and undefined data
      ○ skipped should handle complex data objects
      ○ skipped should preserve array data
    error
      ○ skipped should format basic error response with default status code
      ○ skipped should format error response with custom status code
      ○ skipped should include error details
      ○ skipped should override default service when provided in details
      ○ skipped should handle empty details object
    paginated
      ○ skipped should format paginated response with default pagination
      ○ skipped should format paginated response with custom pagination
      ○ skipped should calculate totalPages correctly
      ○ skipped should include metadata in paginated response
      ○ skipped should handle empty data array
      ○ skipped should use data length as default total
    validationError
      ○ skipped should format validation error with single error
      ○ skipped should format validation error with multiple errors
      ○ skipped should include default troubleshooting steps
      ○ skipped should merge custom troubleshooting details
    notFound
      ○ skipped should format not found error with default resource
      ○ skipped should format not found error with custom resource
      ○ skipped should include default troubleshooting for not found
      ○ skipped should merge custom troubleshooting for not found
    unauthorized
      ○ skipped should format unauthorized error with default message
      ○ skipped should format unauthorized error with custom message
      ○ skipped should include auth-specific troubleshooting
      ○ skipped should merge custom troubleshooting for unauthorized
    forbidden
      ○ skipped should format forbidden error with default message
      ○ skipped should format forbidden error with custom message
      ○ skipped should include permission-specific troubleshooting
    serverError
      ○ skipped should format server error with default message
      ○ skipped should format server error with custom message
      ○ skipped should include server error troubleshooting
      ○ skipped should include error details in server error
    edge cases and integration
      ✓ should handle timestamp generation consistently (1 ms)
      ✓ should maintain response structure consistency
      ✓ should handle special characters in messages
      ✓ should handle very long error messages (1 ms)
      ✓ should preserve data types in success responses

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/unit/utils/sentimentEngine.test.js
  SentimentEngine
    calculateMarketSentiment
      ○ skipped should return neutral sentiment with default values
      ○ skipped should accept data parameter
      ○ skipped should handle errors gracefully
    scoreToLabel
      ○ skipped should return "positive" for high scores
      ○ skipped should return "negative" for low scores
      ○ skipped should return "neutral" for middle scores
      ○ skipped should handle invalid inputs
      ○ skipped should handle errors gracefully
    analyzeSentiment
      ○ skipped should analyze positive sentiment text
      ○ skipped should analyze negative sentiment text
      ○ skipped should analyze neutral text
      ○ skipped should analyze mixed sentiment text
      ○ skipped should handle case insensitive matching
      ○ skipped should handle partial word matches
      ○ skipped should calculate confidence based on sentiment word density
      ○ skipped should handle empty or invalid text input
      ○ skipped should handle non-string input
      ○ skipped should round score and confidence to 2 decimal places
      ○ skipped should cap confidence at 0.8
      ○ skipped should handle symbol parameter correctly
      ○ skipped should handle errors during analysis gracefully
      ○ skipped should handle edge case with only whitespace
      ○ skipped should validate all required fields in response
    integration tests
      ✓ should maintain consistent scoring across multiple calls (1 ms)
      ✓ should handle complex real-world text samples

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/unit/services/alpacaIntegration.test.js
  Alpaca Integration Service Unit Tests
    Account Information
      ✕ should retrieve account information (1 ms)
      ✓ should handle account information errors (1 ms)
      ✓ should handle missing API keys
    Portfolio Positions
      ✓ should retrieve current positions (1 ms)
      ✓ should handle empty positions
      ✓ should handle positions API errors
    Order Management
      ✓ should retrieve order history (1 ms)
      ✓ should place market buy order
      ✓ should place limit sell order
      ✓ should handle order placement errors
      ✓ should validate order parameters (1 ms)
    Market Data
      ✓ should retrieve real-time quotes
      ✓ should handle market data API errors (1 ms)
      ✓ should handle empty symbol list
    Portfolio History
      ✓ should retrieve portfolio performance history (5 ms)
      ✓ should handle portfolio history errors
    Database Integration
      ✓ should store portfolio data in database (1 ms)
      ✓ should handle database insertion errors
    Error Handling
      ✓ should handle network timeouts (1 ms)
      ✕ should handle authentication failures
      ✓ should handle API rate limiting
      ✓ should handle malformed API responses

  ● Alpaca Integration Service Unit Tests › Account Information › should retrieve account information

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "test-user-123", "alpaca"

    Number of calls: 0

      55 |       expect(result).toEqual(mockAccountInfo);
      56 |       expect(alpacaService.getAccountInfo).toHaveBeenCalledWith(testUserId);
    > 57 |       expect(getDecryptedApiKey).toHaveBeenCalledWith(testUserId, "alpaca");
         |                                  ^
      58 |     });
      59 |
      60 |     test("should handle account information errors", async () => {

      at Object.toHaveBeenCalledWith (tests/unit/services/alpacaIntegration.test.js:57:34)

  ● Alpaca Integration Service Unit Tests › Error Handling › should handle authentication failures

    expect(received).rejects.toThrow(expected)

    Expected substring: "Invalid API credentials"
    Received message:   "Request timeout"

          391 |     test("should handle network timeouts", async () => {
          392 |       alpacaService.getAccountInfo.mockRejectedValue(
        > 393 |         new Error("Request timeout")
              |         ^
          394 |       );
          395 |
          396 |       await expect(alpacaService.getAccountInfo(testUserId)).rejects.toThrow(

      at Object.<anonymous> (tests/unit/services/alpacaIntegration.test.js:393:9)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/unit/services/alpacaIntegration.test.js:406:70)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/utils/responseFormatter.test.js
  Response Formatter Integration Tests
    Success Response Formatting
      ✓ should format successful API responses (1 ms)
      ✓ should handle array data in responses
    Error Response Formatting
      ✓ should format client errors (4xx)
      ✓ should format server errors (5xx)
    Paginated Response Formatting
      ✓ should format paginated responses correctly (1 ms)
    Validation Error Formatting
      ✓ should format validation errors

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Initializing database connection...

      at log (index.js:362:13)

  console.log
    Database connection established successfully

      at log (index.js:388:17)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 10 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?page=1&limit=10 HTTP/1.1" 200 2816 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?search=AAPL HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?sector=Technology HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?minScore=50&maxScore=100 HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 53 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?limit=300 HTTP/1.1" 200 14110 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?page=invalid&limit=not_a_number&minScore=invalid&maxScore=invalid HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores/nonexistent

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores requested for symbol: NONEXISTENT

      at log (routes/scores.js:168:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/nonexistent HTTP/1.1" 404 106 "-" "-"
  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?search=%27%3B%20DROP%20TABLE%20stock_symbols%3B%20--&sector=Technology%27%3B%20DELETE%20FROM%20company_profile%3B%20-- HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?search=%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&sector=%3Cimg%20src%3Dx%20onerror%3Dalert%28%27xss%27%29%3E HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Scores endpoint called

      at log (routes/scores.js:23:13)

  console.log
    Executing scores query with timeout protection

      at log (routes/scores.js:58:15)

  console.log
    Scores query result: 50 rows

      at log (routes/scores.js:67:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores?search=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa HTTP/1.1" 200 13324 "-" "-"
  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    Processing request: GET /scores/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:33 +0000] "GET /scores/ping HTTP/1.1" 200 74 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/routes/scores.integration.test.js
  Scores Routes Integration
    GET /scores/ping
      ✓ should return ping response (8 ms)
    GET /scores
      ✓ should return scores data with AWS-compatible structure (25 ms)
      ✓ should handle pagination parameters (23 ms)
      ✓ should handle search parameter (20 ms)
      ✓ should handle sector filter (20 ms)
      ✓ should handle score range filters (25 ms)
      ✓ should handle sorting parameters (23 ms)
      ✓ should handle limit boundary conditions (21 ms)
      ✓ should handle invalid parameters gracefully (24 ms)
    Error handling
      ✓ should handle invalid endpoints (5 ms)
      ✓ should return consistent response format (3 ms)
      ✓ should handle database connection issues (21 ms)
    Security tests
      ✓ should handle SQL injection attempts (22 ms)
      ✓ should handle XSS attempts (20 ms)
      ✓ should handle large payloads (29 ms)
    Performance tests
      ✓ should respond within reasonable time (3 ms)
      ✓ should handle concurrent requests (9 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Initializing database connection...

      at log (index.js:362:13)

  console.log
    Database connection established successfully

      at log (index.js:388:17)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk?type=portfolio HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk?symbol=AAPL HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk/analysis

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚠️ Risk analysis requested for user: dev-user-bypass, period: 1y

      at log (routes/risk.js:39:13)

  console.error
    Database query error: {
      error: 'column s.short_name does not exist',
      query: '\n' +
        '      SELECT\n' +
        '        h.symbol, h.quantity, h.average_cost, h.current_price,\n' +
        '        s.sector, s.sho...',
      params: '1 parameters',
      code: '42703'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/risk.js:56:28

  console.error
    Risk analysis error: error: column s.short_name does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1347:20)
        at /home/stocks/algo/webapp/lambda/routes/risk.js:56:28 {
      length: 110,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '96',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      226 |     });
      227 |   } catch (error) {
    > 228 |     console.error("Risk analysis error:", error);
          |             ^
      229 |     res.status(500).json({
      230 |       success: false,
      231 |       error: "Failed to perform risk analysis",

      at error (routes/risk.js:228:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/analysis?period=1y&confidence_level=0.95 HTTP/1.1" 500 106 "-" "-"
  console.log
    Processing request: GET /risk/analysis

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚠️ Risk analysis requested for user: dev-user-bypass, period: 1m

      at log (routes/risk.js:39:13)

  console.error
    Database query error: {
      error: 'column s.short_name does not exist',
      query: '\n' +
        '      SELECT\n' +
        '        h.symbol, h.quantity, h.average_cost, h.current_price,\n' +
        '        s.sector, s.sho...',
      params: '1 parameters',
      code: '42703'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/risk.js:56:28

  console.error
    Risk analysis error: error: column s.short_name does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1347:20)
        at /home/stocks/algo/webapp/lambda/routes/risk.js:56:28 {
      length: 110,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '96',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      226 |     });
      227 |   } catch (error) {
    > 228 |     console.error("Risk analysis error:", error);
          |             ^
      229 |     res.status(500).json({
      230 |       success: false,
      231 |       error: "Failed to perform risk analysis",

      at error (routes/risk.js:228:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/analysis?period=1m HTTP/1.1" 500 106 "-" "-"
  console.log
    Processing request: GET /risk/analysis

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚠️ Risk analysis requested for user: dev-user-bypass, period: 1m

      at log (routes/risk.js:39:13)

  console.error
    Database query error: {
      error: 'column s.short_name does not exist',
      query: '\n' +
        '      SELECT\n' +
        '        h.symbol, h.quantity, h.average_cost, h.current_price,\n' +
        '        s.sector, s.sho...',
      params: '1 parameters',
      code: '42703'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/risk.js:56:28

  console.error
    Risk analysis error: error: column s.short_name does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1347:20)
        at /home/stocks/algo/webapp/lambda/routes/risk.js:56:28 {
      length: 110,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '96',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      226 |     });
      227 |   } catch (error) {
    > 228 |     console.error("Risk analysis error:", error);
          |             ^
      229 |     res.status(500).json({
      230 |       success: false,
      231 |       error: "Failed to perform risk analysis",

      at error (routes/risk.js:228:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/analysis HTTP/1.1" 500 106 "-" "-"
  console.log
    Processing request: GET /risk/health

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/health HTTP/1.1" 200 134 "-" "-"
  console.log
    Processing request: GET /risk/nonexistent

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/nonexistent HTTP/1.1" 404 614 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk?symbol=%27%3B%20DROP%20TABLE%20trading_alerts%3B%20--&type=portfolio%27%3B%20DELETE%20FROM%20risk_metrics%3B%20-- HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk/analysis

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚠️ Risk analysis requested for user: dev-user-bypass, period: <script>alert('xss')</script>

      at log (routes/risk.js:39:13)

  console.error
    Database query error: {
      error: 'column s.short_name does not exist',
      query: '\n' +
        '      SELECT\n' +
        '        h.symbol, h.quantity, h.average_cost, h.current_price,\n' +
        '        s.sector, s.sho...',
      params: '1 parameters',
      code: '42703'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/risk.js:56:28

  console.error
    Risk analysis error: error: column s.short_name does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1347:20)
        at /home/stocks/algo/webapp/lambda/routes/risk.js:56:28 {
      length: 110,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '96',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      226 |     });
      227 |   } catch (error) {
    > 228 |     console.error("Risk analysis error:", error);
          |             ^
      229 |     res.status(500).json({
      230 |       success: false,
      231 |       error: "Failed to perform risk analysis",

      at error (routes/risk.js:228:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/analysis?period=%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&confidence_level=%3Cimg%20src%3Dx%20onerror%3Dalert%28%27xss%27%29%3E HTTP/1.1" 500 106 "-" "-"
  console.log
    Processing request: GET /risk/analysis

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

  console.log
    ⚠️ Risk analysis requested for user: dev-user-bypass, period: '; DROP TABLE portfolio_holdings; --

      at log (routes/risk.js:39:13)

  console.error
    Database query error: {
      error: 'column s.short_name does not exist',
      query: '\n' +
        '      SELECT\n' +
        '        h.symbol, h.quantity, h.average_cost, h.current_price,\n' +
        '        s.sector, s.sho...',
      params: '1 parameters',
      code: '42703'
    }

      1369 |         query: text.slice(0, 80) + (text.length > 80 ? "..." : ""),
      1370 |         rows: result.rowCount,
    > 1371 |       });
           |          ^
      1372 |     }
      1373 |
      1374 |     return result;

      at cov_auk92v9qg (utils/database.js:1371:74)
      at routes/risk.js:56:28

  console.error
    Risk analysis error: error: column s.short_name does not exist
        at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
        at processTicksAndRejections (node:internal/process/task_queues:95:5)
        at query (/home/stocks/algo/webapp/lambda/utils/database.js:1347:20)
        at /home/stocks/algo/webapp/lambda/routes/risk.js:56:28 {
      length: 110,
      severity: 'ERROR',
      code: '42703',
      detail: undefined,
      hint: undefined,
      position: '96',
      internalPosition: undefined,
      internalQuery: undefined,
      where: undefined,
      schema: undefined,
      table: undefined,
      column: undefined,
      dataType: undefined,
      constraint: undefined,
      file: 'parse_relation.c',
      line: '3722',
      routine: 'errorMissingColumn'
    }

      226 |     });
      227 |   } catch (error) {
    > 228 |     console.error("Risk analysis error:", error);
          |             ^
      229 |     res.status(500).json({
      230 |       success: false,
      231 |       error: "Failed to perform risk analysis",

      at error (routes/risk.js:228:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk/analysis?period=%27%3B%20DROP%20TABLE%20portfolio_holdings%3B%20--&confidence_level=999999 HTTP/1.1" 500 106 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    Processing request: GET /risk

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:34 +0000] "GET /risk HTTP/1.1" 200 125 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/risk.integration.test.js
  Risk Routes Integration
    GET /risk
      ✓ should return risk analysis data (5 ms)
      ✓ should handle portfolio risk analysis (4 ms)
      ✓ should handle individual stock risk analysis (3 ms)
    GET /risk/analysis
      ✕ should handle risk analysis requests (30 ms)
      ✕ should handle different time periods (11 ms)
      ✕ should handle missing query parameters (11 ms)
    GET /risk/health
      ✓ should return health status (6 ms)
    Error handling
      ✓ should handle invalid endpoints (4 ms)
      ✓ should return consistent response format (6 ms)
      ✓ should handle database connection issues (4 ms)
    Security tests
      ✓ should handle SQL injection attempts (3 ms)
      ✕ should handle XSS attempts in query parameters (12 ms)
      ✕ should handle malicious query parameters (11 ms)
    Performance tests
      ✓ should respond within reasonable time (4 ms)
      ✓ should handle concurrent requests (11 ms)

  ● Risk Routes Integration › GET /risk/analysis › should handle risk analysis requests

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      60 |         });
      61 |
    > 62 |       expect(response.status).toBe(200);
         |                               ^
      63 |       expect(response.body).toBeDefined();
      64 |       expect(response.body).toHaveProperty("success", true);
      65 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:62:31)

  ● Risk Routes Integration › GET /risk/analysis › should handle different time periods

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      71 |         .query({ period: "1m" });
      72 |
    > 73 |       expect(response.status).toBe(200);
         |                               ^
      74 |       expect(response.body).toBeDefined();
      75 |       expect(response.body).toHaveProperty("success", true);
      76 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:73:31)

  ● Risk Routes Integration › GET /risk/analysis › should handle missing query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      81 |         .set("Authorization", "Bearer dev-bypass-token");
      82 |
    > 83 |       expect(response.status).toBe(200);
         |                               ^
      84 |       expect(response.body).toBeDefined();
      85 |       expect(response.body).toHaveProperty("success", true);
      86 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:83:31)

  ● Risk Routes Integration › Security tests › should handle XSS attempts in query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      144 |         });
      145 |
    > 146 |       expect(response.status).toBe(200);
          |                               ^
      147 |       expect(response.body).toBeDefined();
      148 |     });
      149 |

      at Object.toBe (tests/integration/routes/risk.integration.test.js:146:31)

  ● Risk Routes Integration › Security tests › should handle malicious query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      157 |         });
      158 |
    > 159 |       expect(response.status).toBe(200);
          |                               ^
      160 |       expect(response.body).toBeDefined();
      161 |     });
      162 |   });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:159:31)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Initializing database connection...

      at log (index.js:362:13)

  console.log
    Database connection established successfully

      at log (index.js:388:17)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?page=1&limit=10 HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?search=AAPL HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?sector=Technology HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?minMetric=0.5&maxMetric=1 HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?sortBy=composite_metric&sortOrder=desc HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?limit=300 HTTP/1.1" 200 459 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?page=invalid&limit=not_a_number&minMetric=invalid&maxMetric=invalid HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics/nonexistent

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics requested for symbol: NONEXISTENT

      at log (routes/metrics.js:287:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/nonexistent HTTP/1.1" 404 106 "-" "-"
  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics/ping

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics/ping HTTP/1.1" 200 75 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?search=%27%3B%20DROP%20TABLE%20stock_symbols%3B%20--&sector=Technology%27%3B%20DELETE%20FROM%20company_profile%3B%20-- HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?search=%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&sector=%3Cimg%20src%3Dx%20onerror%3Dalert%28%27xss%27%29%3E HTTP/1.1" 200 458 "-" "-"
  console.log
    Processing request: GET /metrics

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    📊 Metrics endpoint called

      at log (routes/metrics.js:152:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /metrics?search=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa HTTP/1.1" 200 458 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

PASS tests/integration/routes/metrics.integration.test.js
  Metrics Routes Integration
    GET /metrics/ping
      ✓ should return ping response (8 ms)
    GET /metrics
      ✓ should return metrics data (7 ms)
      ✓ should handle pagination parameters (4 ms)
      ✓ should handle search parameter (7 ms)
      ✓ should handle sector filter (4 ms)
      ✓ should handle metric range filters (4 ms)
      ✓ should handle sorting parameters (4 ms)
      ✓ should handle limit boundary conditions (4 ms)
      ✓ should handle invalid parameters gracefully (4 ms)
    Error handling
      ✓ should handle invalid endpoints (5 ms)
      ✓ should return consistent response format (4 ms)
      ✓ should handle database connection issues (9 ms)
    Performance tests
      ✓ should respond within reasonable time (3 ms)
      ✓ should handle concurrent requests (8 ms)
    Query parameter validation
      ✓ should handle empty query parameters (4 ms)
      ✓ should handle SQL injection attempts (4 ms)
      ✓ should handle XSS attempts (4 ms)
      ✓ should handle very long input strings (7 ms)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    ✅ Using real database for testing with seeded data

      at Object.log (tests/setup.js:56:11)

  console.log
    🔄 Initializing test database connection...

      at Object.log (tests/setup.js:60:13)

  console.log
    Using database config from environment variables

      at cov_auk92v9qg (utils/database.js:165:11)

  console.log
    Database config loaded from environment: localhost:5432/stocks

      at getDbConfig (utils/database.js:204:59)

  console.log
    ✅ Database connection pool initialized successfully

      at cov_auk92v9qg (utils/database.js:257:21)

  console.log
    ✅ Real PostgreSQL test database connected

      at Object.log (tests/setup.js:95:13)

  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Initializing database connection...

      at log (index.js:362:13)

  console.log
    Database connection established successfully

      at log (index.js:388:17)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 80 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 80 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 51 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 79 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 97 "-" "-"
  console.log
    Processing request: POST /auth/login

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for login

      at log (routes/auth.js:37:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/login HTTP/1.1" 401 47 "-" "-"
  console.log
    Processing request: POST /auth/login

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/login HTTP/1.1" 400 47 "-" "-"
  console.log
    Processing request: POST /auth/login

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for login

      at log (routes/auth.js:37:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/login HTTP/1.1" 401 47 "-" "-"
  console.log
    Processing request: GET /auth/me

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 Test mode: Using dev-bypass-token for authentication

      at log (middleware/auth.js:44:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /auth/me HTTP/1.1" 200 144 "-" "-"
  console.log
    Processing request: GET /auth/me

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /auth/me HTTP/1.1" 401 529 "-" "-"
  console.log
    Processing request: GET /auth/me

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /auth/me HTTP/1.1" 401 521 "-" "-"
  console.log
    Processing request: POST /auth/confirm

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for confirmation

      at log (routes/auth.js:358:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/confirm HTTP/1.1" 200 59 "-" "-"
  console.log
    Processing request: POST /auth/confirm

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/confirm HTTP/1.1" 400 46 "-" "-"
  console.log
    Processing request: POST /auth/forgot-password

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for forgot password

      at log (routes/auth.js:408:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/forgot-password HTTP/1.1" 200 53 "-" "-"
  console.log
    Processing request: POST /auth/forgot-password

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/forgot-password HTTP/1.1" 400 44 "-" "-"
  console.log
    Processing request: POST /auth/reset-password

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for password reset

      at log (routes/auth.js:441:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/reset-password HTTP/1.1" 200 56 "-" "-"
  console.log
    Processing request: POST /auth/reset-password

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for password reset

      at log (routes/auth.js:441:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/reset-password HTTP/1.1" 400 46 "-" "-"
  console.log
    Processing request: POST /auth/login

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for login

      at log (routes/auth.js:37:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/login HTTP/1.1" 401 47 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 200 105 "-" "-"
  console.log
    Processing request: GET /auth/me

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /auth/me HTTP/1.1" 401 528 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 400 51 "-" "-"
  console.log
    Processing request: POST /auth/register

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

  console.log
    🔧 DEV: Using development auth for registration

      at log (routes/auth.js:256:15)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "POST /auth/register HTTP/1.1" 200 105 "-" "-"
  console.log
    Processing request: GET /auth/health

      at log (index.js:403:11)

  console.log
    Database connection verified for database-dependent endpoint

      at log (index.js:417:13)

::ffff:127.0.0.1 - - [23/Sep/2025:13:40:35 +0000] "GET /auth/health HTTP/1.1" 200 146 "-" "-"
  console.log
    ✅ Test database connection closed

      at Object.log (tests/setup.js:115:13)

FAIL tests/integration/routes/auth.integration.test.js
  Authentication Routes Integration
    POST /auth/register
      ✓ should register new user successfully (9 ms)
      ✓ should reject duplicate email registration (3 ms)
      ✓ should validate required fields (8 ms)
      ✓ should validate email format (3 ms)
      ✓ should validate password strength (3 ms)
    POST /auth/login
      ✓ should login user with valid credentials (3 ms)
      ✓ should reject missing credentials (2 ms)
      ✓ should reject invalid credentials (3 ms)
    GET /auth/me
      ✓ should return user profile with dev bypass token (4 ms)
      ✕ should require valid token (3 ms)
      ✓ should reject invalid token (11 ms)
    POST /auth/confirm
      ✕ should confirm user registration (3 ms)
      ✓ should require confirmation parameters (2 ms)
    POST /auth/forgot-password
      ✓ should initiate password reset (2 ms)
      ✓ should require username (2 ms)
    POST /auth/reset-password
      ✓ should reset password with valid code (3 ms)
      ✓ should require all parameters (2 ms)
    Security and edge cases
      ✓ should handle SQL injection attempts (4 ms)
      ✕ should handle XSS attempts in registration (2 ms)
      ✓ should handle malformed Authorization header (4 ms)
      ✓ should handle empty password (2 ms)
      ✕ should handle extremely long inputs (2 ms)
    Health check
      ✓ should return auth service health (3 ms)

  ● Authentication Routes Integration › GET /auth/me › should require valid token

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      170 |       // Due to development bypass in auth middleware (lines 30-47 in auth.js),
      171 |       // requests without tokens may still succeed in NODE_ENV=test
    > 172 |       expect(response.status).toBe(200);
          |                               ^
      173 |       if (response.status === 401) {
      174 |         expect(response.body.success).toBe(false);
      175 |       } else {

      at Object.toBe (tests/integration/routes/auth.integration.test.js:172:31)

  ● Authentication Routes Integration › POST /auth/confirm › should confirm user registration

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      196 |       });
      197 |
    > 198 |       expect([400, 422]).toContain(response.status);
          |                          ^
      199 |       expect(response.body.success).toBe(false);
      200 |       expect(response.body.error).toBe("Confirmation failed");
      201 |       if (response.status === 200) {

      at Object.toContain (tests/integration/routes/auth.integration.test.js:198:26)

  ● Authentication Routes Integration › Security and edge cases › should handle XSS attempts in registration

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      286 |
      287 |       // Cognito will handle input validation
    > 288 |       expect([400, 422]).toContain(response.status);
          |                          ^
      289 |       expect(response.body.success).toBe(false);
      290 |     });
      291 |

      at Object.toContain (tests/integration/routes/auth.integration.test.js:288:26)

  ● Authentication Routes Integration › Security and edge cases › should handle extremely long inputs

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      322 |         });
      323 |
    > 324 |       expect([400, 422]).toContain(response.status);
          |                          ^
      325 |       expect(response.body.success).toBe(false);
      326 |     });
      327 |   });

      at Object.toContain (tests/integration/routes/auth.integration.test.js:324:26)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

  console.log
    🔧 Test setup - Environment variables: {
      NODE_ENV: 'test',
      DB_HOST: 'localhost',
      DB_USER: 'postgres',
      DB_NAME: 'stocks',
      DB_PORT: '5432'
    }

      at Object.log (tests/setup.js:21:9)

  console.log
    JWT verifier initialized successfully (test mode)

      at ApiKeyService.log [as initializeJwtVerifier] (utils/apiKeyService.js:100:17)

  console.log
    🚨 Alert system integration initialized

      at LiveDataManager.log [as initializeAlertSystem] (utils/liveDataManager.js:1307:15)

----------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File                              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
All files                         |   21.94 |    14.94 |   21.91 |   22.17 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
 middleware                       |   23.48 |    15.74 |   34.61 |   23.38 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  auth.js                         |   24.66 |    22.72 |   14.28 |   24.32 | 32,39,71,77,87-90,93,98-106,111-272,289-318,324-350,355-387,396-420,426-460,466-485                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  errorHandler.js                 |    2.66 |        0 |       0 |     2.7 | 3-141                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  responseFormatter.js            |    86.2 |       90 |   77.77 |    86.2 | 32-33,38-39                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  validation.js                   |     7.4 |        0 |       0 |     7.4 | 2-55                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
 routes                           |   17.24 |     9.94 |   12.19 |   17.61 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  alerts.js                       |   14.38 |     6.61 |   14.73 |   14.36 | 18,139-141,145-147,151-153,172,285-286,304-370,380-402,412-439,485-486,496-768,779-1032,1043-1074,1083-1114,1123-1171,1180-1227,1238-1353,1363-1401,1411-1731,1741-1798,1808-1847,1857-2015,2026-2131,2142-2225,2230-2272,2282-2326,2336-2367,2377-2495,2501-2635,2716,2719,2722,2725,2756-2761,2770-2814,2823-2871,2880-2918,2927-2971,2980-3019,3028-3052,3061-3099,3108-3154,3163-3240,3249-3297,3306-3364                                                                                                                                                                                                                                  
  analysts.js                     |    6.12 |        0 |       0 |    6.54 | 9,30-50,58-70,78-103,111-136,144-175,185-218,228-485,497-598,608-698,707-800,810-850,860-1174,1185-1216,1226-1277,1287-1360,1370-1430,1440-1449                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  analytics.js                    |    4.57 |        0 |       0 |    4.91 | 10-40,45,55,96-101,106-136,146-349,359-510,520-702,713-819,829-914,924-977,988-1061,1071-1154,1164-1324,1334-1426,1436-1597,1607-1622,1633-1826                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  auth.js                         |   37.76 |    29.37 |   43.75 |   37.96 | 44-64,83-148,156-239,308-339,367-389,417-430,458-488,497-546,552-648,661,679,714,726                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  backtest.js                     |   15.26 |    17.17 |   11.76 |   15.52 | 36-359,385,426,437-521,529-550,564-570,574-576,580-609,615-637,643-758,764-791,797-843,866-867,873-874,911-912,922-936,946-974,984-1003,1013-1032,1042-1248                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  calendar.js                     |   32.31 |    30.18 |   21.42 |   33.52 | 20,73,135-136,163-260,270-320,331-363,401-403,411-437,478-491,549,568-569,659,678-679,756-782,816-1087,1097-1498,1509-1734                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  commodities.js                  |    39.2 |    12.84 |   38.09 |   39.34 | 123-124,220,237-238,287-288,367-368,378-527,537-706,759,777-778                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  dashboard.js                    |   51.56 |     21.5 |   48.83 |   52.94 | 10,250-251,270-273,351,363-364,383,466-486,504,554-597,615,675-676,711-712,824-825,939,969,988-989,1016,1039,1054,1084-1085,1095-1329,1337-1397,1411-1453,1464-1511,1522-1572                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  data.js                         |    7.87 |        0 |       0 |    7.92 | 17-44,58-112,131-167,179-192,203-217,232-313,330-399,413-544,556-617                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  debug.js                        |       8 |        0 |       0 |    8.24 | 19-156,170-234                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  diagnostics.js                  |   29.16 |        0 |       0 |   29.16 | 9-32,42-55,65-80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
  dividend.js                     |   31.88 |     26.4 |   19.56 |   32.19 | 8,89-90,137-151,176-213,251-252,312-313,328,424-425,436-563,575-837,850-861,872-959                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  earnings.js                     |   29.16 |      8.6 |      25 |   29.16 | 40-41,61-62,73-158,171-347,382-417,439-440                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  economic.js                     |    71.5 |    55.38 |      76 |   72.51 | 80-81,91-94,138-156,166-195,270-271,400-401,418,460-497,515,570-574,606-607,622,632,694-695                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  etf.js                          |   49.35 |    38.13 |   54.16 |   50.69 | 9,23,89-154,170,223-256,272,297,373-551,561-573,664-665,716-717,747-748,780-781                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  financials.js                   |    7.02 |        0 |       0 |    7.12 | 9,35,44-193,203-264,274-302,312-425,435-525,535-608,614-676,688-771,783-881,893-1004,1016-1119,1125-1178,1188-1238,1248-1290,1300-1342,1352-1394,1404-1446,1456-1562,1572-1622,1632-1656,1666-1687,1697-1727,1737-1854,1866-1948,1958-2015,2025-2077,2087-2136,2145-2194                                                                                                                                                                                                                                                                                                                                                                       
  health.js                       |     8.4 |     6.83 |       5 |    8.47 | 17,41-48,73,125-512,534-665,673-686,695-777,783-1020                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  insider.js                      |   12.32 |        0 |       0 |   12.67 | 8,21-112,124-259,275-284,295-304                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
  liveData.js                     |   44.76 |    45.57 |   51.06 |   44.59 | 129-137,164-169,239-244,273-278,335-340,410-415,436,475-483,492-541,550-846,856,865,909-914,998-1152,1158-1197,1232-1233,1272-1277,1317,1364,1386,1399,1416,1425-1435,1446-1455                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  market.js                       |   12.17 |      5.2 |    6.56 |    12.4 | 22-23,28-33,41,77,133-134,144-290,296-337,347-428,434-446,452-497,505,550,575,596,630-652,684,709,728,749-750,760-799,809-921,938-1045,1062-1344,1354-1458,1476,1483-1602,1619-1647,1664-1708,1726-1783,1792-1824,1832-1918,1928-1990,2000-2577,2583-2847,2859-2994,3005-3146,3157-3281,3292-3350,3361-3419,3430-3730,3740-3955,3965-4295,4306-4667,4678-4717,4727-4790,4802-4854,4864-4880,4888-4963,4973-5051,5061-5142,5152-5224,5234-5294,5304-5363,5373-5427,5437-5458,5468-5503,5514-5563,5573-5594,5603-5624,5633-5642,5657,5685-5686,5701,5744-5745                                                                                    
  metrics.js                      |   61.36 |    35.82 |   57.14 |   62.06 | 13,33-95,106-140,185-190,201-202,211,272-273,320-343                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  news.js                         |    5.51 |        0 |       0 |    5.83 | 11-29,36,47,55-207,219-341,351-451,461-602,612-638,648-663,673-711,721-757,767-855,865-971,982-1106,1117-1286,1297-1417,1428-1565,1575-1637,1647-1851,1861-2113,2123-2414                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  orders.js                       |   25.66 |    20.31 |   21.81 |   25.85 | 10,48-49,83,167-169,201-203,215-360,426,445-550,575-656,667-792,816-817,854-855,865-919,930-954,977,995-1032,1059-1061,1065-1067,1116,1167-1187,1205-1458,1464-1510,1520-1725,1755-1860,1888-1950,1974-1980,1993-2015                                                                                                                                                                                                                                                                                                                                                                                                                          
  performance.js                  |   23.51 |     8.69 |   17.64 |   23.85 | 37-74,148-153,164-182,196-215,226-248,282-297,307-384,428-533,555-671,712-716,720,759-835,875-876,893-948,985-986,1134-1149,1162-1178,1190-1225,1237-1278,1290-1325,1337-1372,1384-1403,1415-1438,1448-1610,1620-1712                                                                                                                                                                                                                                                                                                                                                                                                                          
  portfolio.js                    |    8.21 |     3.58 |    3.95 |    8.51 | 13-123,131-138,205,209,243-244,305-306,316-545,587-729,752-807,819-977,987-1032,1045-1092,1135-1217,1232-1426,1436-1650,1660-1780,1792-1965,1988-2065,2081,2140-2141,2151-2343,2355-2450,2461-2557,2568-2655,2666-2715,2733-2780,2791-2930,2941-3041,3052-3113,3124-3194,3205-3294,3305-3353,3364-3793,3798-3867,3876-3913,3921-3948,3956-4124,4134-4560,4566-4619,4636-4698,4715-4761,4778-5437,5443-5672,5683-5729,5739-5773,5804-5900,5922-6004,6014-6101,6111-6179,6189-6203,6213-6399,6464-6465                                                                                                                                           
  positioning.js                  |   13.79 |        0 |       0 |   13.79 | 9,22-107,116-180,188-197                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  price.js                        |    5.28 |        0 |       0 |     5.6 | 13,29,39-115,125-172,182-237,247-309,319-451,463-516,528-577,587-828,838-1023,1033-1215,1225-1306,1315-1480,1491-1546,1556-1738,1748-1770,1780-1795,1806-1867                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  recommendations.js              |    5.75 |        0 |       0 |    5.97 | 10-177,189-303,316-619                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  research.js                     |   20.33 |        0 |       0 |   20.33 | 13-29,39-50,60-71,81-92,102-113,123-259                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  risk.js                         |   22.09 |    18.57 |   18.18 |   22.75 | 71-222,239-516,529-562,572-612,622-660,670-743,753-785,795-824,834-863,873-920,930-980,990-1069,1079-1111,1121-1321,1331-1339,1349-1357,1367-1408,1418-1459,1469-1507,1517-1549,1559-1594,1613,1624,1693,1695,1748-1749                                                                                                                                                                                                                                                                                                                                                                                                                        
  scores.js                       |   75.43 |    48.07 |   77.77 |   77.77 | 69-70,79-80,120-121,154-155,200-219                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  scoring.js                      |    7.46 |        0 |       0 |    7.61 | 13,30-425,430,439-477,487-567,577-624,634-674,684-810,820-851,861-1080                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  screener.js                     |    5.12 |        0 |       0 |    5.22 | 12,32-78,96-523,533-692,702-776,784-858,866,892-1170,1181-1235,1245-1271,1281-1332,1342-1432,1442-1534,1557-1617,1642-1783,2060-2149,2161-2190,2201-2467                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  sectors.js                      |    8.54 |        0 |       0 |    8.67 | 10,20,34-96,107-114,123-242,255-327,336-470,484-659,668-803,815-876,886-916,926-956                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  sentiment.js                    |    8.51 |        0 |       0 |    8.83 | 10,20,34-233,242,251-264,274-489,499-603,620-745,762-777,787-1028,1038-1051,1061-1337,1347-1388,1398-1432,1442-1475,1485-1515,1525-1552,1562-1587,1597-1630,1640-1663,1673-1704,1713-1738,1748-1771,1781-1877,1887-1997                                                                                                                                                                                                                                                                                                                                                                                                                        
  settings.js                     |   31.98 |    13.68 |      40 |   31.98 | 55,245-246,270,295-296,317,346,355,379-380,407-408,432-451,479-521,547-569,592-599,609-625,635-665,675-684,694-750,760,765-800,810-828,838-859,869-896,906-971,981-1030,1040-1203,1214-1364,1375-1468                                                                                                                                                                                                                                                                                                                                                                                                                                          
  signals.js                      |   14.28 |        0 |       0 |   14.28 | 13-83,94-112,123-146,157-171,182-195,206-245,256-283,294-328,339-360,371-402                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
  stocks.js                       |   22.78 |    11.42 |   18.36 |   23.14 | 27-28,66-146,169-210,221-272,283-341,353,406-979,989-1172,1207,1289,1334-1335,1345-1417,1427-1589,1594-1673,1683-1722,1767,1808-1810,1847-1848,1871-1872,1885-1907,1941-1942,1959,1976-1977,1990-2012,2033,2051,2067,2083,2099,2117,2135,2153,2160,2169-2199,2209-2229,2239-2312,2322-2350,2360-2402,2412-2473,2489,2549-2550,2565-2568,2576-2577,2631-2632,2646,2650-2653,2660-3031,3051-3142,3155-3187,3195-3366,3378,3557-3586,3592-3634,3640-3706,3714-3758,3766-3794,3802-3815,3820-3885,3896,3905-3925,3935-3955,3965-4038,4048-4076,4086-4128,4138-4199,4209-4228,4237-4256,4265-4284,4293-4307,4316-4331,4340-4354,4363-4380,4389-4420 
  strategyBuilder.js              |      15 |        0 |       0 |   15.21 | 21,28-149,163-226,238-274,286-374,386-501,513-545,559-640,652-682,691-700                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  technical.js                    |    3.09 |        0 |       0 |    3.34 | 13,26-112,127-195,205-249,259-303,313-463,473-566,576-767,779-884,894-985,995-1054,1064-1187,1199-1259,1271-1357,1374-1449,1463-1548,1563-1669,1694-1930,1954-1988,2007-2384,2391-2411,2421-2441,2451-2471,2481-2557,2567-2652,2661-2738,2752-2808,2817-3060,3080-4034                                                                                                                                                                                                                                                                                                                                                                         
  trades.js                       |    6.63 |      0.4 |    3.12 |    6.83 | 16,38-138,150,161-230,240-511,528-531,535,539,556-735,758-847,862-934,946-1005,1017-1030,1042-1102,1114-1369,1382-1742,1755-1821,1833-1856,1868-1915,1943-2166,2179-2282,2294-2334,2343-2580,2590-2804,2816-2902,2912-2967,2993,3005-3006                                                                                                                                                                                                                                                                                                                                                                                                      
  trading.js                      |   50.65 |    41.86 |   46.91 |   50.72 | 35-60,85-86,90-91,99-137,171-174,187-188,435-436,478,554-558,594-601,606,633,811-872,908,928,946-947,968,1034,1053-1059,1105,1120-1121,1143,1198-1199,1243-1333,1357,1378,1430-1431,1495,1526,1561-1562,1618,1652-1656,1702-1713,1757-1772,1839,1884-1885,1899,1905,1921-1922,1927-1928,1933-1944,1951-1956,1970-2003,2168-2169,2179-2239,2304-2420,2429-2609,2618-2777,2788-2822,2831-2858,2866-2889,2897-2935,2943-2976,2985-3018,3028-3083,3093-3122,3131-3143,3148-3159,3170-3213                                                                                                                                                          
  user.js                         |    7.43 |        0 |       0 |    7.48 | 6,16,30-72,83-105,116-280,291-395,406-511,522-778                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  watchlist.js                    |    6.87 |        0 |       0 |    6.92 | 9,20-71,83-197,207-373,380-463,472-483,492-523,534-545,553-678,688-759,769-845,855-913,923-991,1001-1088,1098-1138                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  websocket.js                    |   14.63 |     5.04 |    9.37 |   14.59 | 17,44,60-94,106-122,138-158,184-599,617-648,660-709,717-766,780,799-800,808-828,836-858,864-942,955-981,986-1004                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 services                         |   64.82 |     51.7 |   67.85 |   65.21 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  aiStrategyGenerator.js          |   57.31 |    46.17 |   65.16 |   58.39 | 128-133,200-274,297,302,350-351,360,366,369,372,375,380,385,400,408,415,426-481,762-814,883-965,975-1166,1236-1240,1412-1413,1420,1426-1427,1464,1512,1514,1516,1520,1522,1524,1526,1528,1646,1665-1668,1707,1764,1788,1797,1806,4295                                                                                                                                                                                                                                                                                                                                                                                                          
  aiStrategyGeneratorStreaming.js |   81.57 |    64.33 |   78.26 |   80.68 | 77,102,111,273,315-325,401-409,532-543,574-639                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
 utils                            |    33.4 |    27.42 |    43.8 |   33.57 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  aiMarketScanner.js              |     3.5 |        0 |    8.33 |    4.87 | 55-650                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  alertSystem.js                  |    6.63 |     3.59 |    5.88 |    6.69 | 76,89-949                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  alpacaService.js                |   36.01 |    25.32 |   47.82 |   35.39 | 123-124,142,169-269,300-520,555-556,573-672,695,700-725,768-769,785-786,804-808,851-852,874-875,899-900,914,931-979                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  apiKeyService.js                |   27.18 |    22.84 |      50 |   27.07 | 23-26,76-81,91-97,104-121,131,154,170-457,471-504,512-514,526-588,598,603,614,625,637-778,790,797,807,832-913,930,942,955-1069,1097,1108,1129,1155-1163,1176,1182,1198-1212,1231-1351,1372,1383,1390,1402-1406,1413-1424                                                                                                                                                                                                                                                                                                                                                                                                                       
  backtestStore.js                |      84 |      100 |   69.23 |   85.71 | 39,47-52                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  database-optimization.js        |       0 |        0 |       0 |       0 | 1-257                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  database.js                     |   52.61 |    44.04 |   67.74 |   49.11 | 33,41-168,185,222-230,245,250-258,269-270,274-297,310-1290,1300,1314-1317,1322,1410-1450,1503,1507                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  errorTracker.js                 |   96.51 |    91.02 |     100 |   96.51 | 117,183,194                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  factorScoring.js                |   92.65 |     78.8 |     100 |   95.11 | 196,211-216,242,356-357,461,703,742,747,759                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  liveDataManager.js              |    42.5 |    33.33 |   43.87 |   43.36 | 88,92,123,192-262,279-284,324,357,392,402-443,458,465-533,554,620,661-665,680,716-717,753-863,887-891,909-954,1012,1020,1030-1031,1055-1059,1075,1083,1094,1105-1106,1158-1160,1188,1233-1238,1255-1271,1284-1285,1293-1294,1298-1299,1303-1304,1309,1333-1336,1343-1351,1380-1381,1413-1414,1501-1532,1591,1605-1645,1658,1683-2111                                                                                                                                                                                                                                                                                                           
  logger.js                       |      75 |     62.5 |      90 |   77.38 | 84-87,153-158,249-289,298-308                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  newsAnalyzer.js                 |   23.43 |    15.21 |   23.52 |   24.39 | 53,75-76,78,91-93,108-174,195-427                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  newsStreamProcessor.js          |       0 |        0 |       0 |       0 | 6-643                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  performanceMonitor.js           |   53.68 |    43.42 |   51.85 |   55.62 | 29,70-76,121-122,129,165,171,183-215,279,292,332-457,531,603,624-650,692-723,742,762,779-857,873,914-957                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  responseFormatter.js            |   88.23 |       50 |      75 |   88.23 | 153,178                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  riskEngine.js                   |    0.86 |        0 |    1.11 |    0.94 | 22-1926                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  schemaValidator.js              |   21.17 |    25.17 |   13.15 |   21.66 | 784,792,805,808,826,838,843,851-854,858,864,888,898-1567,1578-1592                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  scoringHelpers.js               |    2.38 |        0 |       0 |    2.45 | 14-365                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  sentimentEngine.js              |   90.24 |      100 |     100 |   89.74 | 13-14,43-44                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  tradingModeHelper.js            |   56.03 |    50.56 |      84 |   55.75 | 37-43,98-159,197-274,303,336,346,380,403,430,453,465,554                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
----------------------------------|---------|----------|---------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Summary of all failing tests
FAIL tests/integration/routes/dashboard.integration.test.js
  ● Dashboard Routes Integration Tests › GET /api/dashboard/holdings (Portfolio Holdings) › should return holdings data with valid authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      138 |         .set("Authorization", `Bearer ${authToken}`);
      139 |
    > 140 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      141 |
      142 |       if (response.status === 200) {
      143 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:140:52)

  ● Dashboard Routes Integration Tests › GET /api/dashboard/performance (Portfolio Performance) › should return performance data with valid authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      185 |         .set("Authorization", `Bearer ${authToken}`);
      186 |
    > 187 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      188 |
      189 |       if (response.status === 200) {
      190 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:187:52)

  ● Dashboard Routes Integration Tests › Performance and Edge Cases › should handle authentication edge cases

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      637 |           .get(endpoint)
      638 |           .set("Authorization", `Bearer ${authToken}`);
    > 639 |         expect([200, 401].includes(validTokenResponse.status)).toBe(true);
          |                                                                ^
      640 |       }
      641 |     });
      642 |   });

      at Object.toBe (tests/integration/routes/dashboard.integration.test.js:639:64)

FAIL tests/integration/routes/dividend.integration.test.js
  ● Dividend Routes Integration Tests › GET /api/dividend/:symbol (Stock Dividend Data) › should handle non-dividend paying stocks

    expect(received).toEqual(expected) // deep equality

    - Expected  -  1
    + Received  + 11

    - Array []
    + Array [
    +   Object {
    +     "amount": 0,
    +     "currency": "USD",
    +     "dividend_type": "regular",
    +     "ex_date": "2025-10-05T05:00:00.000Z",
    +     "frequency": "None",
    +     "payment_date": "2025-10-20T05:00:00.000Z",
    +     "record_date": "2025-10-07T05:00:00.000Z",
    +   },
    + ]

      92 |
      93 |         if (response.status === 200) {
    > 94 |           expect(response.body.data.dividends).toEqual([]);
         |                                                ^
      95 |           expect(response.body.data.dividend_yield).toBeNull();
      96 |         }
      97 |       }

      at Object.toEqual (tests/integration/routes/dividend.integration.test.js:94:48)

  ● Dividend Routes Integration Tests › GET /api/dividend/calendar (Dividend Calendar) › should return upcoming dividend events

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      129 |         expect(response.body).toHaveProperty("success", true);
      130 |         expect(response.body).toHaveProperty("data");
    > 131 |         expect(Array.isArray(response.body.data)).toBe(true);
          |                                                   ^
      132 |         expect(response.body).toHaveProperty("period");
      133 |
      134 |         if (response.body.data.length > 0) {

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:131:51)

  ● Dividend Routes Integration Tests › GET /api/dividend/calendar (Dividend Calendar) › should handle sector filter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      186 |         );
      187 |
    > 188 |         expect([200, 400, 500, 503].includes(response.status)).toBe(true);
          |                                                                ^
      189 |       }
      190 |     });
      191 |   });

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:188:64)

  ● Dividend Routes Integration Tests › GET /api/dividend/aristocrats (Dividend Aristocrats) › should return dividend aristocrat stocks

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      195 |       const response = await request(app).get("/api/dividend/aristocrats");
      196 |
    > 197 |       expect(response.status).toBe(200);
          |                               ^
      198 |
      199 |       if (response.status === 200) {
      200 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:197:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/growth (Dividend Growth Analysis) › should return dividend growth analysis

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      251 |       );
      252 |
    > 253 |       expect(response.status).toBe(200);
          |                               ^
      254 |
      255 |       if (response.status === 200) {
      256 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:253:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/growth (Dividend Growth Analysis) › should handle growth period parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      277 |         );
      278 |
    > 279 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      280 |       }
      281 |     });
      282 |

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:279:54)

  ● Dividend Routes Integration Tests › GET /api/dividend/screener (Dividend Stock Screener) › should return dividend stock screening results

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      305 |       const response = await request(app).get("/api/dividend/screener");
      306 |
    > 307 |       expect(response.status).toBe(200);
          |                               ^
      308 |
      309 |       if (response.status === 200) {
      310 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:307:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/forecast (Dividend Forecasting) › should return dividend payment forecasts

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      388 |       );
      389 |
    > 390 |       expect(response.status).toBe(200);
          |                               ^
      391 |
      392 |       if (response.status === 200) {
      393 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:390:31)

  ● Dividend Routes Integration Tests › GET /api/dividend/forecast (Dividend Forecasting) › should handle forecast horizon parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      414 |         );
      415 |
    > 416 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      417 |       }
      418 |     });
      419 |   });

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:416:54)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should handle special symbol characters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      495 |         const response = await request(app).get(`/api/dividend/${symbol}`);
      496 |
    > 497 |         expect(response.status).toBe(200);
          |                                 ^
      498 |       }
      499 |     });
      500 |

      at Object.toBe (tests/integration/routes/dividend.integration.test.js:497:33)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should validate yield calculation accuracy

    expect(received).toBeLessThan(expected)

    Expected: < 50
    Received:   95.20000000000002

      527 |         const dividendYield = response.body.data.dividend_yield;
      528 |         expect(dividendYield).toBeGreaterThanOrEqual(0);
    > 529 |         expect(dividendYield).toBeLessThan(50); // Reasonable upper bound for dividend yields
          |                               ^
      530 |         expect(Number.isFinite(dividendYield)).toBe(true);
      531 |       }
      532 |     });

      at Object.toBeLessThan (tests/integration/routes/dividend.integration.test.js:529:31)

  ● Dividend Routes Integration Tests › Performance and Edge Cases › should handle stress testing with multiple concurrent requests

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      543 |       responses.forEach((response) => {
      544 |         if (response.status) {
    > 545 |           expect(response.status).toBe(200);
          |                                   ^
      546 |         }
      547 |       });
      548 |     });

      at toBe (tests/integration/routes/dividend.integration.test.js:545:35)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/dividend.integration.test.js:543:17)

FAIL tests/unit/routes/portfolio.test.js
  ● Portfolio Routes Unit Tests › GET /portfolio/allocation - metadata integration › should return allocation with last rebalance date from metadata

    expected 200 "OK", got 500 "Internal Server Error"

      252 |         .get("/portfolio/allocation")
      253 |         .set("Authorization", "Bearer dev-bypass-token")
    > 254 |         .expect(200);
          |          ^
      255 |
      256 |       expect(response.body).toHaveProperty("success", true);
      257 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/unit/routes/portfolio.test.js:254:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

FAIL tests/integration/auth/auth-flow.integration.test.js
  ● Authentication Flow Integration › Token-Based Authentication Flow › should handle missing authorization header

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 403, 500]

      87 |         const response = await request(app).get(endpoint);
      88 |
    > 89 |         expect([401, 403, 500]).toContain(response.status);
         |                                 ^
      90 |
      91 |         // Should return authentication error
      92 |         if (response.status === 401 || response.status === 403) {

      at Object.toContain (tests/integration/auth/auth-flow.integration.test.js:89:33)

FAIL tests/integration/routes/economic.integration.test.js
  ● Economic Routes Integration Tests › GET /api/economic (Economic Data) › should handle invalid pagination parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

       99 |         const response = await request(app).get(`/api/economic?${params}`);
      100 |
    > 101 |         expect([200, 400, 500, 503].includes(response.status)).toBe(true);
          |                                                                ^
      102 |       }
      103 |     });
      104 |   });

      at Object.toBe (tests/integration/routes/economic.integration.test.js:101:64)

  ● Economic Routes Integration Tests › GET /api/economic/indicators › should handle category filter for indicators

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      148 |         );
      149 |
    > 150 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      151 |       }
      152 |     });
      153 |   });

      at Object.toBe (tests/integration/routes/economic.integration.test.js:150:54)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should return economic forecasts

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      312 |       );
      313 |
    > 314 |       expect(response.status).toBe(200);
          |                               ^
      315 |
      316 |       if (response.status === 200) {
      317 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/economic.integration.test.js:314:31)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should handle forecast horizon parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      331 |         );
      332 |
    > 333 |         expect([200, 400].includes(response.status)).toBe(true);
          |                                                      ^
      334 |       }
      335 |     });
      336 |

      at Object.toBe (tests/integration/routes/economic.integration.test.js:333:54)

  ● Economic Routes Integration Tests › GET /api/economic/forecast › should handle confidence level parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      340 |       );
      341 |
    > 342 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      343 |     });
      344 |   });
      345 |

      at Object.toBe (tests/integration/routes/economic.integration.test.js:342:52)

  ● Economic Routes Integration Tests › Performance and Edge Cases › should handle concurrent requests to economic endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      387 |
      388 |       responses.forEach((response) => {
    > 389 |         expect(response.status).toBe(200);
          |                                 ^
      390 |       });
      391 |     });
      392 |

      at toBe (tests/integration/routes/economic.integration.test.js:389:33)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/economic.integration.test.js:388:17)

  ● Economic Routes Integration Tests › Performance and Edge Cases › should handle SQL injection attempts

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      453 |       );
      454 |
    > 455 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      456 |     });
      457 |
      458 |     test("should handle memory pressure with large datasets", async () => {

      at Object.toBe (tests/integration/routes/economic.integration.test.js:455:52)

FAIL tests/integration/middleware/security-headers.integration.test.js
  ● Security Headers Integration › Request Validation Security › should sanitize request parameters

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      201 |         .set("Authorization", "Bearer dev-bypass-token");
      202 |
    > 203 |       expect([400, 422]).toContain(response.status);
          |                          ^
      204 |
      205 |       // Should handle malicious input safely
      206 |       if (response.body && typeof response.body === "string") {

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:203:26)

  ● Security Headers Integration › Request Validation Security › should prevent SQL injection attempts

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      214 |         .set("Authorization", "Bearer dev-bypass-token");
      215 |
    > 216 |       expect([400, 422]).toContain(response.status);
          |                          ^
      217 |       expect(response.headers["content-type"]).toMatch(/application\/json/);
      218 |     });
      219 |

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:216:26)

  ● Security Headers Integration › Request Validation Security › should handle path traversal attempts

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      223 |         .set("Authorization", "Bearer dev-bypass-token");
      224 |
    > 225 |       expect([400, 422]).toContain(response.status);
          |                          ^
      226 |       expect(response.headers["content-type"]).toMatch(/application\/json/);
      227 |     });
      228 |   });

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:225:26)

  ● Security Headers Integration › Authentication Security › should reject requests with malformed authentication

    expect(received).toContain(expected) // indexOf

    Expected value: 401
    Received array: [400, 422]

      352 |           .set("Authorization", token);
      353 |
    > 354 |         expect([400, 422]).toContain(response.status);
          |                            ^
      355 |         expect(response.headers["content-type"]).toMatch(/application\/json/);
      356 |
      357 |         // Should not reflect malicious content in response

      at Object.toContain (tests/integration/middleware/security-headers.integration.test.js:354:28)

FAIL tests/integration/utils/performanceMonitor.test.js
  ● Performance Monitor Integration Tests › Metrics Recording › should record custom metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      137 |       const metrics = await getMetrics("test_metric", "1h");
      138 |
    > 139 |       expect(Array.isArray(metrics)).toBe(true);
          |                                      ^
      140 |       expect(metrics.length).toBeGreaterThan(0);
      141 |
      142 |       const values = metrics.map((m) => m.value);

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:139:38)

  ● Performance Monitor Integration Tests › Metrics Recording › should record metrics with different categories

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      164 |       const cacheMetrics = await getMetrics("response_time", "1h", "cache");
      165 |
    > 166 |       expect(apiMetrics.length).toBeGreaterThan(0);
          |                                 ^
      167 |       expect(dbMetrics.length).toBeGreaterThan(0);
      168 |       expect(cacheMetrics.length).toBeGreaterThan(0);
      169 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:166:33)

  ● Performance Monitor Integration Tests › Metrics Recording › should handle metrics with metadata

    TypeError: metrics.find is not a function

      184 |
      185 |       const metrics = await getMetrics("request_duration", "1h", "api");
    > 186 |       const metric = metrics.find(
          |                              ^
      187 |         (m) => m.metadata?.user_id === "test_user_123"
      188 |       );
      189 |

      at Object.find (tests/integration/utils/performanceMonitor.test.js:186:30)

  ● Performance Monitor Integration Tests › Performance Analytics › should calculate average response times

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      208 |       );
      209 |
    > 210 |       expect(avgResponseTime).toBeGreaterThan(0);
          |                               ^
      211 |       expect(avgResponseTime).toBe(143.75); // (100 + 150 + 200 + 125) / 4
      212 |     });
      213 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:210:31)

  ● Performance Monitor Integration Tests › Performance Analytics › should calculate metrics for different time ranges

    expect(received).toBeLessThanOrEqual(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      240 |       const metrics2h = await getMetrics("time_test", "2h", "test");
      241 |
    > 242 |       expect(metrics1h.length).toBeLessThanOrEqual(metrics2h.length);
          |                                ^
      243 |     });
      244 |   });
      245 |

      at Object.toBeLessThanOrEqual (tests/integration/utils/performanceMonitor.test.js:242:32)

  ● Performance Monitor Integration Tests › System Health Monitoring › should collect system health metrics

    expect(received).toHaveProperty(path)

    Expected path: "timestamp"
    Received path: []

    Received value: {"averageDuration": 109, "score": 98, "slowOperations": 0, "status": "healthy", "successRate": "100.00", "totalOperations": 17}

      249 |
      250 |       expect(health).toHaveProperty("status");
    > 251 |       expect(health).toHaveProperty("timestamp");
          |                      ^
      252 |       expect(health).toHaveProperty("metrics");
      253 |
      254 |       expect(health.metrics).toHaveProperty("memory");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:251:22)

  ● Performance Monitor Integration Tests › System Health Monitoring › should include database health in system metrics

    expect(received).toHaveProperty(path)

    Matcher error: received value must not be null nor undefined

    Received has value: undefined

      272 |       const health = await getSystemHealth();
      273 |
    > 274 |       expect(health.metrics).toHaveProperty("database");
          |                              ^
      275 |       expect(health.metrics.database).toHaveProperty("connected");
      276 |       expect(health.metrics.database).toHaveProperty("pool_size");
      277 |       expect(health.metrics.database).toHaveProperty("active_connections");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:274:30)

  ● Performance Monitor Integration Tests › System Health Monitoring › should detect system health status accurately

    TypeError: Cannot read properties of undefined (reading 'memory')

      288 |
      289 |       if (health.status === "healthy") {
    > 290 |         expect(health.metrics.memory.usage_percent).toBeLessThan(90);
          |                               ^
      291 |         expect(health.metrics.cpu.usage).toBeLessThan(90);
      292 |       }
      293 |     });

      at Object.memory (tests/integration/utils/performanceMonitor.test.js:290:31)

  ● Performance Monitor Integration Tests › Anomaly Detection › should detect trend-based anomalies

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      343 |       const anomalies = await detectAnomalies("trend_test", "1h", "trend");
      344 |
    > 345 |       expect(anomalies.length).toBeGreaterThan(0);
          |                                ^
      346 |
      347 |       const dropAnomaly = anomalies.find((a) => a.value === 50);
      348 |       expect(dropAnomaly).toBeDefined();

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:345:32)

  ● Performance Monitor Integration Tests › Performance Reporting › should generate comprehensive performance report

    expect(received).toHaveProperty(path)

    Expected path: "summary"
    Received path: []

    Received value: {"activeRequests": 1, "alerts": [], "errorRate": 0, "status": "healthy", "timestamp": "2025-09-23T13:39:27.369Z", "totalRequests": 53, "uptime": 13.778414811}

      367 |       const report = await generatePerformanceReport("1h");
      368 |
    > 369 |       expect(report).toHaveProperty("summary");
          |                      ^
      370 |       expect(report).toHaveProperty("metrics");
      371 |       expect(report).toHaveProperty("anomalies");
      372 |       expect(report).toHaveProperty("recommendations");

      at Object.toHaveProperty (tests/integration/utils/performanceMonitor.test.js:369:22)

  ● Performance Monitor Integration Tests › Performance Reporting › should include performance recommendations

    TypeError: Cannot read properties of undefined (reading 'length')

      391 |       const report = await generatePerformanceReport("1h");
      392 |
    > 393 |       expect(report.recommendations.length).toBeGreaterThan(0);
          |                                     ^
      394 |
      395 |       const recommendations = report.recommendations;
      396 |       const hasPerformanceRecommendation = recommendations.some(

      at Object.length (tests/integration/utils/performanceMonitor.test.js:393:37)

  ● Performance Monitor Integration Tests › Performance Reporting › should filter report by categories

    TypeError: Cannot read properties of undefined (reading 'every')

      417 |       const dbReport = await generatePerformanceReport("1h", "database");
      418 |
    > 419 |       expect(apiReport.metrics.every((m) => m.category === "api")).toBe(true);
          |                                ^
      420 |       expect(dbReport.metrics.every((m) => m.category === "database")).toBe(
      421 |         true
      422 |       );

      at Object.every (tests/integration/utils/performanceMonitor.test.js:419:32)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should benchmark database operations

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      445 |       // Verify metric was recorded
      446 |       const metrics = await getMetrics("db_benchmark", "1h", "database");
    > 447 |       expect(metrics.length).toBeGreaterThan(0);
          |                              ^
      448 |       expect(metrics[0].value).toBe(duration);
      449 |     });
      450 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:447:30)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should benchmark API response times

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: undefined

      477 |       // Verify all metrics were recorded
      478 |       const metrics = await getMetrics("api_benchmark", "1h", "api");
    > 479 |       expect(metrics.length).toBe(operations.length);
          |                              ^
      480 |     });
      481 |
      482 |     test("should compare performance across time periods", async () => {

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:479:30)

  ● Performance Monitor Integration Tests › Performance Benchmarking › should compare performance across time periods

    TypeError: currentMetrics.reduce is not a function

      510 |       const currentMetrics = await getMetrics("comparison_test", "30m", "test");
      511 |       const currentAvg =
    > 512 |         currentMetrics.reduce((sum, m) => sum + m.value, 0) /
          |                        ^
      513 |         currentMetrics.length;
      514 |
      515 |       expect(previousAvg).toBeGreaterThan(currentAvg); // Performance improved

      at Object.reduce (tests/integration/utils/performanceMonitor.test.js:512:24)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle invalid time ranges

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      536 |     test("should handle invalid time ranges", async () => {
      537 |       const metrics = await getMetrics("test_metric", "invalid_range", "test");
    > 538 |       expect(Array.isArray(metrics)).toBe(true);
          |                                      ^
      539 |       // Should default to a reasonable time range
      540 |     });
      541 |

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:538:38)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle very large metric values

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has value: undefined

      548 |
      549 |       const metrics = await getMetrics("large_value_test", "1h", "test");
    > 550 |       expect(metrics.length).toBeGreaterThan(0);
          |                              ^
      551 |       expect(metrics[0].value).toBe(largeValue);
      552 |     });
      553 |

      at Object.toBeGreaterThan (tests/integration/utils/performanceMonitor.test.js:550:30)

  ● Performance Monitor Integration Tests › Error Handling and Edge Cases › should handle concurrent metric recording

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: undefined

      563 |
      564 |       const metrics = await getMetrics("concurrent_test", "1h", "test");
    > 565 |       expect(metrics.length).toBe(10);
          |                              ^
      566 |
      567 |       // Verify all values were recorded correctly
      568 |       const values = metrics.map((m) => m.value).sort((a, b) => a - b);

      at Object.toBe (tests/integration/utils/performanceMonitor.test.js:565:30)

FAIL tests/integration/services/cross-service-integration.test.js
  ● Cross-Service Integration › Portfolio → Market Data → Risk Analysis Integration › should integrate market data with technical analysis

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [200, 400, 401, 500, 501]

      73 |           });
      74 |
    > 75 |         expect([200, 400, 401, 500, 501]).toContain(technicalResponse.status);
         |                                           ^
      76 |
      77 |         if (technicalResponse.status === 200) {
      78 |           expect(technicalResponse.body).toHaveProperty("success", true);

      at Object.toContain (tests/integration/services/cross-service-integration.test.js:75:43)

  ● Cross-Service Integration › Authentication → Database → Service Integration › should handle database transactions across multiple services

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      112 |         .send(orderData);
      113 |
    > 114 |       expect(response.status).toBe(200);
          |                               ^
      115 |
      116 |       // If order is processed, it should involve:
      117 |       // 1. Order validation service

      at Object.toBe (tests/integration/services/cross-service-integration.test.js:114:31)

  ● Cross-Service Integration › Error Recovery Integration › should handle service failure cascades gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 400

      244 |         });
      245 |
    > 246 |       expect(response.status).toBe(200);
          |                               ^
      247 |
      248 |       // Should handle complex operation failures without crashing
      249 |       expect(response.body).toHaveProperty("success");

      at Object.toBe (tests/integration/services/cross-service-integration.test.js:246:31)

FAIL tests/integration/routes/orders.integration.test.js
  ● Orders Routes Integration Tests › GET /api/orders/:orderId (Get Specific Order) › should handle order lookup

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      81 |         .set("Authorization", "Bearer dev-bypass-token");
      82 |
    > 83 |       expect([200, 401].includes(response.status)).toBe(true);
         |                                                    ^
      84 |
      85 |       if (response.status === 200) {
      86 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/orders.integration.test.js:83:52)

  ● Orders Routes Integration Tests › DELETE /api/orders/:orderId (Cancel Order) › should cancel order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      234 |         .set("Authorization", "Bearer dev-bypass-token");
      235 |
    > 236 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      237 |
      238 |       if (response.status === 200) {
      239 |         // Order deletion successful - no additional validation needed for this test

      at Object.toBe (tests/integration/routes/orders.integration.test.js:236:52)

  ● Orders Routes Integration Tests › DELETE /api/orders/:orderId (Cancel Order) › should return 404 for non-existent order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      246 |         .set("Authorization", "Bearer dev-bypass-token");
      247 |
    > 248 |       expect([404, 401, 403, 500].includes(response.status)).toBe(true);
          |                                                              ^
      249 |     });
      250 |
      251 |     test("should require authentication", async () => {

      at Object.toBe (tests/integration/routes/orders.integration.test.js:248:62)

  ● Orders Routes Integration Tests › Performance and Edge Cases › should handle SQL injection attempts safely

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      375 |           .set("Authorization", "Bearer dev-bypass-token");
      376 |
    > 377 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      378 |       }
      379 |     });
      380 |

      at Object.toBe (tests/integration/routes/orders.integration.test.js:377:59)

FAIL tests/integration/routes/settings.integration.test.js
  ● Settings Routes Integration Tests › GET /api/settings/api-keys (API Keys) › should return user API keys

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      145 |       if (response.status === 200) {
      146 |         expect(response.body).toHaveProperty("providers");
    > 147 |         expect(Array.isArray(response.body.providers)).toBe(true);
          |                                                        ^
      148 |       }
      149 |     });
      150 |

      at Object.toBe (tests/integration/routes/settings.integration.test.js:147:56)

  ● Settings Routes Integration Tests › GET /api/settings/api-keys/:provider (Get Specific API Key) › should return specific provider API key status

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      232 |         .set("Authorization", "Bearer dev-bypass-token");
      233 |
    > 234 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      235 |
      236 |       if (response.status === 200) {
      237 |         expect(response.body).toHaveProperty("provider", "alpaca");

      at Object.toBe (tests/integration/routes/settings.integration.test.js:234:52)

  ● Settings Routes Integration Tests › DELETE /api/settings/api-keys/:provider (Delete API Key) › should delete API key

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      281 |         .set("Authorization", "Bearer dev-bypass-token");
      282 |
    > 283 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      284 |
      285 |       if (response.status === 200) {
      286 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/settings.integration.test.js:283:52)

FAIL tests/integration/routes/performance.integration.test.js
  ● Performance Routes Integration Tests › GET /api/performance/benchmark (Benchmark Comparison) › should handle different benchmark symbols

    expect(received).toHaveProperty(path, value)

    Expected path: "symbol"
    Received path: []

    Expected value: "SPY"
    Received value: {}

      103 |
      104 |         if (response.status === 200 && response.body.data.benchmark) {
    > 105 |           expect(response.body.data.benchmark).toHaveProperty(
          |                                                ^
      106 |             "symbol",
      107 |             benchmark
      108 |           );

      at Object.toHaveProperty (tests/integration/routes/performance.integration.test.js:105:48)

  ● Performance Routes Integration Tests › GET /api/performance/benchmark (Benchmark Comparison) › should handle different time periods

    expect(received).toHaveProperty(path, value)

    Expected path: "period"
    Received path: []

    Expected value: "1d"
    Received value: {"alpha": null, "beta": 0, "correlation": 0, "excess_return": null, "information_ratio": null, "outperformance": null, "tracking_error": null}

      122 |
      123 |         if (response.status === 200 && response.body.data.comparison) {
    > 124 |           expect(response.body.data.comparison).toHaveProperty(
          |                                                 ^
      125 |             "period",
      126 |             period
      127 |           );

      at Object.toHaveProperty (tests/integration/routes/performance.integration.test.js:124:49)

  ● Performance Routes Integration Tests › GET /api/performance/portfolio (Portfolio Performance) › should return portfolio performance data with authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      176 |         .set("Authorization", `Bearer ${authToken}`);
      177 |
    > 178 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      179 |
      180 |       if (response.status === 200) {
      181 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:178:52)

  ● Performance Routes Integration Tests › GET /api/performance/portfolio (Portfolio Performance) › should handle period parameter for portfolio performance

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      205 |           .set("Authorization", `Bearer ${authToken}`);
      206 |
    > 207 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      208 |       }
      209 |     });
      210 |

      at Object.toBe (tests/integration/routes/performance.integration.test.js:207:59)

  ● Performance Routes Integration Tests › GET /api/performance/returns (Return Calculations) › should return return calculations with authentication

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      265 |         .set("Authorization", `Bearer ${authToken}`);
      266 |
    > 267 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      268 |
      269 |       if (response.status === 200) {
      270 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:267:52)

  ● Performance Routes Integration Tests › GET /api/performance/returns (Return Calculations) › should handle calculation type parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      301 |           .set("Authorization", `Bearer ${authToken}`);
      302 |
    > 303 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      304 |       }
      305 |     });
      306 |   });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:303:59)

  ● Performance Routes Integration Tests › GET /api/performance/attribution (Performance Attribution) › should return performance attribution analysis

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      318 |         .set("Authorization", `Bearer ${authToken}`);
      319 |
    > 320 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      321 |
      322 |       if (response.status === 200) {
      323 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/performance.integration.test.js:320:52)

  ● Performance Routes Integration Tests › GET /api/performance/attribution (Performance Attribution) › should handle attribution type parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      354 |           .set("Authorization", `Bearer ${authToken}`);
      355 |
    > 356 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      357 |       }
      358 |     });
      359 |   });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:356:59)

  ● Performance Routes Integration Tests › GET /api/performance/risk (Risk Metrics) › should return risk analysis metrics

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      452 |         .set("Authorization", `Bearer ${authToken}`);
      453 |
    > 454 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      455 |
      456 |       if (response.status === 200) {
      457 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/performance.integration.test.js:454:52)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle concurrent requests to performance endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      507 |
      508 |       responses.forEach((response) => {
    > 509 |         expect([200, 401].includes(response.status)).toBe(true);
          |                                                      ^
      510 |       });
      511 |     });
      512 |

      at toBe (tests/integration/routes/performance.integration.test.js:509:54)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/performance.integration.test.js:508:17)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle invalid parameters gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      536 |           .set("Authorization", `Bearer ${authToken}`);
      537 |
    > 538 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      539 |       }
      540 |     });
      541 |

      at Object.toBe (tests/integration/routes/performance.integration.test.js:538:59)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle database connection issues gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      597 |         .set("Authorization", `Bearer ${authToken}`);
      598 |
    > 599 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      600 |
      601 |       if (response.status >= 500) {
      602 |         expect(response.body).toHaveProperty("error");

      at Object.toBe (tests/integration/routes/performance.integration.test.js:599:52)

  ● Performance Routes Integration Tests › Performance and Edge Cases › should handle memory pressure with large data requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      635 |       expect(
      636 |         [200, 400, 401, 403, 413, 500, 503].includes(response.status)
    > 637 |       ).toBe(true);
          |         ^
      638 |     });
      639 |   });
      640 | });

      at Object.toBe (tests/integration/routes/performance.integration.test.js:637:9)

FAIL tests/integration/middleware/errorHandler-middleware.integration.test.js
  ● Error Handler Middleware Integration › Error Security and Information Disclosure › should not expose sensitive information in error responses

    expect(received).not.toMatch(expected)

    Expected pattern: not /password|secret|key|token|database|connection|stack|trace|internal/
    Received string:      "invalid token"

      142 |           // Should not expose sensitive internal information
      143 |           const errorMessage = response.body.error.toLowerCase();
    > 144 |           expect(errorMessage).not.toMatch(
          |                                    ^
      145 |             /password|secret|key|token|database|connection|stack|trace|internal/
      146 |           );
      147 |           expect(errorMessage).not.toMatch(

      at Object.toMatch (tests/integration/middleware/errorHandler-middleware.integration.test.js:144:36)

  ● Error Handler Middleware Integration › Error Response Headers › should handle CORS headers in error responses

    expect(received).toContain(expected) // indexOf

    Expected value: 204
    Received array: [200, 404, 500, 501]

      214 |
      215 |       // CORS preflight for non-existent endpoint
    > 216 |       expect([200, 404, 500, 501]).toContain(response.status);
          |                                    ^
      217 |
      218 |       // Should still handle CORS appropriately even for errors
      219 |       if (response.headers["access-control-allow-origin"]) {

      at Object.toContain (tests/integration/middleware/errorHandler-middleware.integration.test.js:216:36)

  ● Error Handler Middleware Integration › Error Handling Consistency Across Routes › should maintain consistent error format across all routes

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      295 |         const response = await request(app).get(scenario.endpoint);
      296 |
    > 297 |         expect(response.status).toBe(scenario.expectedStatus);
          |                                 ^
      298 |         expect(response.body).toHaveProperty("success", false);
      299 |         expect(response.body).toHaveProperty("error");
      300 |         expect(response.headers["content-type"]).toMatch(/application\/json/);

      at Object.toBe (tests/integration/middleware/errorHandler-middleware.integration.test.js:297:33)

FAIL tests/integration/websocket/websocket.integration.test.js
  ● WebSocket Integration › WebSocket Connection Establishment › should handle WebSocket upgrade requests

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [404, 500]

      35 |
      36 |       // WebSocket upgrade might return specific status codes
    > 37 |       expect([404, 500]).toContain(response.status);
         |                          ^
      38 |
      39 |       if (response.status === 101) {
      40 |         // Successful WebSocket upgrade

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:37:26)

  ● WebSocket Integration › WebSocket Connection Establishment › should validate WebSocket authentication requirements

    expect(received).toBe(expected) // Object.is equality

    Expected: 401
    Received: 404

      79 |           .set("Connection", "Upgrade");
      80 |
    > 81 |         expect(unauthResponse.status).toBe(401);
         |                                       ^
      82 |
      83 |         // Test with auth header
      84 |         const authResponse = await request(app)

      at Object.toBe (tests/integration/websocket/websocket.integration.test.js:81:39)

  ● WebSocket Integration › WebSocket Message Handling › should handle invalid WebSocket message formats

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      136 |           .send(message);
      137 |
    > 138 |         expect([400, 422]).toContain(response.status);
          |                            ^
      139 |
      140 |         if (response.status === 400 || response.status === 422) {
      141 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:138:28)

  ● WebSocket Integration › WebSocket Error Scenarios › should handle connection errors gracefully

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      258 |         const response = await requestBuilder;
      259 |
    > 260 |         expect([400, 422]).toContain(response.status);
          |                            ^
      261 |
      262 |         if ([400, 404].includes(response.status)) {
      263 |           // Error responses should be properly formatted

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:260:28)

  ● WebSocket Integration › WebSocket Error Scenarios › should handle malformed WebSocket messages

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [400, 422]

      286 |           .send(message);
      287 |
    > 288 |         expect([400, 422]).toContain(response.status);
          |                            ^
      289 |
      290 |         if (response.status >= 400 && response.body) {
      291 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/websocket/websocket.integration.test.js:288:28)

  ● WebSocket Integration › WebSocket Performance and Scalability › should handle concurrent WebSocket requests

    expect(received).toBeGreaterThan(expected)

    Expected: > 7
    Received:   0

      370 |       // Most connections should succeed
      371 |       const successfulConnections = results.filter((r) => r.success);
    > 372 |       expect(successfulConnections.length).toBeGreaterThan(
          |                                            ^
      373 |         concurrentConnections * 0.7
      374 |       );
      375 |

      at Object.toBeGreaterThan (tests/integration/websocket/websocket.integration.test.js:372:44)

  ● WebSocket Integration › WebSocket Integration with Authentication › should handle WebSocket authentication flow

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      512 |       results.forEach((result) => {
      513 |         if (result.status) {
    > 514 |           expect(result.status).toBe(200);
          |                                 ^
      515 |           expect(result.authenticated).toBe(true);
      516 |         }
      517 |       });

      at toBe (tests/integration/websocket/websocket.integration.test.js:514:33)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/websocket/websocket.integration.test.js:512:15)

FAIL tests/integration/middleware/responseFormatter-middleware.integration.test.js
  ● Response Formatter Middleware Integration › Error Response Formatting › should format error responses with consistent structure

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      109 |         const response = await request(app).get(scenario.endpoint);
      110 |
    > 111 |         expect(response.status).toBe(scenario.expectedStatus);
          |                                 ^
      112 |         expect(response.headers["content-type"]).toMatch(/application\/json/);
      113 |
      114 |         // Error response should have error information

      at Object.toBe (tests/integration/middleware/responseFormatter-middleware.integration.test.js:111:33)

FAIL tests/integration/errors/malformed-request.integration.test.js
  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle malformed JSON gracefully

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not ""
    Received string:        "Invalid symbols array"

      71 |         // Error should not expose the malformed content
      72 |         if (response.body?.error) {
    > 73 |           expect(response.body.error).not.toContain(test.body);
         |                                           ^
      74 |         }
      75 |       }
      76 |     });

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:73:43)

  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle JSON with dangerous characters

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      114 |
      115 |         // Should handle safely
    > 116 |         expect([200, 404]).toContain(response.status);
          |                            ^
      117 |
      118 |         if (response.status >= 400) {
      119 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:116:28)

  ● Malformed Request Integration › JSON Parsing Error Scenarios › should handle deeply nested JSON structures

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      146 |
      147 |       // Should handle deep nesting gracefully
    > 148 |       expect([200, 404]).toContain(response.status);
          |                          ^
      149 |
      150 |       if (response.status >= 400) {
      151 |         expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:148:26)

  ● Malformed Request Integration › HTTP Header Malformation › should handle malformed authorization headers

    TypeError: Invalid character in header content ["Authorization"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › HTTP Header Malformation › should handle malformed content-type headers

    TypeError: Invalid character in header content ["Content-Type"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › HTTP Header Malformation › should handle custom header injection attempts

    expect(received).toMatch(expected)

    Expected pattern: /invalid|malformed|header/i
    Received string:  "expect(received).not.toMatch(expected)·
    Matcher error: received value must be a string·
    Received has value: undefined"

      283 |         } catch (error) {
      284 |           // Some malformed headers might be rejected at HTTP level
    > 285 |           expect(error.message).toMatch(/invalid|malformed|header/i);
          |                                 ^
      286 |         }
      287 |       }
      288 |     });

      at Object.toMatch (tests/integration/errors/malformed-request.integration.test.js:285:33)

  ● Malformed Request Integration › URL and Path Malformation › should handle malformed URLs and paths

    expect(received).toMatch(expected)

    Expected pattern: /invalid|malformed|url/i
    Received string:  "expect(received).toContain(expected) // indexOf·
    Expected value: 200
    Received array: [400, 404, 500]"

      336 |         } catch (error) {
      337 |           // Some malformed URLs might be rejected at HTTP level
    > 338 |           expect(error.message).toMatch(/invalid|malformed|url/i);
          |                                 ^
      339 |         }
      340 |       }
      341 |     });

      at Object.toMatch (tests/integration/errors/malformed-request.integration.test.js:338:33)

  ● Malformed Request Integration › URL and Path Malformation › should handle malformed query parameters

    TypeError: Request path contains unescaped characters

      at Test.request (node_modules/superagent/src/node/index.js:808:22)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

  ● Malformed Request Integration › Request Body Malformation › should handle mismatched content-type and body

    expect(received).toContain(expected) // indexOf

    Expected value: 400
    Received array: [200, 404]

      472 |           .send(test.body);
      473 |
    > 474 |         expect([200, 404]).toContain(response.status);
          |                            ^
      475 |
      476 |         if (response.status >= 400) {
      477 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:474:28)

  ● Malformed Request Integration › Character Encoding Issues › should handle different character encodings

    expect(received).toContain(expected) // indexOf

    Expected value: 415
    Received array: [200, 404]

      538 |           .send(testBody);
      539 |
    > 540 |         expect([200, 404]).toContain(response.status);
          |                            ^
      541 |
      542 |         if (response.status >= 400) {
      543 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/errors/malformed-request.integration.test.js:540:28)

  ● Malformed Request Integration › Error Response Consistency › should maintain consistent error format for all malformed requests

    TypeError: Invalid character in header content ["Authorization"]

      at Test.setHeader [as request] (node_modules/superagent/src/node/index.js:851:39)
      at Test.request [as end] (node_modules/superagent/src/node/index.js:986:8)
      at Test.end (node_modules/supertest/lib/test.js:118:11)
      at end (node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (node_modules/superagent/src/request-base.js:267:31)

FAIL tests/integration/routes/commodities.integration.test.js
  ● Commodities Routes Integration Tests › GET /api/commodities/prices (Current Prices) › should handle limit parameter

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 5
    Received:    6

      163 |
      164 |       if (response.status === 200 && response.body.data.length > 0) {
    > 165 |         expect(response.body.data.length).toBeLessThanOrEqual(5);
          |                                           ^
      166 |       }
      167 |     });
      168 |

      at Object.toBeLessThanOrEqual (tests/integration/routes/commodities.integration.test.js:165:43)

  ● Commodities Routes Integration Tests › GET /api/commodities/correlations (Price Correlations) › should validate correlation strength classifications

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      295 |         response.body.data.correlations.forEach((corr) => {
      296 |           if (corr.strength) {
    > 297 |             expect(validStrengths.includes(corr.strength.toLowerCase())).toBe(
          |                                                                          ^
      298 |               true
      299 |             );
      300 |           }

      at toBe (tests/integration/routes/commodities.integration.test.js:297:74)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/commodities.integration.test.js:295:41)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should return commodity-related news

    expect(received).toHaveProperty(path)

    Expected path: "articles"
    Received path: []

    Received value: [{"category": "commodities", "id": 7, "publishedAt": "2025-09-22T04:00:05.183Z", "source": "WSJ", "symbol": "GLD", "title": "Gold Prices Surge on Economic Uncertainty", "url": "https://example.com/4"}, {"category": "energy", "id": 8, "publishedAt": "2025-09-22T03:00:05.183Z", "source": "MarketWatch", "symbol": "OIL", "title": "Oil Futures Rise Due to Supply Concerns", "url": "https://example.com/5"}]

      312 |       if (response.status === 200) {
      313 |         expect(response.body).toHaveProperty("data");
    > 314 |         expect(response.body.data).toHaveProperty("articles");
          |                                    ^
      315 |         expect(Array.isArray(response.body.data.articles)).toBe(true);
      316 |
      317 |         if (response.body.data.articles.length > 0) {

      at Object.toHaveProperty (tests/integration/routes/commodities.integration.test.js:314:36)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should handle category filter for news

    TypeError: Cannot read properties of undefined (reading 'length')

      339 |         expect([200, 400].includes(response.status)).toBe(true);
      340 |
    > 341 |         if (response.status === 200 && response.body.data.articles.length > 0) {
          |                                                                    ^
      342 |           response.body.data.articles.forEach((article) => {
      343 |             expect(article.category.toLowerCase()).toBe(category.toLowerCase());
      344 |           });

      at Object.length (tests/integration/routes/commodities.integration.test.js:341:68)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should handle limit parameter for news

    TypeError: Cannot read properties of undefined (reading 'length')

      353 |
      354 |       if (response.status === 200) {
    > 355 |         expect(response.body.data.articles.length).toBeLessThanOrEqual(5);
          |                                            ^
      356 |       }
      357 |     });
      358 |

      at Object.length (tests/integration/routes/commodities.integration.test.js:355:44)

  ● Commodities Routes Integration Tests › GET /api/commodities/news (Commodity News) › should validate news article timestamps

    TypeError: Cannot read properties of undefined (reading 'length')

      360 |       const response = await request(app).get("/api/commodities/news");
      361 |
    > 362 |       if (response.status === 200 && response.body.data.articles.length > 0) {
          |                                                                  ^
      363 |         response.body.data.articles.forEach((article) => {
      364 |           if (article.published_at) {
      365 |             expect(new Date(article.published_at)).toBeInstanceOf(Date);

      at Object.length (tests/integration/routes/commodities.integration.test.js:362:66)

FAIL tests/integration/middleware/auth-middleware.integration.test.js
  ● Auth Middleware with Service Integration › Auth Middleware with Different Route Types › should protect all authenticated routes consistently

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 403, 500]

      127 |         const response = await request(app).get(route);
      128 |
    > 129 |         expect([401, 403, 500]).toContain(response.status);
          |                                 ^
      130 |
      131 |         if (response.status === 401 || response.status === 403) {
      132 |           expect(response.body).toHaveProperty("success", false);

      at Object.toContain (tests/integration/middleware/auth-middleware.integration.test.js:129:33)

  ● Auth Middleware with Service Integration › Auth Middleware with Different Route Types › should allow public routes without authentication

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [401, 500]

      142 |         const response = await request(app).get(route);
      143 |
    > 144 |         expect([401, 500]).toContain(response.status);
          |                            ^
      145 |       }
      146 |     });
      147 |   });

      at Object.toContain (tests/integration/middleware/auth-middleware.integration.test.js:144:28)

FAIL tests/integration/routes/earnings.integration.test.js
  ● Earnings Data Integration › Earnings Calendar (Delegated) › should delegate to calendar earnings endpoint

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.64", "eps_difference": null, "eps_estimate": "1.59", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.1", "symbol": "GOOGL"}, {"eps_actual": "2.93", "eps_difference": null, "eps_estimate": "2.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "2.8", "symbol": "MSFT"}, {"eps_actual": "0.71", "eps_difference": null, "eps_estimate": "0.73", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "-2.7", "symbol": "TSLA"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}, {"eps_actual": "2.69", "eps_difference": null, "eps_estimate": "2.65", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "1.5", "symbol": "MSFT"}], "pagination": {"hasMore": false, "limit": 50, "page": 1, "total": 6}, "success": true, "timestamp": "2025-09-23T13:39:41.029Z"}

      17 |
      18 |       if (response.status === 200) {
    > 19 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      20 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      21 |       }
      22 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:19:31)

  ● Earnings Data Integration › Earnings Calendar (Delegated) › should delegate symbol-specific requests to calendar

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"count": 2, "data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}], "success": true, "symbol": "AAPL", "timestamp": "2025-09-23T13:39:41.042Z"}

      28 |
      29 |       if (response.status === 200) {
    > 30 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      31 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      32 |       }
      33 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:30:31)

  ● Earnings Data Integration › Earnings Calendar (Delegated) › should handle query parameters for delegation

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": [{"eps_actual": "2.18", "eps_difference": null, "eps_estimate": "2.10", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.8", "symbol": "AAPL"}, {"eps_actual": "1.64", "eps_difference": null, "eps_estimate": "1.59", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "3.1", "symbol": "GOOGL"}, {"eps_actual": "2.93", "eps_difference": null, "eps_estimate": "2.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "2.8", "symbol": "MSFT"}, {"eps_actual": "0.71", "eps_difference": null, "eps_estimate": "0.73", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2024-01-01T06:00:00.000Z", "report_date": "2024-01-01T06:00:00.000Z", "surprise_percent": "-2.7", "symbol": "TSLA"}, {"eps_actual": "1.89", "eps_difference": null, "eps_estimate": "1.85", "last_updated": "2025-09-23T13:39:13.997Z", "quarter": "2023-10-01T05:00:00.000Z", "report_date": "2023-10-01T05:00:00.000Z", "surprise_percent": "2.2", "symbol": "AAPL"}], "pagination": {"hasMore": true, "limit": 5, "page": 1, "total": 5}, "success": true, "timestamp": "2025-09-23T13:39:41.047Z"}

      41 |
      42 |       if (response.status === 200) {
    > 43 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      44 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      45 |         // Should respect limit parameter when delegating
      46 |         expect(response.body.earnings.length).toBeLessThanOrEqual(5);

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:43:31)

  ● Earnings Data Integration › Direct Calendar Earnings Access › should access earnings via calendar route directly

    expect(received).toHaveProperty(path)

    Expected path: "earnings"
    Received path: []

    Received value: {"data": {"earnings": [], "grouped_by_date": {}, "summary": {"completed_reports": 0, "message": "No earnings data found for the specified criteria", "sectors_represented": 0, "total_earnings": 0, "upcoming_reports": 0}}, "success": true, "timestamp": "2025-09-23T13:39:41.054Z"}

      56 |
      57 |       if (response.status === 200) {
    > 58 |         expect(response.body).toHaveProperty("earnings");
         |                               ^
      59 |         expect(Array.isArray(response.body.earnings)).toBe(true);
      60 |       }
      61 |     });

      at Object.toHaveProperty (tests/integration/routes/earnings.integration.test.js:58:31)

FAIL tests/unit/routes/trades.test.js
  ● Trades Routes - Testing Your Actual Site › GET /trades/brokers - Broker integration status › should return connected brokers status

    expect(received).toHaveProperty(path)

    Expected path: "brokers"
    Received path: []

    Received value: {"broker_name": "alpaca", "last_sync": "2024-01-15T10:00:00Z", "status": "connected", "trade_count": 50}

      449 |       expect(response.body).toHaveProperty("success", true);
      450 |       expect(response.body).toHaveProperty("data");
    > 451 |       expect(response.body.data).toHaveProperty("brokers");
          |                                  ^
      452 |       expect(Array.isArray(response.body.data.brokers)).toBe(true);
      453 |
      454 |       if (response.body.data.brokers.length > 0) {

      at Object.toHaveProperty (tests/unit/routes/trades.test.js:451:34)

FAIL tests/integration/services/aiStrategyGenerator.test.js
  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should generate strategy from natural language description

    TypeError: generator.generateStrategy is not a function

      62 |       };
      63 |
    > 64 |       const result = await generator.generateStrategy(description, preferences);
         |                                      ^
      65 |
      66 |       expect(result).toHaveProperty("success", true);
      67 |       expect(result).toHaveProperty("strategy");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:64:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should handle different asset types

    TypeError: generator.generateStrategy is not a function

      76 |       const description = "Simple moving average crossover strategy";
      77 |
    > 78 |       const stockResult = await generator.generateStrategy(description, {
         |                                           ^
      79 |         risk_level: "low",
      80 |         timeframe: "1hour",
      81 |         asset_type: "stock",

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:78:43)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should validate generated strategies

    TypeError: generator.generateStrategy is not a function

      102 |       };
      103 |
    > 104 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      105 |
      106 |       expect(result.success).toBe(true);
      107 |       expect(result.strategy).toHaveProperty("validation");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:104:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Generation Workflow › should handle complex multi-indicator strategies

    TypeError: generator.generateStrategy is not a function

      120 |       };
      121 |
    > 122 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      123 |
      124 |       expect(result.success).toBe(true);
      125 |       expect(result.strategy.code).toContain("rsi");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:122:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Optimization › should optimize strategy parameters

    TypeError: generator.optimizeStrategy is not a function

      147 |       };
      148 |
    > 149 |       const result = await generator.optimizeStrategy(strategy, {
          |                                      ^
      150 |         optimization_method: "grid_search",
      151 |         metric: "sharpe_ratio",
      152 |       });

      at Object.optimizeStrategy (tests/integration/services/aiStrategyGenerator.test.js:149:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Optimization › should provide optimization explanations

    TypeError: generator.optimizeStrategy is not a function

      167 |       };
      168 |
    > 169 |       const result = await generator.optimizeStrategy(strategy, {
          |                                      ^
      170 |         optimization_method: "bayesian",
      171 |         metric: "total_return",
      172 |       });

      at Object.optimizeStrategy (tests/integration/services/aiStrategyGenerator.test.js:169:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Explanation and Documentation › should explain strategy logic clearly

    TypeError: generator.generateStrategy is not a function

      194 |       };
      195 |
    > 196 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      197 |
      198 |       expect(result.success).toBe(true);
      199 |       expect(result.strategy.explanation).toContain("RSI");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:196:38)

  ● AI Strategy Generator Service Integration Tests › Strategy Explanation and Documentation › should provide educational content

    TypeError: generator.explainStrategy is not a function

      208 |       };
      209 |
    > 210 |       const result = await generator.explainStrategy(strategy);
          |                                      ^
      211 |
      212 |       expect(result).toHaveProperty("success", true);
      213 |       expect(result).toHaveProperty("explanation");

      at Object.explainStrategy (tests/integration/services/aiStrategyGenerator.test.js:210:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle invalid strategy descriptions gracefully

    TypeError: generator.generateStrategy is not a function

      234 |       };
      235 |
    > 236 |       const result = await generator.generateStrategy(
          |                                      ^
      237 |         invalidDescription,
      238 |         preferences
      239 |       );

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:236:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle malformed preferences

    TypeError: generator.generateStrategy is not a function

      252 |       };
      253 |
    > 254 |       const result = await generator.generateStrategy(
          |                                      ^
      255 |         description,
      256 |         invalidPreferences
      257 |       );

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:254:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should fallback to templates when AI is unavailable

    TypeError: generator.generateStrategy is not a function

      274 |       };
      275 |
    > 276 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      277 |
      278 |       expect(result.success).toBe(true);
      279 |       expect(result.strategy.code).toContain("def run_strategy");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:276:38)

  ● AI Strategy Generator Service Integration Tests › Error Handling and Edge Cases › should handle timeout scenarios

    TypeError: generator.generateStrategy is not a function

      293 |       generator.aiConfig.timeout = 100; // 100ms
      294 |
    > 295 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      296 |
      297 |       // Should either succeed quickly or fail gracefully with timeout
      298 |       expect(typeof result.success).toBe("boolean");

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:295:38)

  ● AI Strategy Generator Service Integration Tests › Performance and Metrics › should track generation performance metrics

    TypeError: generator.generateStrategy is not a function

      322 |
      323 |       const startTime = Date.now();
    > 324 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      325 |       const endTime = Date.now();
      326 |
      327 |       expect(result.success).toBe(true);

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:324:38)

  ● AI Strategy Generator Service Integration Tests › Performance and Metrics › should handle concurrent strategy generation requests

    TypeError: generator.generateStrategy is not a function

      338 |       for (let i = 0; i < 3; i++) {
      339 |         requests.push(
    > 340 |           generator.generateStrategy(`RSI strategy ${i}`, {
          |                     ^
      341 |             risk_level: "medium",
      342 |             timeframe: "1day",
      343 |             asset_type: "stock",

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:340:21)

  ● AI Strategy Generator Service Integration Tests › Integration with Backend Services › should integrate with database for strategy storage

    TypeError: generator.generateStrategy is not a function

      371 |       };
      372 |
    > 373 |       const result = await generator.generateStrategy(description, preferences);
          |                                      ^
      374 |
      375 |       expect(result.success).toBe(true);
      376 |

      at Object.generateStrategy (tests/integration/services/aiStrategyGenerator.test.js:373:38)

  ● AI Strategy Generator Service Integration Tests › Integration with Backend Services › should provide strategy export formats

    TypeError: generator.exportStrategy is not a function

      390 |       };
      391 |
    > 392 |       const exportResult = await generator.exportStrategy(strategy, "json");
          |                                            ^
      393 |
      394 |       expect(exportResult).toHaveProperty("success", true);
      395 |       expect(exportResult).toHaveProperty("exported_strategy");

      at Object.exportStrategy (tests/integration/services/aiStrategyGenerator.test.js:392:44)

FAIL tests/integration/utils/database.integration.test.js
  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle concurrent transactions without conflicts

    error: column "name" of relation "stock_symbols" does not exist

      694 |
      695 |           // Insert stock symbol
    > 696 |           await client.query(
          |           ^
      697 |             "INSERT INTO stock_symbols (symbol, name, sector) VALUES ($1, $2, $3) ON CONFLICT (symbol) DO UPDATE SET name = $2",
      698 |             [symbol, `Concurrent Test ${i}`, "Technology"]
      699 |           );

      at node_modules/pg/lib/client.js:545:17
      at tests/integration/utils/database.integration.test.js:696:11
      at transaction (utils/database.js:1461:20)
          at async Promise.all (index 0)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:720:23)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle transaction rollback with concurrent access

    error: column "name" of relation "stock_symbols" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:746:7)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle cross-table transaction consistency

    error: column "name" of relation "stock_symbols" does not exist

      782 |       const result = await transaction(async (client) => {
      783 |         // Insert stock symbol and market data in same transaction
    > 784 |         const stockResult = await client.query(
          |                             ^
      785 |           "INSERT INTO stock_symbols (symbol, name, sector, market_cap) VALUES ($1, $2, $3, $4) ON CONFLICT (symbol) DO UPDATE SET name = $2 RETURNING symbol",
      786 |           [symbol, "Cross Table Test", "Finance", 1000000000]
      787 |         );

      at node_modules/pg/lib/client.js:545:17
      at tests/integration/utils/database.integration.test.js:784:29
      at transaction (utils/database.js:1461:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:782:22)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle transaction isolation levels

    error: column "name" of relation "stock_symbols" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:821:7)

  ● Database Real Site Functionality Tests › Advanced Transaction Integration Scenarios › should handle large transaction data volumes

    error: column "name" of relation "stock_symbols" does not exist

      916 |         }
      917 |
    > 918 |         await Promise.all(insertPromises);
          |         ^
      919 |
      920 |         // Verify all data within transaction
      921 |         const countResult = await client.query(

      at node_modules/pg/lib/client.js:545:17
          at async Promise.all (index 0)
      at tests/integration/utils/database.integration.test.js:918:9
      at transaction (utils/database.js:1461:20)
      at Object.<anonymous> (tests/integration/utils/database.integration.test.js:888:22)

FAIL tests/integration/utils/tradingModeHelper.test.js
  ● Trading Mode Helper Integration Tests › Trading Mode Management › should get current trading mode

    expect(received).toBeDefined()

    Received: undefined

      24 |
      25 |       expect(currentMode).toBeDefined();
    > 26 |       expect(currentMode.mode).toBeDefined();
         |                                ^
      27 |       expect(["paper", "live", "simulation", "backtest"]).toContain(
      28 |         currentMode.mode
      29 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:26:32)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should switch to paper trading mode

    expect(received).toBe(expected) // Object.is equality

    Expected: "paper"
    Received: undefined

      43 |       expect(switchResult.success).toBe(true);
      44 |       expect(switchResult.previousMode).toBeDefined();
    > 45 |       expect(switchResult.currentMode).toBe("paper");
         |                                        ^
      46 |       expect(switchResult.switchedAt).toBeDefined();
      47 |       expect(switchResult.confirmation).toBeDefined();
      48 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:45:40)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should switch to live trading mode with validation

    expect(received).toBe(expected) // Object.is equality

    Expected: "live"
    Received: undefined

      70 |
      71 |       if (switchResult.success) {
    > 72 |         expect(switchResult.currentMode).toBe("live");
         |                                          ^
      73 |         expect(switchResult.riskLimits).toEqual(liveConfig.riskLimits);
      74 |         expect(switchResult.safeguards).toBeDefined();
      75 |       } else {

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:72:42)

  ● Trading Mode Helper Integration Tests › Trading Mode Management › should handle simulation mode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

       95 |       );
       96 |
    >  97 |       expect(switchResult.success).toBe(true);
          |                                    ^
       98 |       expect(switchResult.currentMode).toBe("simulation");
       99 |       expect(switchResult.simulationSettings).toEqual(simulationConfig);
      100 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:97:36)

  ● Trading Mode Helper Integration Tests › Mode Validation › should validate paper trading requirements

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      110 |
      111 |       expect(validation).toBeDefined();
    > 112 |       expect(validation.isValid).toBe(true);
          |                                  ^
      113 |       expect(validation.requirements).toBeDefined();
      114 |       expect(validation.checks).toBeDefined();
      115 |

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:112:34)

  ● Trading Mode Helper Integration Tests › Mode Validation › should validate live trading requirements

    TypeError: Cannot read properties of undefined (reading 'find')

      141 |
      142 |       requiredChecks.forEach((checkName) => {
    > 143 |         const check = validation.checks.find((c) => c.name === checkName);
          |                                         ^
      144 |         expect(check).toBeDefined();
      145 |       });
      146 |     });

      at find (tests/integration/utils/tradingModeHelper.test.js:143:41)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/tradingModeHelper.test.js:142:22)

  ● Trading Mode Helper Integration Tests › Mode Validation › should prevent unauthorized mode switches

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      155 |       );
      156 |
    > 157 |       expect(switchResult.success).toBe(false);
          |                                    ^
      158 |       expect(switchResult.error).toBeDefined();
      159 |       expect(switchResult.error.code).toBe("UNAUTHORIZED");
      160 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:157:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should configure paper trading environment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      177 |
      178 |       expect(configResult).toBeDefined();
    > 179 |       expect(configResult.success).toBe(true);
          |                                    ^
      180 |       expect(configResult.configuration).toEqual(paperConfig);
      181 |       expect(configResult.environmentReady).toBe(true);
      182 |     });

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:179:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should configure live trading environment

    expect(received).toBeDefined()

    Received: undefined

      204 |       } else {
      205 |         // May fail in test environment
    > 206 |         expect(configResult.error).toBeDefined();
          |                                    ^
      207 |       }
      208 |     });
      209 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:206:36)

  ● Trading Mode Helper Integration Tests › Trading Environment Configuration › should handle environment health checks

    expect(received).toBeDefined()

    Received: undefined

      213 |
      214 |       expect(healthCheck).toBeDefined();
    > 215 |       expect(healthCheck.status).toBeDefined();
          |                                  ^
      216 |       expect(["healthy", "degraded", "unhealthy"]).toContain(
      217 |         healthCheck.status
      218 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:215:34)

  ● Trading Mode Helper Integration Tests › Risk Management Integration › should enforce risk limits by trading mode

    expect(received).toBeDefined()

    Received: undefined

      245 |
      246 |       expect(riskCheck).toBeDefined();
    > 247 |       expect(riskCheck.approved).toBeDefined();
          |                                  ^
      248 |       expect(riskCheck.riskScore).toBeDefined();
      249 |       expect(riskCheck.appliedLimits).toBeDefined();
      250 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:247:34)

  ● Trading Mode Helper Integration Tests › Mode-Specific Features › should track paper trading performance

    expect(received).toBeDefined()

    Received: undefined

      321 |       expect(performance).toBeDefined();
      322 |       expect(performance.totalReturn).toBeDefined();
    > 323 |       expect(performance.realizedPnL).toBeDefined();
          |                                       ^
      324 |       expect(performance.unrealizedPnL).toBeDefined();
      325 |       expect(performance.tradeCount).toBeDefined();
      326 |       expect(performance.winRate).toBeDefined();

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:323:39)

  ● Trading Mode Helper Integration Tests › Mode-Specific Features › should handle backtesting mode

    expect(received).toBeDefined()

    Received: undefined

      348 |
      349 |       expect(backtestResult).toBeDefined();
    > 350 |       expect(backtestResult.backtestId).toBeDefined();
          |                                         ^
      351 |       expect(backtestResult.status).toBeDefined();
      352 |       expect(backtestResult.progress).toBeDefined();
      353 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:350:41)

  ● Trading Mode Helper Integration Tests › Data Isolation and Security › should maintain data isolation between modes

    TypeError: tradingModeHelper.getPositions is not a function

      374 |       });
      375 |
    > 376 |       const paperPositions = await tradingModeHelper.getPositions(userId);
          |                                                      ^
      377 |
      378 |       // Switch to simulation mode
      379 |       await tradingModeHelper.switchMode(userId, "simulation");

      at Object.getPositions (tests/integration/utils/tradingModeHelper.test.js:376:54)

  ● Trading Mode Helper Integration Tests › Data Isolation and Security › should secure live trading credentials

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      398 |
      399 |       expect(securityCheck).toBeDefined();
    > 400 |       expect(securityCheck.encrypted).toBe(true);
          |                                       ^
      401 |       expect(securityCheck.keyStrength).toBeDefined();
      402 |       expect(securityCheck.securityScore).toBeDefined();
      403 |

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:400:39)

  ● Trading Mode Helper Integration Tests › Performance and Monitoring › should monitor mode switching performance

    expect(received).toBeDefined()

    Received: undefined

      421 |       expect(metrics.averageSwitchTime).toBeDefined();
      422 |       expect(metrics.successRate).toBeDefined();
    > 423 |       expect(metrics.activeUsers).toBeDefined();
          |                                   ^
      424 |     });
      425 |
      426 |     test("should handle concurrent mode operations", async () => {

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:423:35)

  ● Trading Mode Helper Integration Tests › Performance and Monitoring › should handle concurrent mode operations

    TypeError: tradingModeHelper.getPositions is not a function

      432 |         tradingModeHelper.validateModeRequirements(userId, "paper"),
      433 |         tradingModeHelper.getCurrentRiskLimits(userId),
    > 434 |         tradingModeHelper.getPositions(userId),
          |                           ^
      435 |       ];
      436 |
      437 |       const results = await Promise.all(operations);

      at Object.getPositions (tests/integration/utils/tradingModeHelper.test.js:434:27)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle invalid mode transitions

    expect(received).toBe(expected) // Object.is equality

    Expected: "INVALID_MODE"
    Received: undefined

      455 |       expect(invalidTransition.success).toBe(false);
      456 |       expect(invalidTransition.error).toBeDefined();
    > 457 |       expect(invalidTransition.error.code).toBe("INVALID_MODE");
          |                                            ^
      458 |     });
      459 |
      460 |     test("should handle system failures gracefully", async () => {

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:457:44)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle system failures gracefully

    expect(received).toBeDefined()

    Received: undefined

      471 |
      472 |       expect(failureRecovery).toBeDefined();
    > 473 |       expect(failureRecovery.recovered).toBeDefined();
          |                                         ^
      474 |       expect(failureRecovery.fallbackActivated).toBeDefined();
      475 |
      476 |       if (failureRecovery.fallbackActivated) {

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:473:41)

  ● Trading Mode Helper Integration Tests › Error Handling and Edge Cases › should handle network connectivity issues

    expect(received).toBeDefined()

    Received: undefined

      485 |
      486 |       expect(connectivityCheck).toBeDefined();
    > 487 |       expect(connectivityCheck.status).toBeDefined();
          |                                        ^
      488 |       expect(["connected", "degraded", "disconnected"]).toContain(
      489 |         connectivityCheck.status
      490 |       );

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:487:40)

  ● Trading Mode Helper Integration Tests › Audit and Compliance › should log all mode changes

    expect(received).toBe(expected) // Object.is equality

    Expected: "MODE_SWITCH"
    Received: "mode_switch"

      516 |
      517 |       const latestEntry = auditLog.entries[0];
    > 518 |       expect(latestEntry.action).toBe("MODE_SWITCH");
          |                                  ^
      519 |       expect(latestEntry.userId).toBe(userId);
      520 |       expect(latestEntry.details.targetMode).toBe("paper");
      521 |       expect(latestEntry.timestamp).toBeDefined();

      at Object.toBe (tests/integration/utils/tradingModeHelper.test.js:518:34)

  ● Trading Mode Helper Integration Tests › Audit and Compliance › should maintain compliance records

    expect(received).toBeDefined()

    Received: undefined

      527 |
      528 |       expect(compliance).toBeDefined();
    > 529 |       expect(compliance.status).toBeDefined();
          |                                 ^
      530 |       expect(compliance.checks).toBeDefined();
      531 |       expect(compliance.lastUpdate).toBeDefined();
      532 |

      at Object.toBeDefined (tests/integration/utils/tradingModeHelper.test.js:529:33)

FAIL tests/integration/risk-management-workflow.integration.test.js
  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should execute full risk management lifecycle

    expected 200 "OK", got 401 "Unauthorized"

      76 |         .post("/api/trading/risk/limits")
      77 |         .send(riskLimits)
    > 78 |         .expect(200);
         |          ^
      79 |
      80 |       expect(limitsResponse.body.success).toBe(true);
      81 |       expect(limitsResponse.body.data.maxDrawdown).toBe(15.0);

      at Object.expect (tests/integration/risk-management-workflow.integration.test.js:78:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should handle empty portfolio risk analysis

    TypeError: Cannot read properties of undefined (reading 'totalPositions')

      385 |
      386 |       expect(response.body.success).toBe(true);
    > 387 |       expect(response.body.data.portfolioSummary.totalPositions).toBe(0);
          |                                                  ^
      388 |       expect(response.body.data.portfolioSummary.totalValue).toBe(0);
      389 |       expect(response.body.data.riskMetrics.riskLevel).toBe("low");
      390 |       expect(response.body.data.recommendations).toContain(

      at Object.totalPositions (tests/integration/risk-management-workflow.integration.test.js:387:50)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should handle multiple rapid position closes

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:400:9)

  ● Risk Management Workflow Integration Tests › Complete Risk Management Workflow › should maintain data consistency across concurrent operations

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:448:7)

  ● Risk Management Workflow Integration Tests › Risk Limit Compliance Checking › should detect and report risk limit violations

    error: column "total_value" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at Object.<anonymous> (tests/integration/risk-management-workflow.integration.test.js:510:7)

FAIL tests/integration/routes/portfolio.integration.test.js
  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio - should return portfolio API info

    expected 200 "OK", got 401 "Unauthorized"

      16 |         .get("/api/portfolio")
      17 |         .set(auth)
    > 18 |         .expect(200);
         |          ^
      19 |
      20 |       expect(response.body).toHaveProperty("success", true);
      21 |       expect(response.body).toHaveProperty("message");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:18:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/summary - should return portfolio summary

    expected 200 "OK", got 401 "Unauthorized"

      28 |         .get("/api/portfolio/summary")
      29 |         .set(auth)
    > 30 |         .expect(200);
         |          ^
      31 |
      32 |       expect(response.body).toHaveProperty("success", true);
      33 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:30:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/positions - should return portfolio positions

    expected 200 "OK", got 401 "Unauthorized"

      38 |         .get("/api/portfolio/positions")
      39 |         .set(auth)
    > 40 |         .expect(200);
         |          ^
      41 |
      42 |       expect(response.body).toHaveProperty("success", true);
      43 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:40:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/holdings - should return portfolio holdings

    expected 200 "OK", got 401 "Unauthorized"

      48 |         .get("/api/portfolio/holdings")
      49 |         .set(auth)
    > 50 |         .expect(200);
         |          ^
      51 |
      52 |       expect(response.body).toHaveProperty("success", true);
      53 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:50:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/value - should return portfolio value data

    expected 200 "OK", got 401 "Unauthorized"

      61 |         .get("/api/portfolio/value")
      62 |         .set(auth)
    > 63 |         .expect(200);
         |          ^
      64 |
      65 |       expect(response.body).toHaveProperty("success", true);
      66 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:63:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/allocation - should return portfolio allocation

    expected 200 "OK", got 401 "Unauthorized"

      71 |         .get("/api/portfolio/allocation")
      72 |         .set(auth)
    > 73 |         .expect(200);
         |          ^
      74 |
      75 |       expect(response.body).toHaveProperty("success", true);
      76 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:73:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Core Portfolio APIs › GET /api/portfolio/allocations - should return portfolio allocations

    expected 200 "OK", got 401 "Unauthorized"

      81 |         .get("/api/portfolio/allocations")
      82 |         .set(auth)
    > 83 |         .expect(200);
         |          ^
      84 |
      85 |       expect(response.body).toHaveProperty("success", true);
      86 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:83:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Analytics and Analysis APIs › GET /api/portfolio/analytics - should return portfolio analytics

    expected 200 "OK", got 401 "Unauthorized"

      94 |         .get("/api/portfolio/analytics")
      95 |         .set(auth)
    > 96 |         .expect(200);
         |          ^
      97 |
      98 |       expect(response.body).toHaveProperty("success", true);
      99 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:96:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Performance and Returns APIs › GET /api/portfolio/returns - should return portfolio returns

    expected 200 "OK", got 401 "Unauthorized"

      107 |         .get("/api/portfolio/returns")
      108 |         .set(auth)
    > 109 |         .expect(200);
          |          ^
      110 |
      111 |       expect(response.body).toHaveProperty("success", true);
      112 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:109:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Performance and Returns APIs › GET /api/portfolio/benchmark - should return benchmark comparison

    expected 200 "OK", got 401 "Unauthorized"

      117 |         .get("/api/portfolio/benchmark")
      118 |         .set(auth)
    > 119 |         .expect(200);
          |          ^
      120 |
      121 |       expect(response.body).toHaveProperty("success", true);
      122 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:119:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk - should return risk assessment

    expected 200 "OK", got 401 "Unauthorized"

      130 |         .get("/api/portfolio/risk")
      131 |         .set(auth)
    > 132 |         .expect(200);
          |          ^
      133 |
      134 |       expect(response.body).toHaveProperty("success", true);
      135 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:132:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk-analysis - should return risk analysis

    expected 200 "OK", got 401 "Unauthorized"

      140 |         .get("/api/portfolio/risk-analysis")
      141 |         .set(auth)
    > 142 |         .expect(200);
          |          ^
      143 |
      144 |       expect(response.body).toHaveProperty("success", true);
      145 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:142:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/analysis - should return detailed risk analysis

    expected 200 "OK", got 401 "Unauthorized"

      150 |         .get("/api/portfolio/risk/analysis")
      151 |         .set(auth)
    > 152 |         .expect(200);
          |          ^
      153 |
      154 |       expect(response.body).toHaveProperty("success", true);
      155 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:152:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/var - should return VaR analysis

    expected 200 "OK", got 401 "Unauthorized"

      160 |         .get("/api/portfolio/risk/var")
      161 |         .set(auth)
    > 162 |         .expect(200);
          |          ^
      163 |
      164 |       expect(response.body).toHaveProperty("success", true);
      165 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:162:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/stress-test - should return stress test results

    expected 200 "OK", got 401 "Unauthorized"

      170 |         .get("/api/portfolio/risk/stress-test")
      171 |         .set(auth)
    > 172 |         .expect(200);
          |          ^
      173 |
      174 |       expect(response.body).toHaveProperty("success", true);
      175 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:172:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Risk Management APIs › GET /api/portfolio/risk/concentration - should return concentration risk

    expected 200 "OK", got 401 "Unauthorized"

      180 |         .get("/api/portfolio/risk/concentration")
      181 |         .set(auth)
    > 182 |         .expect(200);
          |          ^
      183 |
      184 |       expect(response.body).toHaveProperty("success", true);
      185 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:182:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/rebalance - should return rebalance recommendations

    expected 200 "OK", got 401 "Unauthorized"

      193 |         .get("/api/portfolio/rebalance")
      194 |         .set(auth)
    > 195 |         .expect(200);
          |          ^
      196 |
      197 |       expect(response.body).toHaveProperty("success", true);
      198 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:195:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/optimization - should return optimization suggestions

    expected 200 "OK", got 401 "Unauthorized"

      203 |         .get("/api/portfolio/optimization")
      204 |         .set(auth)
    > 205 |         .expect(200);
          |          ^
      206 |
      207 |       expect(response.body).toHaveProperty("success", true);
      208 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:205:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/watchlist - should return portfolio watchlist

    expected 200 "OK", got 401 "Unauthorized"

      213 |         .get("/api/portfolio/watchlist")
      214 |         .set(auth)
    > 215 |         .expect(200);
          |          ^
      216 |
      217 |       expect(response.body).toHaveProperty("success", true);
      218 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:215:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Portfolio Management APIs › GET /api/portfolio/transactions - should return portfolio transactions

    expected 200 "OK", got 401 "Unauthorized"

      223 |         .get("/api/portfolio/transactions")
      224 |         .set(auth)
    > 225 |         .expect(200);
          |          ^
      226 |
      227 |       expect(response.body).toHaveProperty("success", true);
      228 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:225:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Broker Integration APIs › GET /api/portfolio/api-keys - should return API keys status

    expected 200 "OK", got 401 "Unauthorized"

      236 |         .get("/api/portfolio/api-keys")
      237 |         .set(auth)
    > 238 |         .expect(200);
          |          ^
      239 |
      240 |       expect(response.body).toHaveProperty("success", true);
      241 |       expect(response.body).toHaveProperty("data");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:238:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Broker Integration APIs › POST /api/portfolio/api-keys - should handle API key creation

    expected 200 "OK", got 401 "Unauthorized"

      251 |           apiSecret: "test-secret",
      252 |         })
    > 253 |         .expect(200);
          |          ^
      254 |
      255 |       expect(response.body).toHaveProperty("success", true);
      256 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:253:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Health and System APIs › GET /api/portfolio/health - should return portfolio service health

    expected 200 "OK", got 401 "Unauthorized"

      263 |         .get("/api/portfolio/health")
      264 |         .set(auth)
    > 265 |         .expect(200);
          |          ^
      266 |
      267 |       expect(response.body).toHaveProperty("success", true);
      268 |       expect(response.body).toHaveProperty("status", "healthy");

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:265:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › should handle invalid endpoints gracefully

    expected 404 "Not Found", got 401 "Unauthorized"

      292 |         .get("/api/portfolio/invalid-endpoint")
      293 |         .set(auth)
    > 294 |         .expect(404);
          |          ^
      295 |     });
      296 |
      297 |     test("should handle invalid user IDs gracefully", async () => {

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:294:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › should handle invalid user IDs gracefully

    expected 200 "OK", got 401 "Unauthorized"

      299 |         .get("/api/portfolio/invalid-user-id/holdings")
      300 |         .set(auth)
    > 301 |         .expect(200);
          |          ^
      302 |
      303 |       expect(response.body).toHaveProperty("success", true);
      304 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:301:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › DELETE /api/portfolio/api-keys/test-broker - should handle API key deletion

    expected 200 "OK", got 401 "Unauthorized"

      308 |         .delete("/api/portfolio/api-keys/test-broker")
      309 |         .set(auth)
    > 310 |         .expect(200);
          |          ^
      311 |
      312 |       expect(response.body).toHaveProperty("success", true);
      313 |     });

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:310:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

  ● Portfolio Integration Tests - 100% Coverage › Error Handling and Authentication › GET /api/portfolio/data - should redirect to holdings endpoint

    expected 302 "Found", got 401 "Unauthorized"

      317 |         .get("/api/portfolio/data")
      318 |         .set(auth)
    > 319 |         .expect(302);
          |          ^
      320 |
      321 |       // Verify that the redirect location contains the holdings endpoint
      322 |       expect(response.headers.location).toMatch(/\/holdings/);

      at Object.expect (tests/integration/routes/portfolio.integration.test.js:319:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at localAssert (node_modules/supertest/lib/test.js:120:14)
      at node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (node_modules/superagent/src/node/index.js:925:3)
      at callback (node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (node_modules/superagent/src/node/parsers/json.js:19:7)

FAIL tests/unit/services/aiStrategyGenerator.test.js
  ● AIStrategyGenerator Service › Integration with Logger › should log errors appropriately

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "Strategy generation failed", ObjectContaining {"error": Any<Error>}

    Number of calls: 0

      725 |       await generator.generateFromNaturalLanguage("test strategy");
      726 |
    > 727 |       expect(mockLogger.error).toHaveBeenCalledWith(
          |                                ^
      728 |         "Strategy generation failed",
      729 |         expect.objectContaining({
      730 |           error: expect.any(Error),

      at Object.toHaveBeenCalledWith (tests/unit/services/aiStrategyGenerator.test.js:727:32)

FAIL tests/integration/utils/liveDataManager.test.js
  ● Live Data Manager Integration Tests › Connection Management › should get connection status

    TypeError: Cannot read properties of null (reading 'connectionId')

      84 |
      85 |       expect(status).toBeDefined();
    > 86 |       expect(status.connectionId).toBe(connectionId);
         |                     ^
      87 |       expect(status.provider).toBe("alpaca");
      88 |       expect(status.symbols).toBeDefined();
      89 |       expect(status.status).toBe("active");

      at Object.connectionId (tests/integration/utils/liveDataManager.test.js:86:21)

  ● Live Data Manager Integration Tests › Connection Management › should remove connection successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      100 |
      101 |       expect(result).toBeDefined();
    > 102 |       expect(result.success).toBe(true);
          |                              ^
      103 |       expect(result.connectionId).toBe(connectionId);
      104 |       expect(result.removedAt).toBeDefined();
      105 |       expect(result.provider).toBe("alpaca");

      at Object.toBe (tests/integration/utils/liveDataManager.test.js:102:30)

FAIL tests/integration/utils/schemaValidator.test.js
  ● Schema Validator Integration Tests › Stock Data Validation › should reject invalid stock data

    expect(received).toContain(expected) // indexOf

    Expected value: "symbol"
    Received array: [undefined, undefined, undefined]

      55 |
      56 |       const errorFields = validation.errors.map((err) => err.field);
    > 57 |       expect(errorFields).toContain("symbol");
         |                           ^
      58 |       expect(errorFields).toContain("price");
      59 |       expect(errorFields).toContain("volume");
      60 |       expect(errorFields).toContain("timestamp");

      at Object.toContain (tests/integration/utils/schemaValidator.test.js:57:27)

  ● Schema Validator Integration Tests › Stock Data Validation › should validate portfolio data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      85 |       const validation = schemaValidator.validate(validPortfolio, "portfolio");
      86 |
    > 87 |       expect(validation.isValid).toBe(true);
         |                                  ^
      88 |       expect(validation.errors).toEqual([]);
      89 |       expect(validation.sanitizedData.holdings.length).toBe(2);
      90 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:87:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should validate buy order

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      105 |       const validation = schemaValidator.validate(buyOrder, "tradingOrder");
      106 |
    > 107 |       expect(validation.isValid).toBe(true);
          |                                  ^
      108 |       expect(validation.sanitizedData.side).toBe("buy");
      109 |       expect(validation.sanitizedData.type).toBe("market");
      110 |       expect(validation.sanitizedData.quantity).toBe(100);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:107:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should validate limit order with price

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      125 |       const validation = schemaValidator.validate(limitOrder, "tradingOrder");
      126 |
    > 127 |       expect(validation.isValid).toBe(true);
          |                                  ^
      128 |       expect(validation.sanitizedData.type).toBe("limit");
      129 |       expect(validation.sanitizedData.limitPrice).toBe(155.0);
      130 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:127:34)

  ● Schema Validator Integration Tests › Trading Order Validation › should reject invalid trading orders

    expect(received).toContain(expected) // indexOf

    Expected value: "INVALID_USER_ID"
    Received array: [undefined, undefined, undefined, undefined, undefined]

      146 |
      147 |       const errorCodes = validation.errors.map((err) => err.code);
    > 148 |       expect(errorCodes).toContain("INVALID_USER_ID");
          |                          ^
      149 |       expect(errorCodes).toContain("INVALID_SYMBOL");
      150 |       expect(errorCodes).toContain("INVALID_SIDE");
      151 |       expect(errorCodes).toContain("INVALID_QUANTITY");

      at Object.toContain (tests/integration/utils/schemaValidator.test.js:148:26)

  ● Schema Validator Integration Tests › User Data Validation › should validate user registration data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      168 |       const validation = schemaValidator.validate(userData, "userRegistration");
      169 |
    > 170 |       expect(validation.isValid).toBe(true);
          |                                  ^
      171 |       expect(validation.sanitizedData.email).toBe("test@example.com");
      172 |       expect(validation.sanitizedData.country).toBe("US");
      173 |       // Password should be excluded from sanitized data for security

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:170:34)

  ● Schema Validator Integration Tests › User Data Validation › should validate API key configuration

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      189 |       const validation = schemaValidator.validate(apiKeyConfig, "apiKeyConfig");
      190 |
    > 191 |       expect(validation.isValid).toBe(true);
          |                                  ^
      192 |       expect(validation.sanitizedData.provider).toBe("alpaca");
      193 |       expect(validation.sanitizedData.environment).toBe("paper");
      194 |       expect(Array.isArray(validation.sanitizedData.permissions)).toBe(true);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:191:34)

  ● Schema Validator Integration Tests › Market Data Validation › should validate technical indicators

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      223 |       );
      224 |
    > 225 |       expect(validation.isValid).toBe(true);
          |                                  ^
      226 |       expect(validation.sanitizedData.indicators.rsi).toBe(65.5);
      227 |       expect(validation.sanitizedData.indicators.macd.macd).toBe(1.25);
      228 |       expect(validation.sanitizedData.indicators.bollinger.upper).toBe(155.0);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:225:34)

  ● Schema Validator Integration Tests › Market Data Validation › should validate earnings data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      249 |       const validation = schemaValidator.validate(earningsData, "earningsData");
      250 |
    > 251 |       expect(validation.isValid).toBe(true);
          |                                  ^
      252 |       expect(validation.sanitizedData.quarter).toBe("Q1");
      253 |       expect(validation.sanitizedData.year).toBe(2023);
      254 |       expect(validation.sanitizedData.surprise.epsPercent).toBe(4.83);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:251:34)

  ● Schema Validator Integration Tests › Real-time Data Validation › should validate WebSocket message format

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      276 |       );
      277 |
    > 278 |       expect(validation.isValid).toBe(true);
          |                                  ^
      279 |       expect(validation.sanitizedData.type).toBe("quote");
      280 |       expect(validation.sanitizedData.symbol).toBe("AAPL");
      281 |       expect(validation.sanitizedData.data.price).toBe(150.25);

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:278:34)

  ● Schema Validator Integration Tests › Real-time Data Validation › should validate streaming data batch

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      312 |       );
      313 |
    > 314 |       expect(validation.isValid).toBe(true);
          |                                  ^
      315 |       expect(validation.sanitizedData.messages.length).toBe(2);
      316 |       expect(validation.sanitizedData.source).toBe("alpaca");
      317 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:314:34)

  ● Schema Validator Integration Tests › Custom Schema Validation › should validate with custom schema

    TypeError: schemaValidator.validateWithCustomSchema is not a function

      340 |       };
      341 |
    > 342 |       const validation = schemaValidator.validateWithCustomSchema(
          |                                          ^
      343 |         testData,
      344 |         customSchema
      345 |       );

      at Object.validateWithCustomSchema (tests/integration/utils/schemaValidator.test.js:342:42)

  ● Schema Validator Integration Tests › Custom Schema Validation › should register and use persistent custom schemas

    TypeError: schemaValidator.registerSchema is not a function

      362 |
      363 |       // Register schema
    > 364 |       schemaValidator.registerSchema(schemaName, schema);
          |                       ^
      365 |
      366 |       // Use registered schema
      367 |       const testData = { id: "test_123", value: 456 };

      at Object.registerSchema (tests/integration/utils/schemaValidator.test.js:364:23)

  ● Schema Validator Integration Tests › Data Sanitization › should sanitize and transform data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      389 |       });
      390 |
    > 391 |       expect(validation.isValid).toBe(true);
          |                                  ^
      392 |       expect(validation.sanitizedData.symbol).toBe("AAPL");
      393 |       expect(validation.sanitizedData.price).toBe(150.25);
      394 |       expect(validation.sanitizedData.description).not.toContain("<script>");

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:391:34)

  ● Schema Validator Integration Tests › Data Sanitization › should handle SQL injection attempts

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: undefined

      408 |       });
      409 |
    > 410 |       expect(validation.sanitized).toBe(true);
          |                                    ^
      411 |       expect(validation.sanitizedData.symbol).not.toContain("DROP TABLE");
      412 |       expect(validation.sanitizedData.userId).not.toContain("OR '1'='1");
      413 |       expect(validation.sanitizedData.description).not.toContain("DELETE FROM");

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:410:36)

  ● Schema Validator Integration Tests › Performance and Scalability › should cache compiled schemas for performance

    expect(received).toBeLessThan(expected)

    Expected: < 0
    Received:   0

      452 |       expect(validation1.isValid).toBe(true);
      453 |       expect(validation2.isValid).toBe(true);
    > 454 |       expect(duration2).toBeLessThan(duration1); // Cached should be faster
          |                         ^
      455 |     });
      456 |   });
      457 |

      at Object.toBeLessThan (tests/integration/utils/schemaValidator.test.js:454:25)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle malformed data gracefully

    TypeError: Cannot read properties of null (reading 'symbol')

      732 |     // Check required fields
      733 |     for (const requiredField of schema.required) {
    > 734 |       if (data[requiredField] === undefined || data[requiredField] === null) {
          |               ^
      735 |         errors.push(`Required field "${requiredField}" is missing`);
      736 |       }
      737 |     }

      at SchemaValidator.validate (utils/schemaValidator.js:734:15)
      at Object.validate (utils/schemaValidator.js:1576:51)
      at validate (tests/integration/utils/schemaValidator.test.js:463:44)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/schemaValidator.test.js:462:21)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle circular references

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      477 |       expect(
      478 |         validation.errors.some((err) => err.code === "CIRCULAR_REFERENCE")
    > 479 |       ).toBe(true);
          |         ^
      480 |     });
      481 |
      482 |     test("should handle very large numbers", () => {

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:479:9)

  ● Schema Validator Integration Tests › Error Handling and Edge Cases › should handle very large numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      496 |       expect(
      497 |         validation.errors.some((err) => err.code === "INVALID_NUMBER")
    > 498 |       ).toBe(true);
          |         ^
      499 |     });
      500 |   });
      501 |

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:498:9)

  ● Schema Validator Integration Tests › Integration with Database › should validate data before database insertion

    TypeError: schemaValidator.validateForDatabase is not a function

      509 |       };
      510 |
    > 511 |       const validation = await schemaValidator.validateForDatabase(
          |                                                ^
      512 |         stockData,
      513 |         "stock_quotes"
      514 |       );

      at Object.validateForDatabase (tests/integration/utils/schemaValidator.test.js:511:48)

  ● Schema Validator Integration Tests › Integration with Database › should handle database constraint violations

    TypeError: schemaValidator.validateForDatabase is not a function

      527 |       };
      528 |
    > 529 |       const validation = await schemaValidator.validateForDatabase(
          |                                                ^
      530 |         duplicateData,
      531 |         "stock_quotes"
      532 |       );

      at Object.validateForDatabase (tests/integration/utils/schemaValidator.test.js:529:48)

  ● Schema Validator Integration Tests › Multi-language Support › should support localized error messages

    expect(received).not.toBe(expected) // Object.is equality

    Expected: not undefined

      556 |       expect(validationEn.isValid).toBe(false);
      557 |       expect(validationEs.isValid).toBe(false);
    > 558 |       expect(validationEn.errors[0].message).not.toBe(
          |                                                  ^
      559 |         validationEs.errors[0].message
      560 |       );
      561 |     });

      at Object.toBe (tests/integration/utils/schemaValidator.test.js:558:50)

FAIL tests/integration/services/alpacaService.test.js
  ● Alpaca Service Integration Tests › Account Operations › should fetch account information

    expect(received).toEqual(expected) // deep equality

    - Expected  -  4
    + Received  + 21

      Object {
    -   "buying_power": "20000.00",
    -   "cash": "10000.00",
    -   "id": "test-account-id",
    -   "portfolio_value": "12000.00",
    +   "accountBlocked": undefined,
    +   "accountId": "test-account-id",
    +   "buyingPower": 20000,
    +   "cash": 10000,
    +   "createdAt": undefined,
    +   "currency": undefined,
    +   "dayTradeCount": NaN,
    +   "dayTradingBuyingPower": NaN,
    +   "environment": "paper",
    +   "equity": NaN,
    +   "initialMargin": NaN,
    +   "lastEquity": NaN,
    +   "longMarketValue": NaN,
    +   "maintenanceMargin": NaN,
    +   "multiplier": NaN,
    +   "patternDayTrader": undefined,
    +   "portfolioValue": 12000,
    +   "regtBuyingPower": NaN,
    +   "shortMarketValue": NaN,
        "status": "ACTIVE",
    +   "tradingBlocked": undefined,
    +   "transfersBlocked": undefined,
      }

      141 |
      142 |       expect(mockClient.getAccount).toHaveBeenCalledTimes(1);
    > 143 |       expect(account).toEqual(mockAccount);
          |                       ^
      144 |     });
      145 |
      146 |     test("should handle account fetch errors gracefully", async () => {

      at Object.toEqual (tests/integration/services/alpacaService.test.js:143:23)

  ● Alpaca Service Integration Tests › Account Operations › should fetch portfolio history

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    +   "extended_hours": true,
    +   "period": Object {
          "period": "1D",
          "timeframe": "1Min",
    +   },
    +   "timeframe": "1Day",
      },

    Number of calls: 1

      165 |       });
      166 |
    > 167 |       expect(mockClient.getPortfolioHistory).toHaveBeenCalledWith({
          |                                              ^
      168 |         period: "1D",
      169 |         timeframe: "1Min",
      170 |       });

      at Object.toHaveBeenCalledWith (tests/integration/services/alpacaService.test.js:167:46)

  ● Alpaca Service Integration Tests › Position Management › should fetch position for specific symbol

    Failed to fetch position for AAPL: Cannot read properties of undefined (reading 'find')

      820 |     } catch (error) {
      821 |       console.error("Error fetching position:", error.message);
    > 822 |       throw new Error(
          |             ^
      823 |         `Failed to fetch position for ${symbol}: ${error.message}`
      824 |       );
      825 |     }

      at AlpacaService.getPosition (utils/alpacaService.js:822:13)
      at Object.<anonymous> (tests/integration/services/alpacaService.test.js:218:24)

  ● Alpaca Service Integration Tests › Order Management › should place market buy order

    Failed to create order: Quantity must be a positive number

      739 |     } catch (error) {
      740 |       console.error("Alpaca order creation error:", error.message);
    > 741 |       throw new Error(`Failed to create order: ${error.message}`);
          |             ^
      742 |     }
      743 |   }
      744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:238:41)

  ● Alpaca Service Integration Tests › Order Management › should place limit sell order

    Failed to create order: Quantity must be a positive number

      739 |     } catch (error) {
      740 |       console.error("Alpaca order creation error:", error.message);
    > 741 |       throw new Error(`Failed to create order: ${error.message}`);
          |             ^
      742 |     }
      743 |   }
      744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:267:41)

  ● Alpaca Service Integration Tests › Order Management › should cancel specific order

    expect(received).toBe(expected) // Object.is equality

    Expected: "order-123"
    Received: undefined

      303 |
      304 |       expect(mockClient.cancelOrder).toHaveBeenCalledWith("order-123");
    > 305 |       expect(result.id).toBe("order-123");
          |                         ^
      306 |     });
      307 |
      308 |     test("should validate order parameters", async () => {

      at Object.toBe (tests/integration/services/alpacaService.test.js:305:25)

  ● Alpaca Service Integration Tests › Order Management › should validate order parameters

    expect(received).rejects.toThrow(expected)

    Expected substring: "Symbol is required"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:311:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:317:17)

  ● Alpaca Service Integration Tests › Market Data Operations › should fetch historical bars data

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      "AAPL",
      Object {
    +   "asof": null,
        "end": "2023-01-02",
    +   "feed": null,
    +   "limit": 100,
    +   "page_token": null,
        "start": "2023-01-01",
        "timeframe": "1Day",
      },

    Number of calls: 1

      396 |       });
      397 |
    > 398 |       expect(mockClient.getBars).toHaveBeenCalledWith("AAPL", {
          |                                  ^
      399 |         start: "2023-01-01",
      400 |         end: "2023-01-02",
      401 |         timeframe: "1Day",

      at Object.toHaveBeenCalledWith (tests/integration/services/alpacaService.test.js:398:34)

  ● Alpaca Service Integration Tests › Error Handling and Edge Cases › should handle market closed scenarios

    expect(received).rejects.toThrow(expected)

    Expected substring: "Market is closed"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:495:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:501:17)

  ● Alpaca Service Integration Tests › Error Handling and Edge Cases › should handle insufficient funds

    expect(received).rejects.toThrow(expected)

    Expected substring: "Insufficient buying power"
    Received message:   "Failed to create order: Quantity must be a positive number"

          739 |     } catch (error) {
          740 |       console.error("Alpaca order creation error:", error.message);
        > 741 |       throw new Error(`Failed to create order: ${error.message}`);
              |             ^
          742 |     }
          743 |   }
          744 |

      at AlpacaService.createOrder (utils/alpacaService.js:741:13)
      at Object.createOrder (tests/integration/services/alpacaService.test.js:510:23)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/integration/services/alpacaService.test.js:516:17)

FAIL tests/integration/utils/riskEngine.test.js
  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should calculate portfolio-wide risk metrics from database

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should identify concentration risk

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Portfolio Risk Assessment with Database Integration › should calculate sector allocation risk

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should calculate volatility from historical price data

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should handle insufficient data gracefully

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Historical Volatility Analysis › should calculate beta relative to market

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate portfolio VaR using historical method

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate VaR for different confidence levels

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Value at Risk (VaR) Calculations › should calculate parametric VaR

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Position Sizing and Risk Management › should recommend optimal position sizes

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Position Sizing and Risk Management › should validate position size against risk limits

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Correlation and Covariance Analysis › should calculate correlation matrix for portfolio

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Correlation and Covariance Analysis › should identify highly correlated positions

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Stress Testing and Scenario Analysis › should perform market crash stress test

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Stress Testing and Scenario Analysis › should perform custom scenario analysis

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Risk Monitoring and Alerts › should monitor portfolio risk limits

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Risk Monitoring and Alerts › should generate risk alerts for violations

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Performance and Scalability › should handle large portfolios efficiently

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Performance and Scalability › should maintain accuracy with concurrent calculations

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle empty portfolio gracefully

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle database connection errors

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

  ● Risk Engine Integration Tests › Error Handling and Edge Cases › should handle invalid risk parameters

    error: column "cost_basis" of relation "portfolio_holdings" does not exist

      1349 |     });
      1350 |
    > 1351 |     const result = await Promise.race([
           |                    ^
      1352 |       pool.query(text, params),
      1353 |       timeoutPromise,
      1354 |     ]);

      at node_modules/pg-pool/index.js:45:11
      at query (utils/database.js:1351:20)
      at setupTestData (tests/integration/utils/riskEngine.test.js:49:7)
      at Object.<anonymous> (tests/integration/utils/riskEngine.test.js:22:5)

FAIL tests/integration/utils/logger.test.js
  ● Logger Integration Tests › Error Handling › should handle circular references in context

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "Converting circular structure to JSON
        --> starting at object with constructor 'Object'
        --- property 'self' closes the circle"

          89 |     } else {
          90 |       // JSON format for production (structured logging)
        > 91 |       console.log(JSON.stringify(logEntry));
             |                        ^
          92 |     }
          93 |   }
          94 |

      at Logger.stringify [as output] (utils/logger.js:91:24)
      at Logger.output [as info] (utils/logger.js:144:10)
      at info (tests/integration/utils/logger.test.js:584:16)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/logger.test.js:585:14)
      at Object.toThrow (tests/integration/utils/logger.test.js:585:14)

FAIL tests/integration/utils/apiKeyService.test.js
  ● API Key Service Integration Tests › API Key Encryption › should encrypt and decrypt API keys

    TypeError: apiKeyService.encryptApiKey is not a function

      24 |       const userSalt = "user-salt-456";
      25 |
    > 26 |       const encrypted = await apiKeyService.encryptApiKey(testKey, userSalt);
         |                                             ^
      27 |       expect(encrypted).toBeDefined();
      28 |       expect(encrypted).not.toBe(testKey);
      29 |

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:26:45)

  ● API Key Service Integration Tests › API Key Encryption › should handle encryption with different salts

    TypeError: apiKeyService.encryptApiKey is not a function

      37 |       const salt2 = "salt2";
      38 |
    > 39 |       const encrypted1 = await apiKeyService.encryptApiKey(testKey, salt1);
         |                                              ^
      40 |       const encrypted2 = await apiKeyService.encryptApiKey(testKey, salt2);
      41 |
      42 |       // Same key with different salts should produce different encrypted results

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:39:46)

  ● API Key Service Integration Tests › API Key Encryption › should handle decryption with wrong salt gracefully

    TypeError: apiKeyService.encryptApiKey is not a function

      57 |       const wrongSalt = "wrong-salt";
      58 |
    > 59 |       const encrypted = await apiKeyService.encryptApiKey(testKey, correctSalt);
         |                                             ^
      60 |
      61 |       // Should not decrypt correctly with wrong salt
      62 |       try {

      at Object.encryptApiKey (tests/integration/utils/apiKeyService.test.js:59:45)

  ● API Key Service Integration Tests › JWT Token Validation › should handle JWT token validation

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      134 |       expect(result).toBeDefined();
      135 |       // Invalid token should return null or false
    > 136 |       expect(result === null || result === false).toBe(true);
          |                                                   ^
      137 |     });
      138 |
      139 |     test("should check JWT circuit breaker", () => {

      at Object.toBe (tests/integration/utils/apiKeyService.test.js:136:51)

  ● API Key Service Integration Tests › JWT Token Validation › should check JWT circuit breaker

    TypeError: apiKeyService.checkJwtCircuitBreaker is not a function

      138 |
      139 |     test("should check JWT circuit breaker", () => {
    > 140 |       const circuitBreakerStatus = apiKeyService.checkJwtCircuitBreaker();
          |                                                  ^
      141 |       expect(typeof circuitBreakerStatus).toBe("boolean");
      142 |     });
      143 |

      at Object.checkJwtCircuitBreaker (tests/integration/utils/apiKeyService.test.js:140:50)

  ● API Key Service Integration Tests › JWT Token Validation › should record JWT success and failure

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "apiKeyService.recordJwtSuccess is not a function"

          145 |       // These methods should not throw errors
          146 |       expect(() => {
        > 147 |         apiKeyService.recordJwtSuccess();
              |                       ^
          148 |         apiKeyService.recordJwtFailure(new Error("test error"));
          149 |       }).not.toThrow();
          150 |     });

      at recordJwtSuccess (tests/integration/utils/apiKeyService.test.js:147:23)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:149:14)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:149:14)

  ● API Key Service Integration Tests › Circuit Breaker Functionality › should check circuit breaker status

    TypeError: apiKeyService.checkCircuitBreaker is not a function

      153 |   describe("Circuit Breaker Functionality", () => {
      154 |     test("should check circuit breaker status", () => {
    > 155 |       const status = apiKeyService.checkCircuitBreaker();
          |                                    ^
      156 |       expect(typeof status).toBe("boolean");
      157 |     });
      158 |

      at Object.checkCircuitBreaker (tests/integration/utils/apiKeyService.test.js:155:36)

  ● API Key Service Integration Tests › Circuit Breaker Functionality › should record success and failure

    expect(received).not.toThrow()

    Error name:    "TypeError"
    Error message: "apiKeyService.recordSuccess is not a function"

          160 |       // These methods should not throw errors
          161 |       expect(() => {
        > 162 |         apiKeyService.recordSuccess();
              |                       ^
          163 |         apiKeyService.recordFailure(new Error("test error"));
          164 |       }).not.toThrow();
          165 |     });

      at recordSuccess (tests/integration/utils/apiKeyService.test.js:162:23)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:164:14)
      at Object.toThrow (tests/integration/utils/apiKeyService.test.js:164:14)

  ● API Key Service Integration Tests › Audit Logging › should log audit events

    TypeError: apiKeyService.logAuditEvent is not a function

      175 |       // Should not throw error
      176 |       await expect(
    > 177 |         apiKeyService.logAuditEvent(userId, action, provider, sessionId)
          |                       ^
      178 |       ).resolves.not.toThrow();
      179 |     });
      180 |

      at Object.logAuditEvent (tests/integration/utils/apiKeyService.test.js:177:23)

  ● API Key Service Integration Tests › Audit Logging › should handle audit logging failures gracefully

    TypeError: apiKeyService.logAuditEvent is not a function

      182 |       // Should not throw even with invalid data
      183 |       await expect(
    > 184 |         apiKeyService.logAuditEvent(null, null, null, null)
          |                       ^
      185 |       ).resolves.not.toThrow();
      186 |     });
      187 |   });

      at Object.logAuditEvent (tests/integration/utils/apiKeyService.test.js:184:23)

  ● API Key Service Integration Tests › Encryption Key Management › should get encryption key

    TypeError: apiKeyService.getEncryptionKey is not a function

      189 |   describe("Encryption Key Management", () => {
      190 |     test("should get encryption key", async () => {
    > 191 |       const encryptionKey = await apiKeyService.getEncryptionKey();
          |                                                 ^
      192 |       expect(encryptionKey).toBeDefined();
      193 |       expect(typeof encryptionKey).toBe("string");
      194 |     });

      at Object.getEncryptionKey (tests/integration/utils/apiKeyService.test.js:191:49)

FAIL tests/integration/utils/alertSystem.test.js
  ● Alert System Integration Tests › Alert Processing and Database Integration › should create and store alerts in database

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should handle multiple alert types

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should process provider performance alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Processing and Database Integration › should handle cost monitoring alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Subscription and Filtering › should manage alert subscriptions

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Subscription and Filtering › should handle multiple subscriptions

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Deduplication and Rate Limiting › should deduplicate similar alerts

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Deduplication and Rate Limiting › should respect rate limiting

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Metrics and Analytics › should calculate alert statistics

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Alert Metrics and Analytics › should track alert trends

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should handle invalid alert data gracefully

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should recover from subscription callback errors

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Error Handling and Recovery › should handle database connectivity issues

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Configuration and Customization › should allow threshold customization

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Configuration and Customization › should support custom alert processors

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Performance and Scalability › should handle high volume of alerts efficiently

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Performance and Scalability › should maintain memory usage under control

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)

  ● Alert System Integration Tests › Integration with Real-Time Services › should integrate with live data monitoring

    TypeError: alertSystem.clearHistory is not a function

      26 |   beforeEach(() => {
      27 |     // Reset alert system for each test
    > 28 |     alertSystem.clearHistory();
         |                 ^
      29 |     alertSystem.clearSubscriptions();
      30 |   });
      31 |

      at Object.clearHistory (tests/integration/utils/alertSystem.test.js:28:17)


  ● Test suite failed to run

    TypeError: alertSystem.stop is not a function

      19 |   afterAll(async () => {
      20 |     if (alertSystem) {
    > 21 |       alertSystem.stop();
         |                   ^
      22 |     }
      23 |     await closeDatabase();
      24 |   });

      at Object.stop (tests/integration/utils/alertSystem.test.js:21:19)

FAIL tests/integration/utils/sentimentEngine.test.js
  ● Sentiment Engine Integration Tests › Score to Label Conversion › should handle invalid scores gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: "neutral"
    Received: "positive"

      141 |       invalidScores.forEach((score) => {
      142 |         const label = sentimentEngine.scoreToLabel(score);
    > 143 |         expect(label).toBe("neutral");
          |                       ^
      144 |       });
      145 |     });
      146 |

      at toBe (tests/integration/utils/sentimentEngine.test.js:143:23)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/utils/sentimentEngine.test.js:141:21)

FAIL tests/integration/utils/newsAnalyzer.test.js
  ● News Analyzer Integration Tests › News Data Processing › should analyze news sentiment

    expect(received).toBeDefined()

    Received: undefined

      34 |       expect(sentiment).toBeDefined();
      35 |       expect(sentiment.score).toBeDefined();
    > 36 |       expect(sentiment.magnitude).toBeDefined();
         |                                   ^
      37 |       expect(sentiment.label).toBeDefined();
      38 |
      39 |       expect(typeof sentiment.score).toBe("number");

      at Object.toBeDefined (tests/integration/utils/newsAnalyzer.test.js:36:35)

  ● News Analyzer Integration Tests › News Data Processing › should extract key topics from news

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      54 |
      55 |       expect(Array.isArray(topics)).toBe(true);
    > 56 |       expect(topics.length).toBeGreaterThan(0);
         |                             ^
      57 |
      58 |       topics.forEach((topic) => {
      59 |         expect(topic.keyword).toBeDefined();

      at Object.toBeGreaterThan (tests/integration/utils/newsAnalyzer.test.js:56:29)

  ● News Analyzer Integration Tests › Real-time News Processing › should process news feed

    TypeError: newsAnalyzer.processNewsFeed is not a function

      83 |       ];
      84 |
    > 85 |       const processedFeed = await newsAnalyzer.processNewsFeed(newsFeed);
         |                                                ^
      86 |
      87 |       expect(Array.isArray(processedFeed)).toBe(true);
      88 |       expect(processedFeed.length).toBe(newsFeed.length);

      at Object.processNewsFeed (tests/integration/utils/newsAnalyzer.test.js:85:48)

  ● News Analyzer Integration Tests › Real-time News Processing › should handle high-volume news processing

    TypeError: newsAnalyzer.processBulkNews is not a function

      103 |
      104 |       const startTime = Date.now();
    > 105 |       const processed = await newsAnalyzer.processBulkNews(largeNewsFeed);
          |                                            ^
      106 |       const duration = Date.now() - startTime;
      107 |
      108 |       expect(processed.length).toBe(100);

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:105:44)

  ● News Analyzer Integration Tests › Symbol-Specific Analysis › should analyze news for specific symbols

    TypeError: newsAnalyzer.getSymbolNews is not a function

      119 |     test("should analyze news for specific symbols", async () => {
      120 |       const symbol = "AAPL";
    > 121 |       const symbolNews = await newsAnalyzer.getSymbolNews(symbol, {
          |                                             ^
      122 |         limit: 10,
      123 |       });
      124 |

      at Object.getSymbolNews (tests/integration/utils/newsAnalyzer.test.js:121:45)

  ● News Analyzer Integration Tests › Symbol-Specific Analysis › should calculate symbol sentiment score

    TypeError: newsAnalyzer.getSymbolSentimentScore is not a function

      133 |     test("should calculate symbol sentiment score", async () => {
      134 |       const symbol = "AAPL";
    > 135 |       const sentimentScore = await newsAnalyzer.getSymbolSentimentScore(symbol);
          |                                                 ^
      136 |
      137 |       expect(sentimentScore).toBeDefined();
      138 |       expect(sentimentScore.composite).toBeDefined();

      at Object.getSymbolSentimentScore (tests/integration/utils/newsAnalyzer.test.js:135:49)

  ● News Analyzer Integration Tests › Trend Analysis › should identify trending topics

    TypeError: newsAnalyzer.getTrendingTopics is not a function

      149 |   describe("Trend Analysis", () => {
      150 |     test("should identify trending topics", async () => {
    > 151 |       const trendingTopics = await newsAnalyzer.getTrendingTopics({
          |                                                 ^
      152 |         period: "24h",
      153 |       });
      154 |

      at Object.getTrendingTopics (tests/integration/utils/newsAnalyzer.test.js:151:49)

  ● News Analyzer Integration Tests › Trend Analysis › should analyze sentiment trends over time

    TypeError: newsAnalyzer.analyzeSentimentTrends is not a function

      167 |     test("should analyze sentiment trends over time", async () => {
      168 |       const symbol = "AAPL";
    > 169 |       const trendAnalysis = await newsAnalyzer.analyzeSentimentTrends(symbol, {
          |                                                ^
      170 |         period: "7days",
      171 |         granularity: "1hour",
      172 |       });

      at Object.analyzeSentimentTrends (tests/integration/utils/newsAnalyzer.test.js:169:48)

  ● News Analyzer Integration Tests › News Source Quality › should evaluate news source credibility

    TypeError: newsAnalyzer.evaluateSourceCredibility is not a function

      191 |       for (const source of sources) {
      192 |         const credibility =
    > 193 |           await newsAnalyzer.evaluateSourceCredibility(source);
          |                              ^
      194 |
      195 |         expect(credibility).toBeDefined();
      196 |         expect(credibility.score).toBeDefined();

      at Object.evaluateSourceCredibility (tests/integration/utils/newsAnalyzer.test.js:193:30)

  ● News Analyzer Integration Tests › News Source Quality › should weight analysis by source quality

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      224 |         await newsAnalyzer.analyzeSentiment(lowQualityArticle);
      225 |
    > 226 |       expect(highQualitySentiment.confidence).toBeGreaterThan(
          |                                               ^
      227 |         lowQualitySentiment.confidence
      228 |       );
      229 |       expect(highQualitySentiment.weight).toBeGreaterThan(

      at Object.toBeGreaterThan (tests/integration/utils/newsAnalyzer.test.js:226:47)

  ● News Analyzer Integration Tests › Language Processing › should handle multiple languages

    expect(received).toBe(expected) // Object.is equality

    Expected: "en"
    Received: undefined

      252 |
      253 |         expect(analysis).toBeDefined();
    > 254 |         expect(analysis.language).toBe(article.language);
          |                                   ^
      255 |         expect(analysis.sentiment).toBeDefined();
      256 |       }
      257 |     });

      at Object.toBe (tests/integration/utils/newsAnalyzer.test.js:254:35)

  ● News Analyzer Integration Tests › Language Processing › should detect article language automatically

    TypeError: newsAnalyzer.detectLanguageAndAnalyze is not a function

      264 |       };
      265 |
    > 266 |       const analysis = await newsAnalyzer.detectLanguageAndAnalyze(article);
          |                                           ^
      267 |
      268 |       expect(analysis).toBeDefined();
      269 |       expect(analysis.detectedLanguage).toBe("fr");

      at Object.detectLanguageAndAnalyze (tests/integration/utils/newsAnalyzer.test.js:266:43)

  ● News Analyzer Integration Tests › Market Impact Analysis › should predict market impact from news

    TypeError: newsAnalyzer.predictMarketImpact is not a function

      282 |       };
      283 |
    > 284 |       const marketImpact = await newsAnalyzer.predictMarketImpact(breakingNews);
          |                                               ^
      285 |
      286 |       expect(marketImpact).toBeDefined();
      287 |       expect(marketImpact.impactScore).toBeDefined();

      at Object.predictMarketImpact (tests/integration/utils/newsAnalyzer.test.js:284:47)

  ● News Analyzer Integration Tests › Market Impact Analysis › should correlate news with price movements

    TypeError: newsAnalyzer.correlateSentimentWithPrice is not a function

      298 |     test("should correlate news with price movements", async () => {
      299 |       const symbol = "AAPL";
    > 300 |       const correlation = await newsAnalyzer.correlateSentimentWithPrice(
          |                                              ^
      301 |         symbol,
      302 |         {
      303 |           period: "30days",

      at Object.correlateSentimentWithPrice (tests/integration/utils/newsAnalyzer.test.js:300:46)

  ● News Analyzer Integration Tests › Alert Integration › should trigger news-based alerts

    TypeError: newsAnalyzer.setupNewsAlert is not a function

      326 |       };
      327 |
    > 328 |       const newsAlert = await newsAnalyzer.setupNewsAlert(alertConfig);
          |                                            ^
      329 |
      330 |       expect(newsAlert).toBeDefined();
      331 |       expect(newsAlert.alertId).toBeDefined();

      at Object.setupNewsAlert (tests/integration/utils/newsAnalyzer.test.js:328:44)

  ● News Analyzer Integration Tests › Alert Integration › should process real-time news alerts

    TypeError: newsAnalyzer.processNewsAlert is not a function

      344 |       };
      345 |
    > 346 |       const alertTriggered = await newsAnalyzer.processNewsAlert(urgentNews);
          |                                                 ^
      347 |
      348 |       expect(alertTriggered).toBeDefined();
      349 |       expect(typeof alertTriggered.triggered).toBe("boolean");

      at Object.processNewsAlert (tests/integration/utils/newsAnalyzer.test.js:346:49)

  ● News Analyzer Integration Tests › Performance and Scalability › should process news articles efficiently

    TypeError: newsAnalyzer.processBulkNews is not a function

      364 |
      365 |       const startTime = Date.now();
    > 366 |       const results = await newsAnalyzer.processBulkNews(testArticles);
          |                                          ^
      367 |       const duration = Date.now() - startTime;
      368 |
      369 |       expect(results.length).toBe(50);

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:366:42)

  ● News Analyzer Integration Tests › Performance and Scalability › should handle memory efficiently with large datasets

    TypeError: newsAnalyzer.processBulkNews is not a function

      387 |       }));
      388 |
    > 389 |       await newsAnalyzer.processBulkNews(largeDataset);
          |                          ^
      390 |
      391 |       const finalMemory = process.memoryUsage().heapUsed;
      392 |       const memoryIncrease = finalMemory - initialMemory;

      at Object.processBulkNews (tests/integration/utils/newsAnalyzer.test.js:389:26)

FAIL tests/integration/routes/liveData.integration.test.js (7.385 s)
  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should require authentication for latest data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      329 |       const response = await request(app).get("/api/livedata/latest/AAPL");
      330 |
    > 331 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      332 |     });
      333 |
      334 |     test("should return latest data for single symbol", async () => {

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:331:52)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should return latest data for single symbol

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      337 |         .set("Authorization", `Bearer ${authToken}`);
      338 |
    > 339 |       expect(response.status).toBe(200);
          |                               ^
      340 |
      341 |       if (response.status === 200) {
      342 |         expect(response.body).toHaveProperty("success", true);

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:339:31)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should return latest data for multiple symbols

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      353 |         .set("Authorization", `Bearer ${authToken}`);
      354 |
    > 355 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      356 |
      357 |       if (response.status === 200) {
      358 |         expect(response.body).toHaveProperty("data");

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:355:52)

  ● Live Data Routes Integration Tests › GET /api/livedata/latest/:symbols (Authenticated) › should handle fields parameter for latest data

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      366 |         .set("Authorization", `Bearer ${authToken}`);
      367 |
    > 368 |       expect([200, 400].includes(response.status)).toBe(true);
          |                                                    ^
      369 |     });
      370 |   });
      371 |

      at Object.toBe (tests/integration/routes/liveData.integration.test.js:368:52)

FAIL tests/integration/routes/stocks.integration.test.js
  ● Stocks Routes Integration Tests › GET /api/stocks/trending › should return trending stocks

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      128 |         .set("Authorization", "Bearer dev-bypass-token");
      129 |
    > 130 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      131 |     });
      132 |
      133 |     test("should handle timeframe parameters", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:130:52)

  ● Stocks Routes Integration Tests › GET /api/stocks/trending › should handle timeframe parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      136 |         .set("Authorization", "Bearer dev-bypass-token");
      137 |
    > 138 |       expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                         ^
      139 |     });
      140 |
      141 |     test("should require authentication for trending", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:138:57)

  ● Stocks Routes Integration Tests › Watchlist Operations › should handle watchlist requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      178 |         .set("Authorization", "Bearer dev-bypass-token");
      179 |
    > 180 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      181 |     });
      182 |
      183 |     test("should handle adding to watchlist", async () => {

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:180:52)

  ● Stocks Routes Integration Tests › Error Handling and Edge Cases › should handle concurrent requests

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      333 |
      334 |       responses.forEach((response) => {
    > 335 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      336 |       });
      337 |     });
      338 |

      at toBe (tests/integration/routes/stocks.integration.test.js:335:59)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/integration/routes/stocks.integration.test.js:334:17)

  ● Stocks Routes Integration Tests › Error Handling and Edge Cases › should handle invalid parameters gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      352 |       for (const req of invalidRequests) {
      353 |         const response = await req;
    > 354 |         expect([200, 400, 401].includes(response.status)).toBe(true);
          |                                                           ^
      355 |       }
      356 |     });
      357 |

      at Object.toBe (tests/integration/routes/stocks.integration.test.js:354:59)

FAIL tests/integration/routes/etf.integration.test.js
  ● ETF Routes Integration Tests › Performance and Edge Cases › should handle authentication edge cases for protected endpoints

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      496 |         .set("Authorization", "Bearer invalid-token");
      497 |
    > 498 |       expect([200, 401].includes(response.status)).toBe(true);
          |                                                    ^
      499 |     });
      500 |
      501 |     test("should handle stress testing with multiple concurrent requests", async () => {

      at Object.toBe (tests/integration/routes/etf.integration.test.js:498:52)

FAIL tests/unit/services/alpacaIntegration.test.js
  ● Alpaca Integration Service Unit Tests › Account Information › should retrieve account information

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "test-user-123", "alpaca"

    Number of calls: 0

      55 |       expect(result).toEqual(mockAccountInfo);
      56 |       expect(alpacaService.getAccountInfo).toHaveBeenCalledWith(testUserId);
    > 57 |       expect(getDecryptedApiKey).toHaveBeenCalledWith(testUserId, "alpaca");
         |                                  ^
      58 |     });
      59 |
      60 |     test("should handle account information errors", async () => {

      at Object.toHaveBeenCalledWith (tests/unit/services/alpacaIntegration.test.js:57:34)

  ● Alpaca Integration Service Unit Tests › Error Handling › should handle authentication failures

    expect(received).rejects.toThrow(expected)

    Expected substring: "Invalid API credentials"
    Received message:   "Request timeout"

          391 |     test("should handle network timeouts", async () => {
          392 |       alpacaService.getAccountInfo.mockRejectedValue(
        > 393 |         new Error("Request timeout")
              |         ^
          394 |       );
          395 |
          396 |       await expect(alpacaService.getAccountInfo(testUserId)).rejects.toThrow(

      at Object.<anonymous> (tests/unit/services/alpacaIntegration.test.js:393:9)
      at Object.toThrow (node_modules/expect/build/index.js:218:22)
      at Object.toThrow (tests/unit/services/alpacaIntegration.test.js:406:70)

FAIL tests/integration/routes/risk.integration.test.js
  ● Risk Routes Integration › GET /risk/analysis › should handle risk analysis requests

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      60 |         });
      61 |
    > 62 |       expect(response.status).toBe(200);
         |                               ^
      63 |       expect(response.body).toBeDefined();
      64 |       expect(response.body).toHaveProperty("success", true);
      65 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:62:31)

  ● Risk Routes Integration › GET /risk/analysis › should handle different time periods

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      71 |         .query({ period: "1m" });
      72 |
    > 73 |       expect(response.status).toBe(200);
         |                               ^
      74 |       expect(response.body).toBeDefined();
      75 |       expect(response.body).toHaveProperty("success", true);
      76 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:73:31)

  ● Risk Routes Integration › GET /risk/analysis › should handle missing query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      81 |         .set("Authorization", "Bearer dev-bypass-token");
      82 |
    > 83 |       expect(response.status).toBe(200);
         |                               ^
      84 |       expect(response.body).toBeDefined();
      85 |       expect(response.body).toHaveProperty("success", true);
      86 |     });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:83:31)

  ● Risk Routes Integration › Security tests › should handle XSS attempts in query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      144 |         });
      145 |
    > 146 |       expect(response.status).toBe(200);
          |                               ^
      147 |       expect(response.body).toBeDefined();
      148 |     });
      149 |

      at Object.toBe (tests/integration/routes/risk.integration.test.js:146:31)

  ● Risk Routes Integration › Security tests › should handle malicious query parameters

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      157 |         });
      158 |
    > 159 |       expect(response.status).toBe(200);
          |                               ^
      160 |       expect(response.body).toBeDefined();
      161 |     });
      162 |   });

      at Object.toBe (tests/integration/routes/risk.integration.test.js:159:31)

FAIL tests/integration/routes/auth.integration.test.js
  ● Authentication Routes Integration › GET /auth/me › should require valid token

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      170 |       // Due to development bypass in auth middleware (lines 30-47 in auth.js),
      171 |       // requests without tokens may still succeed in NODE_ENV=test
    > 172 |       expect(response.status).toBe(200);
          |                               ^
      173 |       if (response.status === 401) {
      174 |         expect(response.body.success).toBe(false);
      175 |       } else {

      at Object.toBe (tests/integration/routes/auth.integration.test.js:172:31)

  ● Authentication Routes Integration › POST /auth/confirm › should confirm user registration

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      196 |       });
      197 |
    > 198 |       expect([400, 422]).toContain(response.status);
          |                          ^
      199 |       expect(response.body.success).toBe(false);
      200 |       expect(response.body.error).toBe("Confirmation failed");
      201 |       if (response.status === 200) {

      at Object.toContain (tests/integration/routes/auth.integration.test.js:198:26)

  ● Authentication Routes Integration › Security and edge cases › should handle XSS attempts in registration

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      286 |
      287 |       // Cognito will handle input validation
    > 288 |       expect([400, 422]).toContain(response.status);
          |                          ^
      289 |       expect(response.body.success).toBe(false);
      290 |     });
      291 |

      at Object.toContain (tests/integration/routes/auth.integration.test.js:288:26)

  ● Authentication Routes Integration › Security and edge cases › should handle extremely long inputs

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 422]

      322 |         });
      323 |
    > 324 |       expect([400, 422]).toContain(response.status);
          |                          ^
      325 |       expect(response.body.success).toBe(false);
      326 |     });
      327 |   });

      at Object.toContain (tests/integration/routes/auth.integration.test.js:324:26)


Test Suites: 40 failed, 87 skipped, 25 passed, 65 of 152 total
Tests:       306 failed, 2473 skipped, 937 passed, 3716 total
Snapshots:   0 total
Time:        84.982 s, estimated 131 s
Ran all test suites with tests matching "Integration".
🧹 Global test teardown complete
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
