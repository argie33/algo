<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="515" failures="84" errors="0" time="16.689">
  <testsuite name="Enhanced Authentication Service Unit Tests" errors="0" failures="0" skipped="1" timestamp="2025-07-25T04:02:07" time="0.849" tests="1">
    <testcase classname="Enhanced Authentication Service Unit Tests" name="should skip enhanced auth tests" time="0">
      <skipped/>
    </testcase>
  </testsuite>
  <testsuite name="Portfolio Service Pure Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.073" tests="11">
    <testcase classname="Portfolio Service Pure Unit Tests › Service Initialization" name="should initialize without AlpacaService API keys" time="0.023">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Service Initialization" name="should initialize AlpacaService on demand" time="0.005">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Service Initialization" name="should not initialize AlpacaService without API keys" time="0.005">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Database Operations (Mocked)" name="should retrieve user portfolio with mocked database" time="0.008">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Database Operations (Mocked)" name="should update portfolio holdings with mocked database" time="0.006">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Database Operations (Mocked)" name="should save portfolio metadata with mocked database" time="0.005">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Database Operations (Mocked)" name="should return health check status" time="0.004">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › AlpacaService Integration" name="should sync portfolio from broker with valid API keys" time="0.005">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › AlpacaService Integration" name="should fail to sync portfolio without API keys" time="0.056">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Error Handling" name="should handle database errors gracefully" time="0.01">
    </testcase>
    <testcase classname="Portfolio Service Pure Unit Tests › Error Handling" name="should handle transaction errors gracefully" time="0.006">
    </testcase>
  </testsuite>
  <testsuite name="Database Utilities Unit Tests (Industry Standard)" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.148" tests="9">
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Table Name Extraction" name="extracts table names from simple SELECT queries" time="0.053">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Table Name Extraction" name="extracts table names from INSERT queries" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Table Name Extraction" name="extracts table names from CTE queries" time="0.003">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Table Name Extraction" name="returns &quot;unknown&quot; for malformed queries" time="0.016">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Connection Pool Configuration" name="calculates optimal pool size for Lambda environment" time="0.039">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Connection Pool Configuration" name="uses production configuration for non-Lambda environment" time="0.005">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Connection Pool Configuration" name="uses development configuration by default" time="0.004">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Function Exports" name="exports all required database functions" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests (Industry Standard) › Database Exports" name="exports core database functions" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="Database Utilities Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.189" tests="17">
    <testcase classname="Database Utilities Unit Tests › Database Configuration Management" name="handles missing database configuration gracefully" time="0.055">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Database Configuration Management" name="validates SSL configuration settings" time="0.019">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Connection Pool Management" name="handles pool warming for Lambda optimization" time="0.003">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Query Execution and Management" name="extracts table names from SQL queries correctly" time="0.012">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Query Execution and Management" name="handles safe queries with table existence validation" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Query Execution and Management" name="rejects safe queries when required tables are missing" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Transaction Management" name="rolls back transactions on errors" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Schema Validation and Table Management" name="checks multiple table existence efficiently" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Schema Validation and Table Management" name="provides database schema functions" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Health Checks and Monitoring" name="performs comprehensive health checks" time="0.001">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Health Checks and Monitoring" name="handles circuit breaker open state in health checks" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Health Checks and Monitoring" name="reports unhealthy state for database connection failures" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Lambda Optimization Features" name="calculates appropriate pool sizes for Lambda concurrency" time="0.004">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Connection Cleanup and Resource Management" name="handles connection cleanup errors gracefully" time="0.002">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Edge Cases and Error Scenarios" name="handles malformed SQL queries gracefully" time="0.004">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Edge Cases and Error Scenarios" name="validates environment variable data types" time="0.005">
    </testcase>
    <testcase classname="Database Utilities Unit Tests › Edge Cases and Error Scenarios" name="handles missing optional configuration gracefully" time="0.005">
    </testcase>
  </testsuite>
  <testsuite name="BacktestingService REAL Implementation Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.221" tests="13">
    <testcase classname="BacktestingService REAL Implementation Tests › Real Service Initialization" name="initializes with correct strategy mappings from YOUR implementation" time="0.061">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Service Initialization" name="has real TechnicalAnalysisService instance" time="0.01">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy generates BUY signal when RSI &lt; 30 (YOUR implementation)" time="0.03">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy generates SELL signal when RSI &gt; 70 (YOUR implementation)" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy returns null when RSI is neutral (30-70 range)" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real MACD Strategy Implementation" name="MACD strategy detects bullish crossover (YOUR implementation)" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real MACD Strategy Implementation" name="MACD strategy handles insufficient data gracefully" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Bollinger Bands Strategy Implementation" name="Bollinger strategy generates BUY when price below lower band" time="0.004">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="runs complete backtest with YOUR actual implementation" time="0.047">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="validates input parameters according to YOUR implementation" time="0.04">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="processes trade execution with YOUR actual logic" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Portfolio History Tracking" name="tracks portfolio value changes through YOUR implementation" time="0.008">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Filter Data by Date" name="filters data by date range using YOUR implementation" time="0.005">
    </testcase>
  </testsuite>
  <testsuite name="WebSocket Lambda Handler - Real Implementation Tests" errors="0" failures="18" skipped="0" timestamp="2025-07-25T04:02:07" time="2.258" tests="21">
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Connection Management" name="handles new WebSocket connections with authentication" time="0.155">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Connection Management" name="handles anonymous connections without token" time="0.003">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Connection Management" name="handles WebSocket disconnections properly" time="0.002">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Symbol Subscription Management" name="handles valid symbol subscriptions" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Symbol Subscription Management" name="validates symbol format and rejects invalid symbols" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Symbol Subscription Management" name="handles unsubscription requests" time="0.002">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Ping/Pong Latency Testing" name="responds to ping with pong including timestamps" time="0.002">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Error Handling" name="handles malformed JSON in request body" time="0.002">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Error Handling" name="handles unknown route keys" time="0.003">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Error Handling" name="handles API Gateway Management API failures" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › API Key Integration" name="handles connections when API keys are available" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › API Key Integration" name="handles missing API keys gracefully" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Real-time Market Data Processing" name="handles Alpaca trade data format correctly" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Real-time Market Data Processing" name="handles Alpaca quote data format correctly" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Real-time Market Data Processing" name="handles Alpaca bar data format correctly" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Connection State Management" name="tracks connection subscriptions correctly" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Performance and Reliability" name="handles multiple concurrent connections" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Lambda Handler - Real Implementation Tests › Performance and Reliability" name="handles high-frequency subscription requests" time="0.001">
      <failure>ReferenceError: mockApiGatewayManagementApi is not defined
    at Object.mockApiGatewayManagementApi (/home/stocks/algo/webapp/lambda/tests/unit/websocket/realBroadcaster.test.js:103:5)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusHook (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:281:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:246:5)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="WebSocket Integration with Frontend" name="message format matches frontend liveDataService expectations" time="0.004">
    </testcase>
    <testcase classname="WebSocket Integration with Frontend" name="connection confirmation format matches frontend expectations" time="0.003">
    </testcase>
    <testcase classname="WebSocket Integration with Frontend" name="error message format provides actionable information" time="0.003">
    </testcase>
  </testsuite>
  <testsuite name="OptimizationEngine REAL Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.228" tests="8">
    <testcase classname="OptimizationEngine REAL Tests › Real Portfolio Math Integration" name="generates realistic mock price data with proper format" time="0.098">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Portfolio Math Integration" name="calculates returns matrix from real price data" time="0.009">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Portfolio Math Integration" name="REAL covariance matrix calculation with actual data" time="0.004">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Rebalancing Calculations" name="calculates real rebalancing with actual portfolio data" time="0.004">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Portfolio Insights Generation" name="generates real insights from actual optimization data" time="0.002">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Demo Portfolio Logic" name="demo portfolio has realistic financial data structure" time="0.003">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Data Quality Assessment" name="assesses actual price data quality correctly" time="0.004">
    </testcase>
    <testcase classname="OptimizationEngine REAL Tests › Real Error Handling" name="handles missing portfolio data gracefully with real fallback" time="0.058">
    </testcase>
  </testsuite>
  <testsuite name="BacktestingService REAL Implementation Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.282" tests="25">
    <testcase classname="BacktestingService REAL Implementation Tests › Real Service Initialization" name="initializes with YOUR actual strategy mappings" time="0.056">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Service Initialization" name="has real TechnicalAnalysisService instance" time="0.034">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Service Initialization" name="returns available strategies matching YOUR implementation" time="0.004">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy generates BUY signal when RSI &lt; 30 using YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy generates SELL signal when RSI &gt; 70 using YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real RSI Strategy Implementation" name="RSI strategy returns null when RSI is neutral (30-70 range)" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real MACD Strategy Implementation" name="MACD strategy detects bullish crossover using YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real MACD Strategy Implementation" name="MACD strategy handles insufficient data gracefully" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Bollinger Bands Strategy Implementation" name="Bollinger strategy generates BUY when price below lower band" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Mean Reversion Strategy Implementation" name="Mean reversion strategy detects oversold conditions" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Mean Reversion Strategy Implementation" name="Mean reversion strategy detects overbought conditions" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Momentum Strategy Implementation" name="Momentum strategy detects bullish momentum (SMA10 &gt; SMA20)" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="runs complete backtest with YOUR actual implementation" time="0.04">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="validates input parameters according to YOUR implementation" time="0.054">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Backtest Execution" name="processes trade execution with YOUR actual logic" time="0.01">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Portfolio History Tracking" name="tracks portfolio value changes through YOUR implementation" time="0.02">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Filter Data by Date" name="filters data by date range using YOUR implementation" time="0.017">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Strategy Descriptions" name="provides accurate strategy descriptions matching YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Multi-Indicator Strategy Implementation" name="Multi-indicator strategy combines YOUR real technical analysis" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Trade Execution Logic" name="executeEntry creates positions according to YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Trade Execution Logic" name="executeExit closes positions and records trades per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Exit Conditions Logic" name="checkExitConditions triggers stop loss per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Exit Conditions Logic" name="checkExitConditions triggers take profit per YOUR implementation" time="0.001">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Portfolio Value Calculation" name="calculatePortfolioValue computes correctly per YOUR implementation" time="0.001">
    </testcase>
    <testcase classname="BacktestingService REAL Implementation Tests › Real Portfolio Value Calculation" name="calculatePortfolioValue handles short positions per YOUR implementation" time="0">
    </testcase>
  </testsuite>
  <testsuite name="Optimization Engine Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.272" tests="36">
    <testcase classname="Optimization Engine Unit Tests › Service Initialization" name="initializes with default risk-free rate" time="0.019">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Service Initialization" name="has all required methods" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Current Portfolio Retrieval" name="retrieves portfolio from database successfully" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Current Portfolio Retrieval" name="returns demo portfolio when database query fails" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Current Portfolio Retrieval" name="returns demo portfolio when no holdings found" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Current Portfolio Retrieval" name="calculates portfolio weights correctly" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Demo Portfolio" name="generates consistent demo portfolio" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Demo Portfolio" name="demo portfolio weights sum to 1" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Universe" name="creates universe from current holdings" time="0.02">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Universe" name="includes additional assets for diversification" time="0.019">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Universe" name="respects include and exclude assets" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Universe" name="limits universe size to 20 assets" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Historical Price Data" name="generates mock price data for symbols" time="0.006">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Historical Price Data" name="generates realistic price movements" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Returns Matrix Calculation" name="calculates returns matrix from price data" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Returns Matrix Calculation" name="handles empty price data" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Returns Matrix Calculation" name="handles single price point" time="0.005">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Rebalancing Calculations" name="calculates rebalancing trades correctly" time="0.005">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Rebalancing Calculations" name="ignores small weight differences" time="0.008">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Rebalancing Calculations" name="sorts trades by priority and value" time="0.002">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Insights" name="generates risk warning for high volatility" time="0.002">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Insights" name="generates diversification insight for small portfolios" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Insights" name="generates positive insight for high Sharpe ratio" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Optimization Insights" name="generates concentration warning for large positions" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Formatting Functions" name="formats weights correctly" time="0.002">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Formatting Functions" name="formats portfolio summary correctly" time="0.005">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Formatting Functions" name="formats correlation matrix correctly" time="0.004">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Data Quality Assessment" name="assesses high-quality data correctly" time="0.005">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Data Quality Assessment" name="identifies missing data points" time="0.002">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Fallback Optimization" name="generates fallback optimization with demo data" time="0.014">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Fallback Optimization" name="uses equal weights for equalWeight objective" time="0.003">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Fallback Optimization" name="generates mock efficient frontier" time="0.011">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Full Optimization Integration" name="runs complete optimization successfully" time="0.091">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Full Optimization Integration" name="falls back to demo optimization on error" time="0.011">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Mock Price Data Generation" name="generates price data with correct structure" time="0.007">
    </testcase>
    <testcase classname="Optimization Engine Unit Tests › Mock Price Data Generation" name="applies different volatility for different assets" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="PortfolioService REAL Implementation Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.277" tests="14">
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="getUserPortfolio returns correct structure for YOUR implementation" time="0.011">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="updatePortfolioHoldings performs real UPSERT operations per YOUR implementation" time="0.004">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="real portfolio calculations match YOUR mathematical implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Performance Calculations" name="getPortfolioPerformance calculates real financial metrics per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Performance Calculations" name="real volatility and Sharpe ratio calculations match financial formulas" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Optimization Integration" name="getPortfolioForOptimization formats data correctly for YOUR optimization algorithms" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Optimization Integration" name="saveOptimizationResults stores real optimization data per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="getAlpacaService initializes correctly with YOUR implementation" time="0.014">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="syncPortfolioFromBroker handles broker data transformation per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="syncPortfolioFromBroker handles broker API errors per YOUR error handling" time="0.007">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio History and Analysis" name="getPortfolioHistory returns real database historical data per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Error Handling and Edge Cases" name="handles invalid user ID gracefully per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Error Handling and Edge Cases" name="validates required portfolio fields per YOUR validation logic" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Health Check Implementation" name="healthCheck returns correct status per YOUR implementation" time="0.003">
    </testcase>
  </testsuite>
  <testsuite name="AdvancedPerformanceAnalytics" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.268" tests="11">
    <testcase classname="AdvancedPerformanceAnalytics › calculateBaseMetrics" name="calculates basic performance metrics correctly" time="0.149">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateBaseMetrics" name="handles empty portfolio history" time="0.002">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateRiskMetrics" name="calculates risk metrics correctly" time="0.011">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateMaxDrawdown" name="calculates maximum drawdown correctly" time="0.003">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateAttributionAnalysis" name="calculates attribution analysis correctly" time="0.014">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateSectorAnalysis" name="calculates sector analysis correctly" time="0.002">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateDiversificationScore" name="calculates diversification score correctly" time="0.002">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › generatePerformanceReport" name="generates comprehensive performance report" time="0.025">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › getPerformanceGrade" name="assigns correct performance grades" time="0.002">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › assessRiskProfile" name="assesses risk profile correctly" time="0.001">
    </testcase>
    <testcase classname="AdvancedPerformanceAnalytics › calculateDaysInPeriod" name="calculates days in period correctly" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="PortfolioMath REAL Financial Calculations" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.297" tests="10">
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Covariance Matrix Calculations" name="calculates covariance matrix from real return data" time="0.184">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Covariance Matrix Calculations" name="handles edge cases in real covariance calculation" time="0.004">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Covariance Matrix Calculations" name="throws real error for invalid input" time="0.05">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Expected Returns Calculations" name="calculates simple average expected returns from real data" time="0.003">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Expected Returns Calculations" name="calculates EWMA expected returns with real decay" time="0.001">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Correlation Matrix Calculations" name="calculates real correlation from covariance matrix" time="0.003">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Mean Variance Optimization" name="performs real portfolio optimization with actual constraints" time="0.005">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Mean Variance Optimization" name="handles different optimization objectives" time="0.002">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Risk Metrics Calculations" name="calculates real portfolio risk metrics" time="0.003">
    </testcase>
    <testcase classname="PortfolioMath REAL Financial Calculations › Real Efficient Frontier Generation" name="generates real efficient frontier points" time="0.007">
    </testcase>
  </testsuite>
  <testsuite name="PortfolioService REAL Implementation Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.307" tests="14">
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="getUserPortfolio returns correct structure for YOUR implementation" time="0.01">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="updatePortfolioHoldings performs real UPSERT operations per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Database Portfolio Operations" name="real portfolio calculations match YOUR mathematical implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Performance Calculations" name="getPortfolioPerformance calculates real financial metrics per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Performance Calculations" name="real volatility and Sharpe ratio calculations match financial formulas" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Optimization Integration" name="getPortfolioForOptimization formats data correctly for YOUR optimization algorithms" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio Optimization Integration" name="saveOptimizationResults stores real optimization data per YOUR implementation" time="0.003">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="getAlpacaService initializes correctly with YOUR implementation" time="0.012">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="syncPortfolioFromBroker handles broker data transformation per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real AlpacaService Integration Logic" name="syncPortfolioFromBroker handles broker API errors per YOUR error handling" time="0.004">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Portfolio History and Analysis" name="getPortfolioHistory returns real database historical data per YOUR implementation" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Error Handling and Edge Cases" name="handles invalid user ID gracefully per YOUR implementation" time="0.001">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Error Handling and Edge Cases" name="validates required portfolio fields per YOUR validation logic" time="0.002">
    </testcase>
    <testcase classname="PortfolioService REAL Implementation Tests › Real Health Check Implementation" name="healthCheck returns correct status per YOUR implementation" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Technical Analysis Service Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.353" tests="41">
    <testcase classname="Technical Analysis Service Unit Tests › Service Initialization" name="initializes technical analysis service correctly" time="0.06">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Service Initialization" name="has multiple indicators calculation capability" time="0.004">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Service Initialization" name="validates technical analysis mathematical foundations" time="0.033">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Multiple Indicators Mathematics" name="handles data validation correctly" time="0.128">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Multiple Indicators Mathematics" name="validates indicator requirements" time="0.004">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Multiple Indicators Mathematics" name="handles concurrent indicator calculations safely" time="0.004">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="validates RSI mathematical formula" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="handles RSI boundary conditions" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="calculates RSI with known data points" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="handles different RSI periods correctly" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="generates correct RSI signals" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="requires sufficient data" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › RSI (Relative Strength Index) Mathematics" name="handles flat price data" time="0.006">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › MACD (Moving Average Convergence Divergence)" name="calculates MACD with default parameters" time="0.009">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › MACD (Moving Average Convergence Divergence)" name="calculates MACD with custom parameters" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › MACD (Moving Average Convergence Divergence)" name="generates MACD buy/sell signals" time="0.009">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › MACD (Moving Average Convergence Divergence)" name="requires sufficient data for MACD" time="0.004">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Bollinger Bands" name="calculates Bollinger Bands with default parameters" time="0.014">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Bollinger Bands" name="validates band relationships" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Bollinger Bands" name="generates Bollinger Band signals" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Bollinger Bands" name="calculates with custom standard deviation" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Simple Moving Average (SMA)" name="calculates SMA correctly" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Simple Moving Average (SMA)" name="handles period larger than data length" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Simple Moving Average (SMA)" name="calculates SMA with timestamps" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Exponential Moving Average (EMA)" name="calculates EMA correctly" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Exponential Moving Average (EMA)" name="EMA responds faster than SMA to price changes" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Exponential Moving Average (EMA)" name="requires sufficient data" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Stochastic Oscillator" name="calculates Stochastic with default parameters" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Stochastic Oscillator" name="validates Stochastic value ranges" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Stochastic Oscillator" name="generates overbought/oversold signals" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Williams %R" name="calculates Williams %R correctly" time="0.004">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Williams %R" name="generates Williams %R signals" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Williams %R" name="requires sufficient data" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Edge Cases and Error Handling" name="handles missing price data fields" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Edge Cases and Error Handling" name="handles zero and negative prices" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Edge Cases and Error Handling" name="handles single data point" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Edge Cases and Error Handling" name="handles very large datasets efficiently" time="0.006">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Signal Generation" name="generates consistent signals across indicators" time="0.003">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Signal Generation" name="signal timestamps match data timestamps" time="0.002">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Mathematical Accuracy" name="SMA calculation matches manual calculation" time="0.001">
    </testcase>
    <testcase classname="Technical Analysis Service Unit Tests › Mathematical Accuracy" name="RSI boundary conditions" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="Circuit Breaker Utilities Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.348" tests="19">
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should initialize with production-ready thresholds" time="0.187">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should track failure counts correctly" time="0.011">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should transition states correctly (closed -&gt; open -&gt; half-open -&gt; closed)" time="0.02">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should record event history correctly" time="0.006">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should calculate metrics correctly" time="0.007">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should handle recent activity tracking" time="0.006">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › TimeoutHelper Circuit Breaker" name="should calculate risk levels accurately" time="0.009">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should initialize with correct production configuration" time="0.008">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should execute operations and track results" time="0.005">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should handle operation failures correctly" time="0.007">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should open circuit after threshold failures" time="0.028">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should provide detailed status information" time="0.007">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › DatabaseCircuitBreaker Class" name="should force reset correctly" time="0.042">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Circuit Breaker Reset Utilities" name="should reset all circuit breakers" time="0.021">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Circuit Breaker Reset Utilities" name="should reset specific circuit breaker" time="0.008">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Circuit Breaker Reset Utilities" name="should get comprehensive circuit breaker status" time="0.008">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Circuit Breaker Reset Utilities" name="should handle non-existent circuit breaker reset gracefully" time="0.006">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Performance and Memory Management" name="should limit history size to prevent memory leaks" time="0.004">
    </testcase>
    <testcase classname="Circuit Breaker Utilities Unit Tests › Performance and Memory Management" name="should handle rapid state changes efficiently" time="0.004">
    </testcase>
  </testsuite>
  <testsuite name="Database Circuit Breaker Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.311" tests="29">
    <testcase classname="Database Circuit Breaker Unit Tests › Circuit Breaker Initialization" name="initializes with correct default state" time="0.157">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Circuit Breaker Initialization" name="sets production-ready configuration values" time="0.005">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Closed State Operations" name="executes operations successfully when circuit is closed" time="0.017">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Closed State Operations" name="records failure but stays closed below threshold" time="0.029">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Closed State Operations" name="decrements failure count on successful operations" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Closed State Operations" name="opens circuit when failure threshold is reached" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Open State Operations" name="rejects operations immediately when circuit is open" time="0.005">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Open State Operations" name="includes remaining time in error message" time="0.003">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Open State Operations" name="transitions to half-open after recovery timeout" time="0.004">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Half-Open State Operations" name="allows limited operations in half-open state" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Half-Open State Operations" name="closes circuit after sufficient successes" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Half-Open State Operations" name="reopens circuit on failure in half-open state" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Half-Open State Operations" name="tracks success count correctly in half-open state" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Metrics and History Tracking" name="tracks comprehensive metrics" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Metrics and History Tracking" name="maintains request history with limited size" time="0.004">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Metrics and History Tracking" name="records operation duration in history" time="0.053">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Metrics and History Tracking" name="records error details in failure history" time="0.003">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Health Assessment" name="reports healthy when failures are below 50% of threshold" time="0.001">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Health Assessment" name="reports unhealthy when failures are above 50% of threshold" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Health Assessment" name="reports unhealthy when circuit is not closed" time="0.001">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Health Assessment" name="calculates time to recovery correctly" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Force Reset Functionality" name="resets circuit breaker to clean state" time="0.003">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Force Reset Functionality" name="allows operations after force reset" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Concurrent Operations" name="handles concurrent operations safely" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Concurrent Operations" name="handles mixed concurrent success and failure operations" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Edge Cases and Error Scenarios" name="handles operations that throw non-Error objects" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Edge Cases and Error Scenarios" name="handles operations that return undefined" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Edge Cases and Error Scenarios" name="maintains state consistency during rapid state transitions" time="0.002">
    </testcase>
    <testcase classname="Database Circuit Breaker Unit Tests › Edge Cases and Error Scenarios" name="handles timestamp edge cases" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="Comprehensive Health Check System" errors="0" failures="11" skipped="0" timestamp="2025-07-25T04:02:07" time="2.365" tests="11">
    <testcase classname="Comprehensive Health Check System › GET /api/health/ - Basic Health Check" name="should return quick health check without database when quick=true" time="0.075">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:59:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › GET /api/health/ - Basic Health Check" name="should perform full health check with database connection" time="0.01">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:84:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › GET /api/health/ - Basic Health Check" name="should handle database initialization failure" time="0.014">
      <failure>Error: expect(received).toMatchObject(expected)

- Expected  - 2
+ Received  + 2

  Object {
    &quot;database&quot;: Object {
-     &quot;error&quot;: &quot;Connection refused&quot;,
-     &quot;status&quot;: &quot;initialization_failed&quot;,
+     &quot;error&quot;: &quot;Connection failed&quot;,
+     &quot;status&quot;: &quot;degraded&quot;,
    },
    &quot;healthy&quot;: false,
    &quot;service&quot;: &quot;Financial Dashboard API&quot;,
    &quot;status&quot;: &quot;unhealthy&quot;,
  }
    at Object.toMatchObject (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:109:29)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › GET /api/health/database - Comprehensive Database Health" name="should return comprehensive database analysis with multi-tier health checks" time="0.006">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:184:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should successfully update health status with comprehensive database analysis" time="0.006">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:278:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should handle database connection failure gracefully" time="0.005">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:314:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should measure all tables across database as requested by user" time="0.007">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:366:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should store health data in health_status table when it exists" time="0.006">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:421:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should handle health_status table storage failure gracefully" time="0.005">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:462:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should skip storage when health_status table does not exist" time="0.006">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:491:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System › POST /api/health/update-status - Health Status Updates" name="should provide performance information in response" time="0.009">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/health-update-status.test.js:517:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Authentication Middleware Unit Tests" errors="0" failures="5" skipped="0" timestamp="2025-07-25T04:02:07" time="2.402" tests="33">
    <testcase classname="Authentication Middleware Unit Tests › Development Mode Authentication" name="allows access without token in development mode" time="0.194">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Development Mode Authentication" name="validates development JWT tokens correctly" time="0.015">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Development Mode Authentication" name="generates valid development tokens" time="0.007">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Development Mode Authentication" name="falls back to development mode when Cognito is unavailable" time="0.003">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Production Mode Authentication" name="requires authentication token in production mode" time="0.005">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 401

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/stocks/algo/webapp/lambda/tests/unit/auth-middleware.test.js:126:35)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Production Mode Authentication" name="rejects invalid tokens in production mode" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 401

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/stocks/algo/webapp/lambda/tests/unit/auth-middleware.test.js:141:35)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Production Mode Authentication" name="handles malformed authorization headers" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 401

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/stocks/algo/webapp/lambda/tests/unit/auth-middleware.test.js:150:35)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › JWT Token Validation" name="handles expired JWT tokens" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › JWT Token Validation" name="validates JWT token structure and claims" time="0.003">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › JWT Token Validation" name="handles malformed JWT tokens gracefully" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Role-Based Authorization" name="allows access when user has required role" time="0">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Role-Based Authorization" name="allows access when user is in required group" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Role-Based Authorization" name="denies access when user lacks required role" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Role-Based Authorization" name="denies access when user is not authenticated" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Role-Based Authorization" name="handles multiple role requirements" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Optional Authentication" name="continues without authentication when no token provided" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Optional Authentication" name="authenticates when valid token is provided" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Optional Authentication" name="continues silently when authentication fails" time="0.002">
      <failure>Error: expect(received).toBeUndefined()

Received: {&quot;authMethod&quot;: &quot;dev-fallback&quot;, &quot;authenticatedAt&quot;: &quot;2025-07-25T04:02:08.643Z&quot;, &quot;clientIp&quot;: &quot;127.0.0.1&quot;, &quot;email&quot;: &quot;dev@example.com&quot;, &quot;emailVerified&quot;: true, &quot;familyName&quot;: &quot;User&quot;, &quot;givenName&quot;: &quot;Dev&quot;, &quot;groups&quot;: [&quot;admin&quot;], &quot;isDevelopment&quot;: true, &quot;requestId&quot;: &quot;14c1f240-e653-4ec0-81f0-f4d29b577668&quot;, &quot;role&quot;: &quot;admin&quot;, &quot;sub&quot;: &quot;dev-user-fallback&quot;, &quot;userAgent&quot;: &quot;unknown&quot;, &quot;username&quot;: &quot;dev-user&quot;}
    at Object.toBeUndefined (/home/stocks/algo/webapp/lambda/tests/unit/auth-middleware.test.js:295:32)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Request Context Enhancement" name="enriches user object with request context" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Request Context Enhancement" name="generates request ID when not provided" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Request Context Enhancement" name="handles missing client IP gracefully" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Cognito Configuration Management" name="loads configuration from environment variables" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Cognito Configuration Management" name="handles missing Cognito configuration gracefully" time="0">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Cognito Configuration Management" name="uses default region when not specified" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Authentication Status Endpoint" name="returns comprehensive authentication status" time="0.004">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Authentication Status Endpoint" name="handles status check errors gracefully" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Error Handling and Edge Cases" name="handles network errors during token verification" time="0.019">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Error Handling and Edge Cases" name="handles concurrent authentication requests safely" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Error Handling and Edge Cases" name="preserves original user data when authentication fails in development" time="0.001">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Error Handling and Edge Cases" name="handles missing authorization header gracefully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 401

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/stocks/algo/webapp/lambda/tests/unit/auth-middleware.test.js:526:35)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Token Generation and Validation" name="generates tokens with correct expiration" time="0.002">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Token Generation and Validation" name="generates unique tokens for different users" time="0.003">
    </testcase>
    <testcase classname="Authentication Middleware Unit Tests › Token Generation and Validation" name="uses custom JWT secret when provided" time="0.003">
    </testcase>
  </testsuite>
  <testsuite name="Comprehensive Health Check System - RESTORED" errors="0" failures="8" skipped="0" timestamp="2025-07-25T04:02:07" time="2.407" tests="8">
    <testcase classname="Comprehensive Health Check System - RESTORED › Basic Health Check (GET /)" name="should return quick health check without database when quick=true" time="0.069">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:59:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Basic Health Check (GET /)" name="should perform comprehensive health check with database connection" time="0.011">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:97:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Database Health Check (GET /database)" name="should return comprehensive database analysis with table categorization" time="0.009">
      <failure>Error: expected 200 &quot;OK&quot;, got 503 &quot;Service Unavailable&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:154:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Database Health Check (GET /database)" name="should handle database connection failure gracefully" time="0.009">
      <failure>Error: expect(received).toMatchObject(expected)

- Expected  - 7
+ Received  + 5

  Object {
-   &quot;database&quot;: ObjectContaining {
-     &quot;error&quot;: &quot;Connection refused&quot;,
-     &quot;status&quot;: &quot;error&quot;,
-   },
-   &quot;healthy&quot;: false,
-   &quot;service&quot;: &quot;Financial Dashboard API&quot;,
-   &quot;status&quot;: &quot;unhealthy&quot;,
+   &quot;circuitBreakerOpen&quot;: false,
+   &quot;error&quot;: &quot;Database diagnostics unavailable&quot;,
+   &quot;message&quot;: &quot;Cannot read properties of undefined (reading &apos;totalCount&apos;)&quot;,
+   &quot;success&quot;: false,
+   &quot;timestamp&quot;: &quot;2025-07-25T04:02:08.672Z&quot;,
  }
    at Object.toMatchObject (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:182:29)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Health Status Update (POST /update-status)" name="should successfully update health status with comprehensive analysis" time="0.005">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:248:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Health Status Update (POST /update-status)" name="should categorize tables according to the comprehensive system" time="0.004">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:320:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Additional Endpoints" name="should provide database diagnostics endpoint" time="0.004">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:357:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Comprehensive Health Check System - RESTORED › Additional Endpoints" name="should provide status summary endpoint" time="0.005">
      <failure>Error: expected 200 &quot;OK&quot;, got 404 &quot;Not Found&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/comprehensive-health-check.test.js:371:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Risk Manager Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.405" tests="34">
    <testcase classname="Risk Manager Unit Tests › Service Initialization" name="initializes risk manager correctly" time="0.021">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Service Initialization" name="has default risk parameters" time="0.005">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="handles database connection failures gracefully" time="0.072">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="validates input parameters thoroughly" time="0.141">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="calculates signal-based adjustments correctly" time="0.02">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="calculates real position size mathematics" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="respects maximum position size limits" time="0.017">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="applies position size bounds correctly" time="0.003">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Position Size Calculation Logic" name="handles missing signal data gracefully" time="0.07">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Base Position Size Mathematics" name="calculates position size from risk parameters" time="0.005">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Base Position Size Mathematics" name="applies confidence-based adjustments" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Base Position Size Mathematics" name="applies strength-based adjustments" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Base Position Size Mathematics" name="enforces maximum position size bounds" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Volatility Adjustment" name="reduces position size for high volatility assets" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Volatility Adjustment" name="allows larger position size for low volatility assets" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Volatility Adjustment" name="handles missing volatility data gracefully" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Volatility Adjustment" name="applies volatility adjustment bounds" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Portfolio Risk Assessment" name="calculates comprehensive risk metrics" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Portfolio Risk Assessment" name="identifies high concentration risk" time="0.003">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Portfolio Risk Assessment" name="identifies high correlation risk" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Concentration Limits" name="applies concentration limits correctly" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Concentration Limits" name="allows position when concentration is within limits" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Concentration Limits" name="handles new positions correctly" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Sector Limits" name="applies sector concentration limits" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Sector Limits" name="allows position in underweight sectors" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Risk Recommendation Generation" name="generates conservative recommendation for high risk" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Risk Recommendation Generation" name="generates positive recommendation for low risk" time="0.002">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Risk Recommendation Generation" name="provides actionable recommendations" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Error Handling" name="handles database errors gracefully" time="0.008">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Error Handling" name="handles invalid volatility data" time="0.001">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Error Handling" name="handles empty portfolio composition" time="0.006">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Performance and Edge Cases" name="completes position sizing calculation within reasonable time" time="0.008">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Performance and Edge Cases" name="handles very small portfolio values" time="0.008">
    </testcase>
    <testcase classname="Risk Manager Unit Tests › Performance and Edge Cases" name="handles very large portfolio values" time="0.007">
    </testcase>
  </testsuite>
  <testsuite name="📊 Market Prices and Metrics Endpoints" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="2.443" tests="16">
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should return price data for valid symbol when table exists" time="0.071">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should return 503 when table does not exist (no fallback)" time="0.008">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should return 404 when no price data found (no fallback)" time="0.007">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should validate symbol format" time="0.008">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should handle database errors gracefully" time="0.007">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/prices/:symbol" name="should handle case-insensitive symbols" time="0.004">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should return metrics data for valid symbol when table exists" time="0.005">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should return 503 when table does not exist (no fallback)" time="0.006">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should return 404 when no metrics data found (no fallback)" time="0.005">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should validate symbol format for metrics" time="0.003">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should handle database errors in metrics endpoint" time="0.008">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › GET /api/market/metrics/:symbol" name="should handle null/undefined metric values" time="0.004">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › Symbol validation" name="should properly handle valid symbols when no infrastructure" time="0.011">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › Symbol validation" name="should handle various symbol formats with proper errors" time="0.011">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › Error handling" name="should handle malformed database responses" time="0.004">
    </testcase>
    <testcase classname="📊 Market Prices and Metrics Endpoints › Error handling" name="should handle database query timeout" time="0.006">
    </testcase>
  </testsuite>
  <testsuite name="API Key Security - Real Site Protection" errors="0" failures="14" skipped="0" timestamp="2025-07-25T04:02:07" time="2.916" tests="14">
    <testcase classname="API Key Security - Real Site Protection › Authentication Security (What Site Actually Checks)" name="should reject API key access without valid JWT token" time="0.44">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:27:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Authentication Security (What Site Actually Checks)" name="should reject API key access with expired JWT token" time="0.003">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:49:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Authentication Security (What Site Actually Checks)" name="should reject API key access with malformed JWT token" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:62:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › User Isolation Security (Prevents Cross-User Access)" name="should isolate API keys by user ID from JWT token" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:82:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › User Isolation Security (Prevents Cross-User Access)" name="should prevent user from accessing other users API keys via JWT manipulation" time="0.003">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:100:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Input Validation Security (What Site Actually Validates)" name="should validate Alpaca API key format to prevent injection" time="0">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:124:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Input Validation Security (What Site Actually Validates)" name="should validate provider names to prevent path traversal" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:146:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Input Validation Security (What Site Actually Validates)" name="should sanitize SQL injection attempts in provider names" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:168:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › API Key Format Validation (Production Security Rules)" name="should enforce Alpaca API key format requirements" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:206:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › API Key Format Validation (Production Security Rules)" name="should enforce Alpaca secret key length limits" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:234:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Rate Limiting Security (Anti-Abuse Protection)" name="should rate limit API key creation attempts" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:265:12)
    at Array.map (&lt;anonymous&gt;)
    at Object.map (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:263:40)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Error Information Disclosure Prevention" name="should not expose internal system details in error messages" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as post] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.post (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:290:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › Error Information Disclosure Prevention" name="should not expose user IDs or sensitive data in logs" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:318:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="API Key Security - Real Site Protection › HTTPS and Transport Security" name="should set secure headers for API key endpoints" time="0.001">
      <failure>TypeError: app.address is not a function
    at Test.serverAddress (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:46:22)
    at new Test (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:34:14)
    at Object.obj.&lt;computed&gt; [as get] (/home/stocks/algo/webapp/lambda/node_modules/supertest/index.js:43:18)
    at Object.get (/home/stocks/algo/webapp/lambda/tests/unit/security/api-key-security-real.test.js:343:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Universal Error Handler Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="3.242" tests="48">
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes circuit breaker errors correctly" time="0.157">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes database errors correctly" time="0.007">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes timeout errors correctly" time="0.012">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes authentication errors correctly" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes authorization errors correctly" time="0.004">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes validation errors correctly" time="0.004">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes external service errors correctly" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes rate limit errors correctly" time="0.007">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes business logic errors correctly" time="0.004">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="categorizes server errors correctly" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Categorization" name="returns UNKNOWN_ERROR for unrecognized errors" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Severity Determination" name="assigns CRITICAL severity to database and server errors" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Severity Determination" name="assigns HIGH severity to external service and circuit breaker errors" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Severity Determination" name="assigns MEDIUM severity to auth and timeout errors" time="0.006">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Severity Determination" name="assigns LOW severity to validation and rate limit errors" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Severity Determination" name="returns UNKNOWN for unrecognized error types" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Recoverability Assessment" name="identifies recoverable errors correctly" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Recoverability Assessment" name="identifies non-recoverable errors correctly" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › User Message Generation" name="generates appropriate user messages for each category" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › User Message Generation" name="uses custom message for business logic errors" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › User Message Generation" name="falls back to default message for unknown categories" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Context Enrichment" name="enriches error with comprehensive context" time="0.049">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Context Enrichment" name="handles missing user context gracefully" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Context Enrichment" name="calculates performance metrics correctly" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Response Formatting" name="formats error response with correct structure" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Response Formatting" name="includes development details when NODE_ENV is development" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Response Formatting" name="excludes development details in production" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Response Formatting" name="includes retry information for recoverable errors" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Response Formatting" name="maps status codes correctly by category" time="0.003">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Async Handler Wrapper" name="catches async errors and passes them to next" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Async Handler Wrapper" name="handles non-promise functions gracefully" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Async Handler Wrapper" name="handles functions that return non-promise values" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Handler Middleware" name="processes error and sends formatted response" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Handler Middleware" name="handles errors without correlation ID gracefully" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Database Error Handler" name="executes fallback function when provided" time="0.006">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Database Error Handler" name="throws original error when fallback fails" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Database Error Handler" name="throws original error when no fallback provided" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › External Service Error Handler" name="throws retry error for retryable errors within retry limit" time="1.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › External Service Error Handler" name="throws original error when retry limit exceeded" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › External Service Error Handler" name="throws original error for non-retryable errors" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › External Service Error Handler" name="applies exponential backoff with maximum delay" time="0.002">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Logging" name="logs errors with appropriate severity levels" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Logging" name="triggers critical error alert for critical errors" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Error Logging" name="uses fallback logger when request logger not available" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Edge Cases and Error Handling" name="handles errors with undefined message" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Edge Cases and Error Handling" name="handles errors with null properties" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Edge Cases and Error Handling" name="handles request objects with missing properties gracefully" time="0.001">
    </testcase>
    <testcase classname="Universal Error Handler Unit Tests › Edge Cases and Error Handling" name="handles circular reference in error objects" time="0">
    </testcase>
  </testsuite>
  <testsuite name="User API Endpoints - TDD Tests" errors="0" failures="28" skipped="0" timestamp="2025-07-25T04:02:07" time="3.282" tests="31">
    <testcase classname="User API Endpoints - TDD Tests › User Profile Endpoints › GET /api/user/profile" name="should return user profile data with authentication" time="0.05">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:25:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Profile Endpoints › GET /api/user/profile" name="should return 401 for unauthenticated requests" time="0.016">
      <failure>Error: expect(received).toMatchObject(expected)

- Expected  - 1
+ Received  + 0

  Object {
    &quot;error&quot;: StringContaining &quot;Authentication&quot;,
-   &quot;success&quot;: false,
  }
    at Object.toMatchObject (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:44:31)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Profile Endpoints › PUT /api/user/profile" name="should update user profile successfully" time="0.014">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:66:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Profile Endpoints › PUT /api/user/profile" name="should validate required fields" time="0.01">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:80:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Profile Endpoints › PUT /api/user/profile" name="should validate email format" time="0.008">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:97:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Notification Endpoints › GET /api/user/notifications" name="should return user notification preferences" time="0.008">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:113:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Notification Endpoints › GET /api/user/notifications" name="should return default preferences when none are set" time="0.012">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:132:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Notification Endpoints › PUT /api/user/notifications" name="should update notification preferences successfully" time="0.007">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:160:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Notification Endpoints › PUT /api/user/notifications" name="should handle partial updates" time="0.008">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:174:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Theme Endpoints › GET /api/user/theme" name="should return user theme preferences" time="0.009">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:187:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Theme Endpoints › PUT /api/user/theme" name="should update theme preferences successfully" time="0.009">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:214:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › User Theme Endpoints › PUT /api/user/theme" name="should validate color format" time="0.007">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:228:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › GET /api/portfolio/api-keys" name="should return user API keys list" time="0.008">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:244:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › GET /api/portfolio/api-keys" name="should mask sensitive API key data" time="0.009">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:256:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/api-keys" name="should add new API key successfully" time="0.006">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:279:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/api-keys" name="should validate required fields" time="0.007">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:299:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/api-keys" name="should validate broker name" time="0.008">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:316:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/api-keys" name="should encrypt API secrets before storage" time="0.008">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:336:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › DELETE /api/portfolio/api-keys/:brokerName" name="should delete API key successfully" time="0.008">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:349:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › DELETE /api/portfolio/api-keys/:brokerName" name="should return 404 for non-existent API key" time="0.008">
      <failure>Error: expected 404 &quot;Not Found&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:361:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/test-connection/:brokerName" name="should test API connection successfully" time="0.007">
      <failure>Error: expected 200 &quot;OK&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:375:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Portfolio API Keys Endpoints › POST /api/portfolio/test-connection/:brokerName" name="should handle connection failures gracefully" time="0.007">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:391:12)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Authentication and Security" name="should require authentication for all endpoints" time="0.009">
      <failure>Error: expect(received).toMatchObject(expected)

- Expected  - 1
+ Received  + 0

  Object {
    &quot;error&quot;: StringContaining &quot;Authentication&quot;,
-   &quot;success&quot;: false,
  }
    at Object.toMatchObject (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:419:31)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Authentication and Security" name="should validate JWT token format" time="0.009">
      <failure>Error: expect(received).toMatchObject(expected)

- Expected  - 2
+ Received  + 1

  Object {
-   &quot;error&quot;: StringContaining &quot;token&quot;,
-   &quot;success&quot;: false,
+   &quot;error&quot;: &quot;Authentication failed&quot;,
  }
    at Object.toMatchObject (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:432:29)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Authentication and Security" name="should rate limit API requests" time="0.115">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: true
Received: false
    at Object.toBe (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:450:27)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Error Handling" name="should handle database connection errors gracefully" time="0.001">
      <failure>Error: Cannot find module &apos;../../utils/databaseConnectionManager&apos; from &apos;tests/unit/routes/user-api-endpoints.test.js&apos;
    at Resolver._throwModNotFoundError (/home/stocks/algo/webapp/lambda/node_modules/jest-resolve/build/resolver.js:427:11)
    at Resolver.resolveModule (/home/stocks/algo/webapp/lambda/node_modules/jest-resolve/build/resolver.js:358:10)
    at Resolver._getVirtualMockPath (/home/stocks/algo/webapp/lambda/node_modules/jest-resolve/build/resolver.js:619:14)
    at Resolver._getAbsolutePath (/home/stocks/algo/webapp/lambda/node_modules/jest-resolve/build/resolver.js:587:14)
    at Resolver.getModuleID (/home/stocks/algo/webapp/lambda/node_modules/jest-resolve/build/resolver.js:530:31)
    at Runtime._shouldMockCjs (/home/stocks/algo/webapp/lambda/node_modules/jest-runtime/build/index.js:1713:37)
    at Runtime.requireModuleOrMock (/home/stocks/algo/webapp/lambda/node_modules/jest-runtime/build/index.js:1045:16)
    at Object.require (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:457:29)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Error Handling" name="should sanitize error messages in production" time="0.008">
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Data Validation and Sanitization" name="should sanitize input data to prevent XSS" time="0.006">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:504:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Data Validation and Sanitization" name="should validate SQL injection attempts" time="0.008">
      <failure>Error: expected 400 &quot;Bad Request&quot;, got 401 &quot;Unauthorized&quot;
    at Object.expect (/home/stocks/algo/webapp/lambda/tests/unit/routes/user-api-endpoints.test.js:523:10)
    at Promise.then.completed (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at _runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/stocks/algo/webapp/lambda/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/stocks/algo/webapp/lambda/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:252:14)
    at /home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/stocks/algo/webapp/lambda/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:631:28)
    at Server.emit (node:events:517:28)
    at emitCloseNT (node:net:2215:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Performance" name="should respond within acceptable time limits" time="0.007">
    </testcase>
    <testcase classname="User API Endpoints - TDD Tests › Performance" name="should handle concurrent requests efficiently" time="0.067">
    </testcase>
  </testsuite>
  <testsuite name="Timeout Helper Unit Tests" errors="0" failures="0" skipped="0" timestamp="2025-07-25T04:02:07" time="15.923" tests="41">
    <testcase classname="Timeout Helper Unit Tests › Default Configuration" name="has correct default timeout values" time="0.176">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Default Configuration" name="initializes with empty circuit breakers map" time="0.004">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Basic Timeout Functionality" name="executes operation successfully within timeout" time="0.008">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Basic Timeout Functionality" name="throws timeout error when operation exceeds timeout" time="0.089">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Basic Timeout Functionality" name="propagates operation errors correctly" time="0.01">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Basic Timeout Functionality" name="uses default timeout when not specified" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Retry Logic" name="retries failed operations according to retry count" time="0.032">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Retry Logic" name="succeeds on retry after initial failure" time="0.011">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Retry Logic" name="applies exponential backoff for retry delays" time="0.153">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Retry Logic" name="does not retry without explicit retry count" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Integration" name="records success and resets circuit breaker" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Integration" name="records failure and updates circuit breaker" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Integration" name="opens circuit after threshold failures" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Integration" name="rejects operations when circuit is open" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Integration" name="transitions to half-open after timeout period" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › HTTP Request Functionality" name="makes successful HTTP request with default options" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › HTTP Request Functionality" name="handles POST requests with JSON body" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › HTTP Request Functionality" name="throws error for non-OK HTTP responses" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › HTTP Request Functionality" name="handles request timeout with AbortController" time="3.154">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Database Query Functionality" name="executes database query with circuit breaker" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Database Query Functionality" name="applies database-specific timeout" time="1.102">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Database Query Functionality" name="retries failed database queries" time="1">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Alpaca API Integration" name="executes Alpaca API call with service-specific settings" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Alpaca API Integration" name="uses Alpaca-specific timeout and retry settings" time="7.98">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › News API Integration" name="executes news API call without circuit breaker" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Batch Processing" name="processes items in batches with concurrency limit" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Batch Processing" name="handles errors in batch processing" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Batch Processing" name="stops on first error when continueOnError is false" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Multiple Promise Handling" name="handles Promise.all with timeout and fail-fast" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Multiple Promise Handling" name="handles Promise.allSettled for partial success" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Multiple Promise Handling" name="times out batch operations" time="0.101">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Metrics and Monitoring" name="provides comprehensive circuit breaker status" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Metrics and Monitoring" name="provides detailed metrics with performance data" time="0.003">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Metrics and Monitoring" name="calculates recent activity correctly" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Metrics and Monitoring" name="provides risk level assessment" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Circuit Breaker Metrics and Monitoring" name="provides recovery predictions" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Delay Utility" name="provides accurate delay functionality" time="0.052">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Edge Cases and Error Scenarios" name="handles operations that return null or undefined" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Edge Cases and Error Scenarios" name="handles concurrent access to circuit breakers safely" time="0.001">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Edge Cases and Error Scenarios" name="maintains circuit breaker history size limit" time="0.002">
    </testcase>
    <testcase classname="Timeout Helper Unit Tests › Edge Cases and Error Scenarios" name="handles malformed options gracefully" time="0.001">
    </testcase>
  </testsuite>
</testsuites>