Cognito environment variables not set - JWT verification disabled
üö® Alert System initialized
üîç Alert monitoring started
üö® Alert system integration initialized
üìä Monitoring started
üéõÔ∏è Live Data Manager initialized
Financial Dashboard API server running on port 3001 (local mode)
Health check: http://localhost:3001/health
Stocks: http://localhost:3001/stocks
Technical: http://localhost:3001/technical/daily
üîå WebSocket endpoint: ws://localhost:3001/ws
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/news/articles
Initializing database connection...
Initializing database connection pool...
Using database config from environment variables
Database config loaded from environment: localhost:5432/stocks
‚úÖ Database connection pool initialized successfully
Database connection established successfully
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:18 +0000] "GET /api/news/articles?timeframe=1d&limit=5 HTTP/1.1" 200 99 "-" "curl/8.5.0"
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
::1 - - [20/Sep/2025:15:00:30 +0000] "GET /api/health HTTP/1.1" 200 344 "http://localhost:5173/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:30 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5173/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:30 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4838 "http://localhost:5173/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:30 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5173/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
‚úÖ New WebSocket connection established
::1 - - [20/Sep/2025:15:00:30 +0000] "GET /api/health HTTP/1.1" 200 344 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/health HTTP/1.1" 200 346 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4832 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4835 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/health HTTP/1.1" 200 346 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4843 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/health HTTP/1.1" 200 346 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/technical/daily
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/technical/daily?page=1&limit=10&sortBy=symbol&sortOrder=asc HTTP/1.1" 200 2483 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4851 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
::1 - - [20/Sep/2025:15:00:31 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /trading/signals/daily
Database connection verified for database-dependent endpoint
[TRADING] ========= ROUTE ENTRY =========
[TRADING] Request URL: /signals/daily?limit=10
[TRADING] Received request for /signals/:timeframe {
  params: { timeframe: 'daily' },
  query: { limit: '10' },
  path: '/signals/daily',
  method: 'GET',
  time: '2025-09-20T15:00:32.256Z'
}
Processing request: GET /api/portfolio/analytics
Database connection verified for database-dependent endpoint
Portfolio analytics endpoint called for authenticated user: test-auth-token, timeframe: 1y
Processing request: GET /api/metrics/AAPL
Database connection verified for database-dependent endpoint
Getting detailed metrics for AAPL
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/portfolio/analytics?timeframe=1y HTTP/1.1" 200 701 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4837 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/metrics/AAPL HTTP/1.1" 200 1697 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
[TRADING] Table existence check results:
  Main table exists: true
  Company profile exists: true
  Price daily exists: true
[TRADING] Executing SQL: 
        SELECT 
          bs.symbol,
          bs.date,
          bs.signal,
          bs.price as price,
          bs.stoplevel as stoplevel,
          bs.inposition as inposition,
          pd.close as current_price,
          cp.name as company_name,
          cp.sector as sector,
          cp.market_cap as market_cap,
          NULL as trailing_pe,
          pd.dividends as dividend_yield,
          CASE 
            WHEN bs.signal = 'Buy' AND pd.close > bs.price 
            THEN ((pd.close - bs.price) / bs.price * 100)
            WHEN bs.signal = 'Sell' AND pd.close < bs.price 
            THEN ((bs.price - pd.close) / bs.price * 100)
            ELSE 0
          END as performance_percent
        FROM buy_sell_daily bs
        LEFT JOIN company_profile cp ON bs.symbol = cp.ticker
        LEFT JOIN (SELECT DISTINCT ON (pd_inner.symbol) pd_inner.symbol, pd_inner.close, pd_inner.dividends FROM price_daily pd_inner ORDER BY pd_inner.symbol, pd_inner.date DESC) pd ON bs.symbol = pd.symbol
        
        ORDER BY bs.date DESC, bs.symbol ASC
        LIMIT $1 OFFSET $2
       Params: [ 10, 0 ]
[TRADING] Executing count SQL: 
        SELECT COUNT(*) as total
        FROM buy_sell_daily bs
        
       Params: []
[TRADING] About to execute main query...
[TRADING] Main query successful, now executing count query...
‚úÖ New WebSocket connection established
[TRADING] Both queries successful
[TRADING] Query returned 10 rows out of 15 total
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /trading/signals/daily?limit=10 HTTP/1.1" 200 3152 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/health HTTP/1.1" 200 346 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4843 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:32 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/sentiment
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:35 +0000] "GET /api/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 193 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/news/sentiment
Database connection verified for database-dependent endpoint
DEBUG: /sentiment route hit
News table columns: [
  'id',        'symbol',
  'headline',  'summary',
  'url',       'published_at',
  'sentiment', 'relevance_score',
  'source',    'fetched_at',
  'category',  'title'
]
::1 - - [20/Sep/2025:15:00:35 +0000] "GET /api/news/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 205 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/news/sentiment/SPY
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/news/sentiment/SPY?timeframe=24h HTTP/1.1" 404 163 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/sentiment
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 193 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/news/sentiment
Database connection verified for database-dependent endpoint
DEBUG: /sentiment route hit
News table columns: [
  'id',        'symbol',
  'headline',  'summary',
  'url',       'published_at',
  'sentiment', 'relevance_score',
  'source',    'fetched_at',
  'category',  'title'
]
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/news/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 205 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
Processing request: GET /api/news/sentiment/SPY
Database connection verified for database-dependent endpoint
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/news/sentiment/SPY?timeframe=24h HTTP/1.1" 404 163 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üì® Received WebSocket message: {
  type: 'subscribe',
  topics: [ 'prices', 'market_overview', 'portfolio_updates' ]
}
üîå WebSocket connection closed
üîå WebSocket connection closed
üîå WebSocket connection closed
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/health
Database connection verified for database-dependent endpoint
Starting health check with database...
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/health HTTP/1.1" 200 346 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
‚úÖ New WebSocket connection established
Processing request: GET /api/market-overview
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/market-overview HTTP/1.1" 200 365 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/scores
Database connection verified for database-dependent endpoint
Scores endpoint called with params: { limit: '10', sortBy: 'composite_score', sortOrder: 'desc' }
Processing request: GET /api/stocks/AAPL/prices
Database connection verified for database-dependent endpoint
üöÄ OPTIMIZED prices endpoint: AAPL, timeframe: daily, limit: 30
DEBUG: Using tableName: price_daily for symbol: AAPL, timeframe: daily
üîç DEBUG: About to execute daily query for AAPL:
üìä Query length: 1173 characters
üîß Parameters: [AAPL, 30]
üìù FULL QUERY:

        WITH price_data AS (
          SELECT
            date,
            open::DECIMAL(12,4) as open,
            high::DECIMAL(12,4) as high,
            low::DECIMAL(12,4) as low,
            close::DECIMAL(12,4) as close,
            close::DECIMAL(12,4) as adj_close,
            volume::BIGINT as volume,
            LAG(close) OVER (ORDER BY date DESC) as prev_close
          FROM price_daily
          WHERE symbol = $1
            AND date >= CURRENT_DATE - INTERVAL '2 years'
            AND close IS NOT NULL
          ORDER BY date DESC
          LIMIT $2
        )
        SELECT 
          date,
          open,
          high, 
          low,
          close,
          adj_close,
          volume,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0 
            THEN ROUND((close - prev_close)::DECIMAL, 4)
            ELSE NULL 
          END as price_change,
          CASE 
            WHEN prev_close IS NOT NULL AND prev_close > 0
            THEN ROUND(((close - prev_close) / prev_close * 100)::DECIMAL, 4)
            ELSE NULL 
          END as price_change_pct
        FROM price_data
        ORDER BY date DESC;
      
üéØ Query position 763 is at character: I
‚ùå No historical data found for AAPL - comprehensive diagnosis needed {
  symbol: 'AAPL',
  database_query_failed: true,
  table_existence_check_needed: true,
  data_loading_status_unknown: true,
  detailed_diagnostics: {
    query_attempted: 'historical_price_data_query',
    potential_causes: [
      'Symbol not found in price_daily table',
      'Data loading scripts not executed for this symbol',
      'Database tables missing or corrupted',
      'Stock symbol delisted or invalid',
      'Data sync process failed for historical data'
    ],
    troubleshooting_steps: [
      'Check if symbol exists in stock_symbols table',
      'Verify price_daily table has data for this symbol',
      'Check data loading script execution logs',
      'Validate external data provider connectivity',
      'Review data sync process status'
    ],
    system_checks: [
      'Database connectivity',
      'Table existence validation',
      'Data freshness assessment',
      'External API availability',
      'Data loading process health'
    ]
  }
}
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/stocks/AAPL/prices?timeframe=daily&limit=30 HTTP/1.1" 200 4833 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/scores?limit=10&sortBy=composite_score&sortOrder=desc HTTP/1.1" 200 2806 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/sentiment
Database connection verified for database-dependent endpoint
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 193 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/news/sentiment
Database connection verified for database-dependent endpoint
DEBUG: /sentiment route hit
News table columns: [
  'id',        'symbol',
  'headline',  'summary',
  'url',       'published_at',
  'sentiment', 'relevance_score',
  'source',    'fetched_at',
  'category',  'title'
]
::1 - - [20/Sep/2025:15:00:36 +0000] "GET /api/news/sentiment?symbol=SPY&timeframe=1W HTTP/1.1" 200 205 "http://localhost:5175/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.7339.16 Safari/537.36"
Processing request: GET /api/stocks
Database connection verified for database-dependent endpoint
OPTIMIZED Stocks main endpoint called with params: { page: '1', limit: '25', sortBy: 'symbol', sortOrder: 'asc' }
Triggering workflow deploy
OPTIMIZED query params: { whereClause: 'WHERE 1=1', params: [], limit: 50, offset: 0 }
Executing FAST queries with schema validation...
Executing comprehensive stocks query with timeout protection...
Database query error: {
  error: 'column cp.short_name does not exist',
  query: '\n' +
    '      SELECT\n' +
    '        -- Primary company profile data (populated by loadinfo)\n' +
    '        cp.ticker as s...',
  params: '2 parameters',
  code: '42703'
}
OPTIMIZED endpoint error: error: column cp.short_name does not exist
    at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async query (/home/stocks/algo/webapp/lambda/utils/database.js:1128:20)
    at async Promise.all (index 0)
    at async /home/stocks/algo/webapp/lambda/routes/stocks.js:487:41 {
  length: 112,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '116',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
Error message: column cp.short_name does not exist
Error details: error: column cp.short_name does not exist
    at /home/stocks/algo/webapp/lambda/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async query (/home/stocks/algo/webapp/lambda/utils/database.js:1128:20)
    at async Promise.all (index 0)
    at async /home/stocks/algo/webapp/lambda/routes/stocks.js:487:41 {
  length: 112,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '116',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3722',
  routine: 'errorMissingColumn'
}
Database table missing - database schema incomplete
/home/stocks/algo/webapp/lambda/routes/stocks.js:902
      throw new Error(`Database schema incomplete: ${error.message}`);
            ^

Error: Database schema incomplete: column cp.short_name does not exist
    at /home/stocks/algo/webapp/lambda/routes/stocks.js:902:13
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)

Node.js v20.19.4
